class e{}const t=new RegExp("(?:public|global)\\s+(?:interface)\\s+\\w+(\\s+(?:extends)\\s+\\w+)?\\s*\\{","i"),i=new RegExp("(?:public|global)\\s+(?:enum)\\s+\\w+\\s*\\{","i"),s=new RegExp("@IsTest\\s*\\(.*SeeAllData=true.*\\)","i"),r=new RegExp("(System.assert(Equals|NotEquals|)\\s*\\(|Assert\\.[a-zA-Z]*\\s*\\()","ig"),o=new RegExp("\\[\\s*(?:SELECT|FIND)"),n=new RegExp("\\b(?:insert|update|delete)\\s*(?:\\s\\w+|\\(|\\[)"),a=new RegExp("(\\/\\*[\\s\\S]*?\\*\\/|\\/\\/.*\\n|\\/\\/[^\\n]*|\\n)","gi"),l=new RegExp("(\x3c!--[\\s\\S]*?--\x3e|\\n)","gi"),d=new RegExp("([A-Za-z0-9-]{1,63}\\.)+[A-Za-z]{2,6}","ig"),c=new RegExp("[,\"'\\s][a-zA-Z0-9]{5}0[a-zA-Z0-9]{9}([a-zA-Z0-9]{3})?[,\"'\\s]","ig"),u=["salesforce.com",".force."];class p{static RemoveCommentsFromCode(e){return(null==e?void 0:e.replaceAll(a," "))||""}static RemoveCommentsFromXML(e){return(null==e?void 0:e.replaceAll(l," "))||""}static IsInterfaceFromApexCode(e){return null!==(null==e?void 0:e.match(t))||!1}static IsEnumFromApexCode(e){return null!==(null==e?void 0:e.match(i))||!1}static FindHardCodedURLs(e){var t;return null===(t=null==e?void 0:e.match(d))||void 0===t?void 0:t.filter(e=>u.findIndex(t=>e.indexOf(t)>=0)>=0).sort().filter((e,t,i)=>t===i.indexOf(e)).filter(e=>e.indexOf(".my.salesforce.com")<0)}static FindHardCodedIDs(e){var t;return(null===(t=null==e?void 0:e.match(c))||void 0===t?void 0:t.map(e=>null==e?void 0:e.substring(1,(null==e?void 0:e.length)-1)).sort().filter((e,t,i)=>t===i.indexOf(e)))||[]}static IsTestSeeAllDataFromApexCode(e){return null!==(null==e?void 0:e.match(s))||!1}static CountOfAssertsFromApexCode(e){var t;return(null===(t=null==e?void 0:e.match(r))||void 0===t?void 0:t.length)||0}static HasSOQLFromApexCode(e){return null!==(null==e?void 0:e.match(o))||!1}static HasDMLFromApexCode(e){return null!==(null==e?void 0:e.match(n))||!1}}class g{static create(e,t){var i;if(null===(i=e.errors)||void 0===i?void 0:i.some(e=>t.includes(e)))return{hadError:!0,using:[],referenced:[],referencedByTypes:{}};const s=e.records.filter(e=>t.includes(e.id)).map(e=>({id:e.refId,name:e.refName,type:e.refType,url:e.refUrl})),r={};return{hadError:!1,using:s,referenced:e.records.filter(e=>t.includes(e.refId)).map(e=>(void 0===r[e.type]?r[e.type]=1:r[e.type]++,{id:e.id,name:e.name,type:e.type,url:e.url})),referencedByTypes:r}}}class h{}class m{}class f{static create(){return new E}}class E{constructor(){this._columnIds=new Set,this._columns=new Map,this._rows=new Map}toDataMatrix(){const e=[];return this._columnIds.forEach(t=>{e.push(this._columns.has(t)?this._columns.get(t):t)}),{columnHeaders:e,rows:Array.from(this._rows.values())}}addValueToProperty(e,t,i){!1===this._rows.has(e)&&this._rows.set(e,{header:{},data:{}}),this._rows.get(e).data[t]=i,this._columnIds.add(t)}hasColumnHeader(e){return this._columns.has(e)}setColumnHeader(e,t){this._columns.set(e,t)}hasRowHeader(e){return this._rows.has(e)&&this._rows.get(e).header}setRowHeader(e,t){!0===this._rows.has(e)?this._rows.get(e).header=t:this._rows.set(e,{header:t,data:{}})}}class v{}class S{static get label(){return console.error("Need to implement static label() method for",this,JSON.stringify(this),this.name),this.name}}class I extends S{}class y{}class R{}class P{constructor(e,t,i){this.alias=e,this.cacheKey=t,this.parameters=i}}var A,T;function C(e,t,i,s){return new(i||(i=Promise))(function(r,o){function n(e){try{l(s.next(e))}catch(e){o(e)}}function a(e){try{l(s.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(n,a)}l((s=s.apply(e,t||[])).next())})}!function(e){e.APEXCLASSES="apex-classes",e.APEXTRIGGERS="apex-triggers",e.APPLICATIONS="applications",e.APPPERMISSIONS="app-permissions",e.BROWSERS="browsers",e.CURRENTUSERPERMISSIONS="current-user-permissions",e.CUSTOMFIELDS="custom-fields",e.CUSTOMLABELS="custom-labels",e.CUSTOMTABS="custom-tabs",e.COLLABORATIONGROUPS="collaboration-groups",e.DOCUMENTS="documents",e.DASHBOARDS="dashboards",e.EMAILTEMPLATES="email-templates",e.FIELDPERMISSIONS="field-permissions",e.FLOWS="flows",e.HOMEPAGECOMPONENTS="home-page-components",e.KNOWLEDGEARTICLES="knowledge-articles",e.LIGHTNINGAURACOMPONENTS="lightning-aura-components",e.LIGHTNINGPAGES="lightning-pages",e.LIGHTNINGWEBCOMPONENTS="lightning-web-components",e.OBJECT="object",e.OBJECTPERMISSIONS="object-permissions",e.OBJECTS="objects",e.OBJECTTYPES="object-types",e.ORGANIZATION="org-information",e.PACKAGES="packages",e.PAGELAYOUTS="page-layouts",e.PERMISSIONSETS="permission-sets",e.PERMISSIONSETLICENSES="permission-set-licenses",e.PUBLICGROUPSANDQUEUES="public-groups-and-queues",e.PROFILEPWDPOLICIES="profile-password-policies",e.PROFILERESTRICTIONS="profile-restrictions",e.PROFILES="profiles",e.RECORDTYPES="record-types",e.REPORTS="reports",e.STATICRESOURCES="static-resources",e.USERROLES="user-roles",e.INTERNALACTIVEUSERS="internal-active-users",e.VALIDATIONRULES="validation-rules",e.VISUALFORCECOMPONENTS="visual-force-components",e.VISUALFORCEPAGES="visual-force-pages",e.WEBLINKS="web-links",e.WORKFLOWS="workflows"}(A||(A={})),"function"==typeof SuppressedError&&SuppressedError;class b{static forEach(e,t){return C(this,void 0,void 0,function*(){if(e){if("function"!=typeof t)throw new TypeError("Given iteratee is not a proper function.");if(!0!==Array.isArray(e)){if(e instanceof Map){const i=Array.from(e.keys());return void(yield Promise.all(i.map(i=>C(this,void 0,void 0,function*(){return yield t(e.get(i),i),null}))))}throw new TypeError("Given iterable is not a proper Array nor Map.")}yield Promise.all(e.map(e=>C(this,void 0,void 0,function*(){return yield t(e),null})))}})}static map(e,t,i){return C(this,void 0,void 0,function*(){if(!e)return Promise.resolve([]);if(!1===Array.isArray(e))throw new TypeError("Given iterable is not a proper Array.");if("function"!=typeof t)throw new TypeError("Given iteratee is not a proper function.");if(i){if("function"!=typeof i)throw new TypeError("Given filterIteratee is not a proper function.");if("AsyncFunction"===i.constructor.name)throw new TypeError("Given filterIteratee should not be an async function.")}const s=i?e.filter(e=>i(e)):e;return Promise.all(s.map(e=>C(this,void 0,void 0,function*(){return yield t(e)})))})}}class O{static get APEX_CLASSES(){return"apex-classes"}static get APEX_TESTS(){return"apex-tests"}static get APEX_TRIGGERS(){return"apex-triggers"}static get APEX_UNCOMPILED(){return"apex-uncompiled"}static get APP_PERMISSIONS(){return"app-permissions"}static get BROWSERS(){return"browsers"}static get COLLABORATION_GROUPS(){return"collaboration-groups"}static get CURRENT_USER_PERMISSIONS(){return"current-user-permissions"}static get CUSTOM_FIELDS(){return"custom-fields"}static get CUSTOM_LABELS(){return"custom-labels"}static get CUSTOM_TABS(){return"custom-tabs"}static get DASHBOARDS(){return"dashboards"}static get DOCUMENTS(){return"documents"}static get EMAIL_TEMPLATES(){return"email-templates"}static get FIELD_PERMISSIONS(){return"field-permissions"}static get FLOWS(){return"flows"}static get GLOBAL_VIEW(){return"global-view"}static get HARDCODED_URLS_VIEW(){return"hardcoded-urls"}static get HOME_PAGE_COMPONENTS(){return"home-page-components"}static get INTERNAL_ACTIVE_USERS(){return"internal-active-users"}static get KNOWLEDGE_ARTICLES(){return"knowledge-articles"}static get LIGHTNING_AURA_COMPONENTS(){return"lightning-aura-components"}static get LIGHTNING_PAGES(){return"lightning-pages"}static get LIGHTNING_WEB_COMPONENTS(){return"lightning-web-components"}static get OBJECT(){return"object"}static get OBJECT_PERMISSIONS(){return"object-permissions"}static get OBJECTS(){return"objects"}static get OBJECT_TYPES(){return"object-types"}static get ORGANIZATION(){return"org-information"}static get PACKAGES(){return"packages"}static get PAGE_LAYOUTS(){return"page-layouts"}static get PERMISSION_SETS(){return"permission-sets"}static get PERMISSION_SET_LICENSES(){return"permission-set-licenses"}static get PROCESS_BUILDERS(){return"process-builders"}static get PROFILE_PWD_POLICIES(){return"profile-password-policies"}static get PROFILE_RESTRICTIONS(){return"profile-restrictions"}static get PROFILES(){return"profiles"}static get PUBLIC_GROUPS(){return"public-groups"}static get QUEUES(){return"queues"}static get RECORD_TYPES(){return"record-types"}static get REPORTS(){return"reports"}static get STATIC_RESOURCES(){return"static-resources"}static get USER_ROLES(){return"user-roles"}static get VALIDATION_RULES(){return"validation-rules"}static get VISUALFORCE_COMPONENTS(){return"visualforce-components"}static get VISUALFORCE_PAGES(){return"visualforce-pages"}static get WEBLINKS(){return"web-links"}static get WORKFLOWS(){return"workflows"}}!function(e){e.ANY_FIELD="Field",e.APEX_CLASS="ApexClass",e.APEX_TRIGGER="ApexTrigger",e.AURA_WEB_COMPONENT="AuraDefinitionBundle",e.COLLABORATION_GROUP="CollaborationGroup",e.CUSTOM_BIG_OBJECT="CustomBigObject",e.CUSTOM_EVENT="CustomEvent",e.CUSTOM_FIELD="CustomField",e.CUSTOM_LABEL="CustomLabel",e.CUSTOM_METADATA_TYPE="CustomMetadataType",e.CUSTOM_OBJECT="CustomObject",e.CUSTOM_SETTING="CustomSetting",e.CUSTOM_SITE="CustomSite",e.CUSTOM_TAB="CustomTab",e.DASHBOARD="Dashboard",e.DOCUMENT="Document",e.EXTERNAL_OBJECT="ExternalObject",e.EMAIL_TEMPLATE="EmailTemplate",e.FIELD_SET="FieldSet",e.FLOW_DEFINITION="FlowDefinition",e.FLOW_VERSION="Flow",e.HOME_PAGE_COMPONENT="HomePageComponent",e.KNOWLEDGE_ARTICLE="KnowledgeArticle",e.KNOWLEDGE_ARTICLE_VERSION="KnowledgeArticleVersion",e.LIGHTNING_PAGE="FlexiPage",e.LIGHTNING_WEB_COMPONENT="LightningComponentBundle",e.PAGE_LAYOUT="Layout",e.PERMISSION_SET="PermissionSet",e.PERMISSION_SET_GROUP="PermissionSetGroup",e.PERMISSION_SET_LICENSE="PermissionSetLicense",e.PROFILE="Profile",e.PUBLIC_GROUP="PublicGroup",e.QUEUE="Queue",e.RECORD_TYPE="RecordType",e.REPORT="Report",e.ROLE="UserRole",e.TECHNICAL_GROUP="TechnicalGroup",e.STANDARD_FIELD="StandardField",e.STANDARD_OBJECT="StandardEntity",e.STATIC_RESOURCE="StaticResource",e.USER="User",e.VALIDATION_RULE="ValidationRule",e.VISUAL_FORCE_COMPONENT="ApexComponent",e.VISUAL_FORCE_PAGE="ApexPage",e.WEB_LINK="WebLink",e.WORKFLOW_RULE="WorkflowRule"}(T||(T={}));class L extends Error{constructor(e,t,i){super(e),this.code=t,this.contextInformation=i}}class w{constructor(){this.currentUsageRatio=0,this.currentUsagePercentage=""}get yellowThresholdPercentage(){return.7}get redThresholdPercentage(){return.9}get isGreenZone(){return this.currentUsageRatio<.7}get isYellowZone(){return this.currentUsageRatio>=.7&&this.currentUsageRatio<.9}get isRedZone(){return this.currentUsageRatio>=.9}}class M{constructor(e){this._apiLimitExtractor=e,this._lastRequestToSalesforce=void 0,this._lastApiUsage=new w}beforeRequest(e){if(this._lastRequestToSalesforce&&Date.now()-this._lastRequestToSalesforce<=6e4&&this._lastApiUsage.isRedZone){const t=new L("The Daily API Request limit has been reached. We cannot continue.","WATCH_DOG",{CurrentUsagePercentage:this._lastApiUsage.currentUsagePercentage,CurrentUsageRatio:this._lastApiUsage.currentUsageRatio,ThresholdPercentage:this._lastApiUsage.redThresholdPercentage});throw e&&e(t),t}}afterRequest(e){const t=this._apiLimitExtractor();t&&(this._lastApiUsage.currentUsageRatio=t.used/t.max,this._lastApiUsage.currentUsagePercentage=D(this._lastApiUsage.currentUsageRatio),this._lastRequestToSalesforce=Date.now(),this.beforeRequest(e))}get dailyApiRequestLimitInformation(){return this._lastApiUsage}}const D=(e,t=2)=>(100*e).toFixed(t);class N extends y{static get label(){return"Apex Test Result"}}class _ extends I{static get label(){return"Apex Class"}}class F extends I{static get label(){return"Apex Trigger"}}class U extends S{static get label(){return"Browser"}}class x extends S{static get label(){return"Chatter Group"}}class G extends I{static get label(){return"Custom Label"}}class B extends I{static get label(){return"Custom Tab"}}class V extends S{static get label(){return"Dasboard"}}class $ extends S{static get label(){return"Document"}}class W extends S{static get label(){return"EmailTemplate"}}class k extends I{static get label(){return"Standard or Custom Field"}}class H extends S{static get label(){return"Field Set"}}class j extends I{static get label(){return"Flow or Process Builder"}}class Q extends y{}class q extends S{static get label(){return"Public Group or Queue"}}class J extends I{static get label(){return"Home Page Component"}}class Y extends S{static get label(){return"Knowledge Article"}}class K extends I{static get label(){return"Aura Component"}}class X extends I{static get label(){return"Lightning Page"}}class z extends I{static get label(){return"Lightning Web Component"}}class Z extends S{static get label(){return"SObject Limit"}}class ee extends S{static get label(){return"SObject"}}class te extends I{static get label(){return"Page Layout"}}class ie extends S{static get label(){return"Profile"}}class se extends ie{static get label(){return"Permission Set or Permission Set Group"}}class re extends S{static get label(){return"Permission Set License"}}class oe extends S{static get label(){return"Password Policy from a Profile"}}class ne extends S{static get label(){return"Restrictions from Profile"}}class ae extends y{static get label(){return"IP Range Restriction from Profile"}}class le extends y{static get label(){return"Login Hour Restriction from Profile"}}class de extends S{static get label(){return"Record Type"}}class ce extends S{static get label(){return"Report"}}class ue extends I{static get label(){return"Static Resource"}}class pe extends S{static get label(){return"User"}}class ge extends S{static get label(){return"Role"}}class he extends S{static get label(){return"Validation Rule"}}class me extends I{static get label(){return"Visualforce Component"}}class fe extends I{static get label(){return"Visualforce Page"}}class Ee extends I{static get label(){return"Web Link"}}class ve extends S{static get label(){return"Workflow"}}const Se=(e,t,i=3)=>!!(t&&e&&i)&&(e-t)/3>=i,Ie=e=>("number"!=typeof e||0!==e)&&(!e||(0===(null==e?void 0:e.length)||"string"==typeof e&&0===e.trim().length)),ye="Dependencies",Re="Hard-coded URLs",Pe="Hard-coded IDs",Ae="API Version",Te="Code Quality",Ce="Documentation",be="User Adoption",Oe="Security",Le="Overuse",we="Useless",Me=[{id:0,description:"Not referenced anywhere",formula:e=>{var t,i;return!1===(null===(t=null==e?void 0:e.dependencies)||void 0===t?void 0:t.hadError)&&Ie(null===(i=e.dependencies)||void 0===i?void 0:i.referenced)},errorMessage:"This component is not referenced anywhere (as we were told by the Dependency API). Please review the need to keep it in your org.",badField:"dependencies.referenced?.length",applicable:[G,X,K,z,me,fe,ue],category:ye},{id:1,description:"No reference anywhere for custom field",formula:e=>{var t,i;return!0===(null==e?void 0:e.isCustom)&&!1===(null===(t=null==e?void 0:e.dependencies)||void 0===t?void 0:t.hadError)&&Ie(null===(i=e.dependencies)||void 0===i?void 0:i.referenced)},errorMessage:"This custom field is not referenced anywhere (as we were told by the Dependency API). Please review the need to keep it in your org.",badField:"dependencies.referenced?.length",applicable:[k],category:ye},{id:2,description:"No reference anywhere for apex class",formula:e=>{var t,i;return!1===(null==e?void 0:e.isTest)&&!1===(null===(t=null==e?void 0:e.dependencies)||void 0===t?void 0:t.hadError)&&Ie(null===(i=e.dependencies)||void 0===i?void 0:i.referenced)},errorMessage:"This apex class is not referenced anywhere (as we were told by the Dependency API). Please review the need to keep it in your org.",badField:"dependencies.referenced?.length",applicable:[_],category:ye},{id:3,description:"Sorry, we had an issue with the Dependency API to gather the dependencies of this item",formula:e=>(null==e?void 0:e.dependencies)&&!0===(null==e?void 0:e.dependencies.hadError),errorMessage:"Sorry, we had an issue with the Dependency API to gather the dependencies of this item.",badField:"dependencies.referenced?.length",applicable:[k,_,G,j,X,K,z,me,fe],category:ye},{id:4,description:"API Version too old",formula:e=>Se(Ne.CurrentApiVersion,null==e?void 0:e.apiVersion),errorMessage:"The API version of this component is too old. Please update it to the newest version.",badField:"apiVersion",applicable:[_,F,j,K,z,fe,me,W],category:Ae},{id:5,description:"No assertion in this Apex Test",formula:e=>!0===(null==e?void 0:e.isTest)&&0===(null==e?void 0:e.nbSystemAsserts),errorMessage:"This apex test does not contain any assertion! Best practices force you to define assertions in tests.",badField:"nbSystemAsserts",applicable:[_],category:Te},{id:6,description:"No description",formula:e=>Ie(null==e?void 0:e.description),errorMessage:"This component does not have a description. Best practices force you to use the Description field to give some informative context about why and how it is used/set/govern.",badField:"description",applicable:[X,K,z,fe,me,ve,Ee,H,he,$,B,W,ue,ce,V],category:Ce},{id:7,description:"No description for custom component",formula:e=>!0===(null==e?void 0:e.isCustom)&&Ie(null==e?void 0:e.description),errorMessage:"This custom component does not have a description. Best practices force you to use the Description field to give some informative context about why and how it is used/set/govern.",badField:"description",applicable:[k,se,ie],category:Ce},{id:8,description:"No explicit sharing in apex class",formula:e=>!1===(null==e?void 0:e.isTest)&&!0===(null==e?void 0:e.isClass)&&!e.specifiedSharing,errorMessage:"This Apex Class does not specify a sharing model. Best practices force you to specify with, without or inherit sharing to better control the visibility of the data you process in Apex.",badField:"specifiedSharing",applicable:[_],category:Te},{id:9,description:"Schedulable should be scheduled",formula:e=>!1===(null==e?void 0:e.isScheduled)&&!0===(null==e?void 0:e.isSchedulable),errorMessage:"This Apex Class implements Schedulable but is not scheduled. What is the point? Is this class still necessary?",badField:"isScheduled",applicable:[_],category:Te},{id:10,description:"Not able to compile class",formula:e=>!0===(null==e?void 0:e.needsRecompilation),errorMessage:"This Apex Class can not be compiled for some reason. You should try to recompile it. If the issue remains you need to consider refactoring this class or the classes that it is using.",badField:"name",applicable:[_],category:Te},{id:11,description:"No coverage for this class",formula:e=>!1===(null==e?void 0:e.isTest)&&(isNaN(e.coverage)||!e.coverage),errorMessage:"This Apex Class does not have any code coverage. Consider launching the corresponding tests that will bring some coverage. If you do not know which test to launch just run them all!",badField:"coverage",applicable:[_],category:Te},{id:12,description:"Coverage not enough",formula:e=>(null==e?void 0:e.coverage)>0&&(null==e?void 0:e.coverage)<.75,errorMessage:"This Apex Class does not have enough code coverage (less than 75% of lines are covered by successful unit tests). Maybe you ran not all the unit tests to cover this class entirely? If you did, then consider augmenting that coverage with new test methods.",badField:"coverage",applicable:[_],category:Te},{id:13,description:"At least one testing method failed",formula:e=>{var t;return!0===(null==e?void 0:e.isTest)&&(null==e?void 0:e.testFailedMethods)&&(null===(t=null==e?void 0:e.testFailedMethods)||void 0===t?void 0:t.length)>0},errorMessage:"This Apex Test Class has at least one failed method.",badField:"testFailedMethods",applicable:[_],category:Te},{id:14,description:"Apex trigger should not contain SOQL statement",formula:e=>!0===(null==e?void 0:e.hasSOQL),errorMessage:"This Apex Trigger contains at least one SOQL statement. Best practices force you to move any SOQL statement in dedicated Apex Classes that you would call from the trigger. Please update the code accordingly.",badField:"hasSOQL",applicable:[F],category:Te},{id:15,description:"Apex trigger should not contain DML action",formula:e=>!0===(null==e?void 0:e.hasDML),errorMessage:"This Apex Trigger contains at least one DML action. Best practices force you to move any DML action in dedicated Apex Classes that you would call from the trigger. Please update the code accordingly.",badField:"hasDML",applicable:[F],category:Te},{id:16,description:"Apex Trigger should not contain logic",formula:e=>(null==e?void 0:e.length)>5e3,errorMessage:"Due to the massive number of source code (more than 5000 characters) in this Apex Trigger, we suspect that it contains logic. Best practices force you to move any logic in dedicated Apex Classes that you would call from the trigger. Please update the code accordingly.",badField:"length",applicable:[F],category:Te},{id:17,description:"No direct member for this group",formula:e=>!e.nbDirectMembers||0===(null==e?void 0:e.nbDirectMembers),errorMessage:"This public group (or queue) does not contain any direct members (users or sub groups). Is it empty on purpose? Maybe you should review its use in your org...",badField:"nbDirectMembers",applicable:[q],category:we},{id:18,description:"Custom profile with no active member",formula:e=>!0===(null==e?void 0:e.isCustom)&&0===(null==e?void 0:e.memberCounts),errorMessage:"This custom profile has no active members. Is it empty on purpose? Maybe you should review its use in your org...",badField:"memberCounts",applicable:[ie],category:we},{id:19,description:"Role with no active users",formula:e=>0===(null==e?void 0:e.activeMembersCount),errorMessage:"This role has no active users assigned to it. Is it on purpose? Maybe you should review its use in your org...",badField:"activeMembersCount",applicable:[ge],category:we},{id:20,description:"Active user not under LEX",formula:e=>!1===(null==e?void 0:e.onLightningExperience),errorMessage:"This user is still using Classic. Time to switch to Lightning for all your users, don't you think?",badField:"onLightningExperience",applicable:[pe],category:be},{id:21,description:"Active user never logged",formula:e=>null===(null==e?void 0:e.lastLogin),errorMessage:"This active user has never logged in yet. Time to optimize your licence cost!",badField:"lastLogin",applicable:[pe],category:be},{id:22,description:"Workflow with no action",formula:e=>!1===(null==e?void 0:e.hasAction),errorMessage:"This workflow has no action, please review it and potentially remove it.",badField:"hasAction",applicable:[ve],category:ye},{id:23,description:"Workflow with empty time triggered list",formula:e=>{var t;return(null===(t=null==e?void 0:e.emptyTimeTriggers)||void 0===t?void 0:t.length)>0},errorMessage:"This workflow is time triggered but with no time triggered action, please review it.",badField:"emptyTimeTriggers",applicable:[ve],category:ye},{id:24,description:"Password policy with question containing password!",formula:e=>!0===(null==e?void 0:e.passwordQuestion),errorMessage:"This profile password policy allows you to have a password in the question! Please change that setting as it is clearly a lack of security in your org!",badField:"passwordQuestion",applicable:[oe],category:Oe},{id:25,description:"Password policy with too big expiration",formula:e=>(null==e?void 0:e.passwordExpiration)>90,errorMessage:"This profile password policy allows you to have a password that expires after 90 days. Please consider having a shorter period of time for expiration if you policy.",badField:"passwordExpiration",applicable:[oe],category:Oe},{id:26,description:"Password policy with no expiration",formula:e=>0===(null==e?void 0:e.passwordExpiration),errorMessage:"This profile password policy allows you to have a password that never expires. Why is that? Do you have this profile for technical users? Please reconsider this setting and use JWT authentication instead for technical users.",badField:"passwordExpiration",applicable:[oe],category:Oe},{id:27,description:"Password history too small",formula:e=>(null==e?void 0:e.passwordHistory)<3,errorMessage:"This profile password policy allows users to set their password with a too-short memory. For example, they can keep on using the same different password every time you ask them to change it. Please increase this setting.",badField:"passwordHistory",applicable:[oe],category:Oe},{id:28,description:"Password minimum size too small",formula:e=>(null==e?void 0:e.minimumPasswordLength)<8,errorMessage:"This profile password policy allows users to set passwords with less than 8 characters. That minimum length is not strong enough. Please increase this setting.",badField:"minimumPasswordLength",applicable:[oe],category:Oe},{id:29,description:"Password complexity too weak",formula:e=>(null==e?void 0:e.passwordComplexity)<3,errorMessage:"This profile password policy allows users to set too-easy passwords. The complexity you choose is not strong enough. Please increase this setting.",badField:"passwordComplexity",applicable:[oe],category:Oe},{id:30,description:"No max login attempts set",formula:e=>void 0===(null==e?void 0:e.maxLoginAttempts),errorMessage:"This profile password policy allows users to try infinitely to log in without locking the access. Please review this setting.",badField:"passwordExpiration",applicable:[oe],category:Oe},{id:31,description:"No lockout period set",formula:e=>void 0===(null==e?void 0:e.lockoutInterval),errorMessage:"This profile password policy does not set a value for any locked out period. Please review this setting.",badField:"lockoutInterval",applicable:[oe],category:Oe},{id:32,description:"IP Range too large (> 100,000)",formula:e=>(null==e?void 0:e.ipRanges.filter(e=>e.difference>1e5).length)>0,errorMessage:"This profile includes an IP range that is too wide (more than 100,000 IP addresses!). If you set an IP Range it should be not that large. You could split that range into multiple ones. The risk is that you include an IP that is not part of your company. Please review this setting.",badField:"ipRanges",applicable:[ne],category:Oe},{id:33,description:"Login hours too large",formula:e=>(null==e?void 0:e.loginHours.filter(e=>e.difference>1200).length)>0,errorMessage:"This profile includes a login hour that is too wide (more than 20 hours a day!). If you set a login hour it should reflect reality. Please review this setting.",badField:"loginHours",applicable:[ne],category:Oe},{id:34,description:"Inactive component",formula:e=>!1===(null==e?void 0:e.isActive),errorMessage:"This component is inactive, so why do not you just remove it from your org?",badField:"isActive",applicable:[he,de,F,ve,W],category:we},{id:35,description:"No active version for this flow",formula:e=>!1===(null==e?void 0:e.isVersionActive),errorMessage:"This flow does not have an active version, did you forget to activate its latest version? or you do not need that flow anymore?",badField:"isVersionActive",applicable:[j],category:we},{id:36,description:"Too many versions under this flow",formula:e=>(null==e?void 0:e.versionsCount)>7,errorMessage:"This flow has more than seven versions. Maybe it is time to do some cleaning in this flow!",badField:"versionsCount",applicable:[j],category:we},{id:37,description:"Migrate this process builder",formula:e=>!0===(null==e?void 0:e.isProcessBuilder),errorMessage:"Time to migrate this process builder to flow!",badField:"name",applicable:[j],category:we},{id:38,description:"No description for the current version of a flow",formula:e=>Ie(null==e?void 0:e.description),errorMessage:"This flow does not have a description. Best practices force you to use the Description field to give some informative context about why and how it is used/set/govern.",badField:"description",applicable:[j],category:Ce},{id:39,description:"API Version too old for the current version of a flow",formula:e=>{var t;return Se(Ne.CurrentApiVersion,null===(t=null==e?void 0:e.currentVersionRef)||void 0===t?void 0:t.apiVersion)},errorMessage:"The API version of this flow's current version is too old. Please update it to the newest version.",badField:"currentVersionRef.apiVersion",applicable:[j],category:Ae},{id:40,description:"This flow is running without sharing",formula:e=>{var t;return"SystemModeWithoutSharing"===(null===(t=null==e?void 0:e.currentVersionRef)||void 0===t?void 0:t.runningMode)},errorMessage:"The running mode of this version without sharing. With great power comes great responsibilities. Please check if this is REALLY needed.",badField:"currentVersionRef.runningMode",applicable:[j],category:Oe},{id:41,description:"Too many nodes in this version",formula:e=>{var t;return(null===(t=null==e?void 0:e.currentVersionRef)||void 0===t?void 0:t.totalNodeCount)>100},errorMessage:"There are more than one hundred nodes in this flow. Please consider using Apex? or cut it into multiple sub flows?",badField:"currentVersionRef.totalNodeCount",applicable:[j],category:we},{id:42,description:"Near the limit",formula:e=>(null==e?void 0:e.usedPercentage)>=.8,errorMessage:"This limit is almost reached (>80%). Please review this.",badField:"usedPercentage",applicable:[Z],category:Le},{id:43,description:"Almost all licenses are used",formula:e=>void 0!==(null==e?void 0:e.usedPercentage)&&(null==e?void 0:e.usedPercentage)>=.8,errorMessage:"The number of seats for this license is almost reached (>80%). Please review this.",badField:"usedPercentage",applicable:[re],category:Le},{id:44,description:"You could have licenses to free up",formula:e=>(null==e?void 0:e.remainingCount)>0&&(null==e?void 0:e.distinctActiveAssigneeCount)!==(null==e?void 0:e.usedCount),errorMessage:"The Used count from that permission set license does not match the number of distinct active users assigned to the same license. Please check if you could free up some licenses!",badField:"distinctActiveAssigneeCount",applicable:[re],category:we},{id:45,description:"Role with a level >= 7",formula:e=>(null==e?void 0:e.level)>=7,errorMessage:"This role has a level in the Role Hierarchy which is seven or greater. Please reduce the maximum depth of the role hierarchy. Having that many levels has an impact on performance...",badField:"level",applicable:[ge],category:we},{id:46,description:"Hard-coded URL suspicion in this item",formula:e=>{var t;return(null===(t=null==e?void 0:e.hardCodedURLs)||void 0===t?void 0:t.length)>0||!1},errorMessage:"The source code of this item contains one or more hard coded URLs pointing to domains like salesforce.com or force.*",badField:"hardCodedURLs",applicable:[_,F,x,k,J,me,fe,Ee,B,W],category:Re},{id:47,description:"Hard-coded Salesforce IDs suspicion in this item",formula:e=>{var t;return(null===(t=null==e?void 0:e.hardCodedIDs)||void 0===t?void 0:t.length)>0||!1},errorMessage:"The source code of this item contains one or more hard coded Salesforce IDs",badField:"hardCodedIDs",applicable:[_,F,x,k,J,me,fe,Ee,B,W],category:Pe},{id:48,description:"At least one successful testing method was very long",formula:e=>{var t;return!0===(null==e?void 0:e.isTest)&&(null==e?void 0:e.testPassedButLongMethods)&&(null===(t=null==e?void 0:e.testPassedButLongMethods)||void 0===t?void 0:t.length)>0},errorMessage:"This Apex Test Class has at least one successful method which took more than 20 seconds to execute",badField:"testPassedButLongMethods",applicable:[_],category:Te},{id:49,description:"Page layout should be assigned to at least one Profile",formula:e=>0===(null==e?void 0:e.profileAssignmentCount),errorMessage:"This Page Layout is not assigned to any Profile. Please review this page layout and assign it to at least one profile.",badField:"profileAssignmentCount",applicable:[te],category:we},{id:50,description:"Hard-coded URL suspicion in this document",formula:e=>!0===(null==e?void 0:e.isHardCodedURL),errorMessage:"The URL of this document contains a hard coded URL pointing to domains like salesforce.com or force.*",badField:"documentUrl",applicable:[$],category:Re},{id:51,description:"Unassigned Record Type",formula:e=>!1===(null==e?void 0:e.isDefault)&&!1===(null==e?void 0:e.isAvailable),errorMessage:"This record type is not set as default nor as visible in any profile in this org. Please review this record type and remove it if it is not needed anymore.",badField:"isDefault",applicable:[de],category:we},{id:52,description:"Email template never used",formula:e=>null===(null==e?void 0:e.lastUsedDate),errorMessage:"This email template was never used. Is it really useful?",badField:"lastUsedDate",applicable:[W],category:we},{id:53,description:"No description for this flow",formula:e=>!1===(null==e?void 0:e.isProcessBuilder)&&Ie(null==e?void 0:e.description),errorMessage:"This flow does not have a description. Best practices force you to use the Description field to give some informative context about why and how it is used/set/govern.",badField:"description",applicable:[j],category:Ce},{id:54,description:"Hard-coded URL suspicion in this article",formula:e=>!0===(null==e?void 0:e.isHardCodedURL),errorMessage:"This article contains text information with links that points to domains like salesforce.com or force.*",badField:"isHardCodedURL",applicable:[Y],category:Re},{id:55,description:"Custom permission set with no active member and only assigned to empty group(s)",formula:e=>!0===(null==e?void 0:e.isCustom)&&!1===(null==e?void 0:e.isGroup)&&0===(null==e?void 0:e.memberCounts)&&!0===(null==e?void 0:e.allIncludingGroupsAreEmpty),errorMessage:"This custom permission set has no active members and is only included in empty permission set groups. Is it on purpose? Maybe you should review its use in your org...",badField:"allIncludingGroupsAreEmpty",applicable:[se],category:we},{id:56,description:"Custom permission set group with no active member",formula:e=>!0===(null==e?void 0:e.isCustom)&&!0===(null==e?void 0:e.isGroup)&&0===(null==e?void 0:e.memberCounts),errorMessage:"This custom permission set group has no active members. Is it empty on purpose? Maybe you should review its use in your org...",badField:"memberCounts",applicable:[se],category:we},{id:57,description:"Custom permission set with no active member and not even assigned to group",formula:e=>{var t;return!0===(null==e?void 0:e.isCustom)&&!1===(null==e?void 0:e.isGroup)&&0===(null==e?void 0:e.memberCounts)&&0===(null===(t=null==e?void 0:e.permissionSetGroupIds)||void 0===t?void 0:t.length)},errorMessage:"This custom permission set has no active members and is not even assigned to a permission set group. Is it on purpose? Maybe you should review its use in your org...",badField:"memberCounts",applicable:[se],category:we},{id:58,description:"IP Range too large (> 16,777,216)",formula:e=>(null==e?void 0:e.ipRanges.filter(e=>e.difference>16777216).length)>0,errorMessage:"This profile includes an IP range that is too wide (more than 16,777,216 IP addresses!). If you set an IP Range it should be not that large. You could split that range into multiple ones. The risk is that you include an IP that is not part of your company. Please review this setting.",badField:"ipRanges",applicable:[ne],category:Oe},{id:59,description:"Object with more than 350 custom fields",formula:e=>(null==e?void 0:e.nbCustomFields)>350,errorMessage:"This object has more than 350 custom fields. Please consider reducing that number as it can impact performance and usability.",badField:"nbCustomFields",applicable:[ee],category:Le},{id:60,description:"Object with more than 15 page layouts",formula:e=>(null==e?void 0:e.nbPageLayouts)>15,errorMessage:"This object has more than 15 page layouts. Please consider reducing that number as it can impact performance and usability.",badField:"nbPageLayouts",applicable:[ee],category:Le},{id:61,description:"Object with more than 20 workflow rules",formula:e=>(null==e?void 0:e.nbWorkflowRules)>20,errorMessage:"This object has more than 20 workflow rules. Please consider reducing that number as it can impact performance and usability.",badField:"nbWorkflowRules",applicable:[ee],category:Le},{id:62,description:"Object with more than 20 validation rules",formula:e=>(null==e?void 0:e.nbValidationRules)>20,errorMessage:"This object has more than 20 validation rules. Please consider reducing that number as it can impact performance and usability.",badField:"nbValidationRules",applicable:[ee],category:Le},{id:63,description:"Page layout with more than 100 fields",formula:e=>(null==e?void 0:e.nbFields)>100,errorMessage:"This page layout has more than 100 fields. Please consider reducing that number as it can impact user adoption.",badField:"nbFields",applicable:[te],category:be},{id:64,description:"Page layout with more than 11 related lists",formula:e=>(null==e?void 0:e.nbRelatedLists)>11,errorMessage:"This page layout has more than 11 related lists. Please consider reducing that number as it can impact user adoption.",badField:"nbRelatedLists",applicable:[te],category:be},{id:65,description:"Page layout with Notes and Attachments related list",formula:e=>!0===(null==e?void 0:e.isAttachmentRelatedListIncluded),errorMessage:"This page layout has the Notes and Attachments related list in it. Please consider using the Files related list instead.",badField:"isAttachmentRelatedListIncluded",applicable:[te],category:be},{id:66,description:"Custom profile with low number of active members",formula:e=>!0===(null==e?void 0:e.isCustom)&&(null==e?void 0:e.memberCounts)<=10,errorMessage:"This custom profile has a low number of active members (<= 10). Maybe you should review its use in your org...",badField:"memberCounts",applicable:[ie],category:we},{id:67,description:"Custom permission set with low number of active members and only assigned to empty group(s)",formula:e=>!0===(null==e?void 0:e.isCustom)&&!1===(null==e?void 0:e.isGroup)&&(null==e?void 0:e.memberCounts)<=10&&!0===(null==e?void 0:e.allIncludingGroupsAreEmpty),errorMessage:"This custom permission set has a low number of active members (<= 10) and is only included in empty permission set groups. Is it on purpose? Maybe you should review its use in your org...",badField:"allIncludingGroupsAreEmpty",applicable:[se],category:we},{id:68,description:"Custom permission set group with low number of active members",formula:e=>!0===(null==e?void 0:e.isCustom)&&!0===(null==e?void 0:e.isGroup)&&(null==e?void 0:e.memberCounts)<=10,errorMessage:"This custom permission set group has a low number of active members (<= 10). Is it empty on purpose? Maybe you should review its use in your org...",badField:"memberCounts",applicable:[se],category:we},{id:69,description:"Custom permission set with low number of active members and not even assigned to group",formula:e=>{var t;return!0===(null==e?void 0:e.isCustom)&&!1===(null==e?void 0:e.isGroup)&&(null==e?void 0:e.memberCounts)<=10&&0===(null===(t=null==e?void 0:e.permissionSetGroupIds)||void 0===t?void 0:t.length)},errorMessage:"This custom permission set has a low number of active members (<= 10) and is not even assigned to a permission set group. Is it on purpose? Maybe you should review its use in your org...",badField:"memberCounts",applicable:[se],category:we},{id:70,description:"This browser is considered out-of-date by Salesforce",formula:e=>"Chrome"===e.name&&e.version<88||"Edge"===e.name&&e.version<91||"Firefox"===e.name&&e.version<88||"Safari"===e.name&&e.version<14,errorMessage:'This browser is considered out-of-date by Salesforce. At this time, we consider the following list: Chrome <88, Edge <91, Firefox <88 and Safari <14. Please work with your user to make them switch to a more recent/supported browser. To identity the users you can go to the setup page "Login History" and export the data to identify them.',badField:"fullName",applicable:[U],category:be},{id:71,description:"This browser is unsupported by Salesforce",formula:e=>"IE"===e.name,errorMessage:'This browser is unsupported by Salesforce. At this time, we consider only Internet Explorer whatever its version. Please work with your user to make them switch to a more recent/supported browser. To identity the users you can go to the setup page "Login History" and export the data to identify them.',badField:"name",applicable:[U],category:be},{id:72,description:"User is logging directly without MFA",formula:e=>e.nbDirectLoginsWithoutMFA>0&&!0!==e.hasMfaByPass,errorMessage:"This user is logging in directly to Salesforce without using MFA (Multi-Factor Authentication). And this user has not the MFA bypass enabled. Please work with your user to make them use MFA for better security.",badField:"nbDirectLoginsWithoutMFA",applicable:[pe],category:Oe},{id:73,description:"Lightning page with Notes and Attachments related list",formula:e=>!0===(null==e?void 0:e.isAttachmentRelatedListIncluded),errorMessage:"This lightning page has the Notes and Attachments related list in it. Please consider using the Files related list instead.",badField:"isAttachmentRelatedListIncluded",applicable:[X],category:be},{id:74,description:"User with debug mode enabled",formula:e=>!0===(null==e?void 0:e.hasDebugMode),errorMessage:"This user has the debug mode enabled. Please disable it for better performance and user adoption.",badField:"hasDebugMode",applicable:[pe],category:be},{id:100,description:"[LFS] Inactive Flow",formula:e=>{var t,i;return(null===(i=null===(t=null==e?void 0:e.currentVersionRef)||void 0===t?void 0:t.lfsViolations)||void 0===i?void 0:i.includes("InactiveFlow"))||!1},errorMessage:"This flow is inactive. Consider activating it or removing it from your org.",badField:"currentVersionRef.lfsViolations",applicable:[j],category:we},{id:101,description:"[LFS] Process Builder",formula:e=>{var t,i;return(null===(i=null===(t=null==e?void 0:e.currentVersionRef)||void 0===t?void 0:t.lfsViolations)||void 0===i?void 0:i.includes("ProcessBuilder"))||!1},errorMessage:"Time to migrate this process builder to flow!",badField:"currentVersionRef.lfsViolations",applicable:[j],category:we},{id:102,description:"[LFS] Missing Flow Description",formula:e=>{var t,i;return(null===(i=null===(t=null==e?void 0:e.currentVersionRef)||void 0===t?void 0:t.lfsViolations)||void 0===i?void 0:i.includes("FlowDescription"))||!1},errorMessage:"This flow does not have a description. Add documentation about its purpose and usage.",badField:"currentVersionRef.lfsViolations",applicable:[j],category:Ce},{id:103,description:"[LFS] Outdated API Version",formula:e=>{var t,i;return(null===(i=null===(t=null==e?void 0:e.currentVersionRef)||void 0===t?void 0:t.lfsViolations)||void 0===i?void 0:i.includes("APIVersion"))||!1},errorMessage:"The API version of this flow is outdated. Update it to the newest version.",badField:"currentVersionRef.lfsViolations",applicable:[j],category:Ae},{id:104,description:"[LFS] Unsafe Running Context",formula:e=>{var t,i;return(null===(i=null===(t=null==e?void 0:e.currentVersionRef)||void 0===t?void 0:t.lfsViolations)||void 0===i?void 0:i.includes("UnsafeRunningContext"))||!1},errorMessage:"This flow runs in System Mode without Sharing, which can lead to unsafe data access.",badField:"currentVersionRef.lfsViolations",applicable:[j],category:Oe},{id:105,description:"[LFS] SOQL Query In Loop",formula:e=>{var t,i;return(null===(i=null===(t=null==e?void 0:e.currentVersionRef)||void 0===t?void 0:t.lfsViolations)||void 0===i?void 0:i.includes("SOQLQueryInLoop"))||!1},errorMessage:"This flow has SOQL queries inside loops. Consolidate queries at the end of the flow to avoid governor limits.",badField:"currentVersionRef.lfsViolations",applicable:[j],category:Te},{id:106,description:"[LFS] DML Statement In Loop",formula:e=>{var t,i;return(null===(i=null===(t=null==e?void 0:e.currentVersionRef)||void 0===t?void 0:t.lfsViolations)||void 0===i?void 0:i.includes("DMLStatementInLoop"))||!1},errorMessage:"This flow has DML operations inside loops. Consolidate DML at the end to avoid governor limits.",badField:"currentVersionRef.lfsViolations",applicable:[j],category:Te},{id:107,description:"[LFS] Action Calls In Loop",formula:e=>{var t,i;return(null===(i=null===(t=null==e?void 0:e.currentVersionRef)||void 0===t?void 0:t.lfsViolations)||void 0===i?void 0:i.includes("ActionCallsInLoop"))||!1},errorMessage:"This flow has action calls inside loops. Bulkify apex calls using collection variables.",badField:"currentVersionRef.lfsViolations",applicable:[j],category:Te},{id:108,description:"[LFS] Hardcoded Id",formula:e=>{var t,i;return(null===(i=null===(t=null==e?void 0:e.currentVersionRef)||void 0===t?void 0:t.lfsViolations)||void 0===i?void 0:i.includes("HardcodedId"))||!1},errorMessage:"This flow contains hardcoded IDs which are org-specific. Use variables or merge fields instead.",badField:"currentVersionRef.lfsViolations",applicable:[j],category:Pe},{id:109,description:"[LFS] Hardcoded Url",formula:e=>{var t,i;return(null===(i=null===(t=null==e?void 0:e.currentVersionRef)||void 0===t?void 0:t.lfsViolations)||void 0===i?void 0:i.includes("HardcodedUrl"))||!1},errorMessage:"This flow contains hardcoded URLs. Use $API formulas or custom labels instead.",badField:"currentVersionRef.lfsViolations",applicable:[j],category:Re},{id:110,description:"[LFS] Missing Null Handler",formula:e=>{var t,i;return(null===(i=null===(t=null==e?void 0:e.currentVersionRef)||void 0===t?void 0:t.lfsViolations)||void 0===i?void 0:i.includes("MissingNullHandler"))||!1},errorMessage:"This flow has Get Records operations without null checks. Use decision elements to validate results.",badField:"currentVersionRef.lfsViolations",applicable:[j],category:Te},{id:111,description:"[LFS] Missing Fault Path",formula:e=>{var t,i;return(null===(i=null===(t=null==e?void 0:e.currentVersionRef)||void 0===t?void 0:t.lfsViolations)||void 0===i?void 0:i.includes("MissingFaultPath"))||!1},errorMessage:"This flow has DML or action operations without fault handlers. Add fault paths for better error handling.",badField:"currentVersionRef.lfsViolations",applicable:[j],category:Te},{id:112,description:"[LFS] Recursive After Update",formula:e=>{var t,i;return(null===(i=null===(t=null==e?void 0:e.currentVersionRef)||void 0===t?void 0:t.lfsViolations)||void 0===i?void 0:i.includes("RecursiveAfterUpdate"))||!1},errorMessage:"This after-update flow modifies the same record that triggered it, risking recursion. Use before-save flows instead.",badField:"currentVersionRef.lfsViolations",applicable:[j],category:Te},{id:113,description:"[LFS] Duplicate DML Operation",formula:e=>{var t,i;return(null===(i=null===(t=null==e?void 0:e.currentVersionRef)||void 0===t?void 0:t.lfsViolations)||void 0===i?void 0:i.includes("DuplicateDMLOperation"))||!1},errorMessage:"This flow allows navigation back after DML operations, which may cause duplicate changes.",badField:"currentVersionRef.lfsViolations",applicable:[j],category:Te},{id:114,description:"[LFS] Get Record All Fields",formula:e=>{var t,i;return(null===(i=null===(t=null==e?void 0:e.currentVersionRef)||void 0===t?void 0:t.lfsViolations)||void 0===i?void 0:i.includes("GetRecordAllFields"))||!1},errorMessage:'This flow uses Get Records with "all fields". Specify only needed fields for better performance.',badField:"currentVersionRef.lfsViolations",applicable:[j],category:Te},{id:115,description:"[LFS] Record ID as String",formula:e=>{var t,i;return(null===(i=null===(t=null==e?void 0:e.currentVersionRef)||void 0===t?void 0:t.lfsViolations)||void 0===i?void 0:i.includes("RecordIdAsString"))||!1},errorMessage:"This flow uses a String recordId variable. Modern flows can receive the entire record object, eliminating Get Records queries.",badField:"currentVersionRef.lfsViolations",applicable:[j],category:Te},{id:116,description:"[LFS] Unconnected Element",formula:e=>{var t,i;return(null===(i=null===(t=null==e?void 0:e.currentVersionRef)||void 0===t?void 0:t.lfsViolations)||void 0===i?void 0:i.includes("UnconnectedElement"))||!1},errorMessage:"This flow has unconnected elements that are not in use. Remove them to maintain clarity.",badField:"currentVersionRef.lfsViolations",applicable:[j],category:we},{id:117,description:"[LFS] Unused Variable",formula:e=>{var t,i;return(null===(i=null===(t=null==e?void 0:e.currentVersionRef)||void 0===t?void 0:t.lfsViolations)||void 0===i?void 0:i.includes("UnusedVariable"))||!1},errorMessage:"This flow has unused variables. Remove them to maintain efficiency.",badField:"currentVersionRef.lfsViolations",applicable:[j],category:we},{id:118,description:"[LFS] Copy API Name",formula:e=>{var t,i;return(null===(i=null===(t=null==e?void 0:e.currentVersionRef)||void 0===t?void 0:t.lfsViolations)||void 0===i?void 0:i.includes("CopyAPIName"))||!1},errorMessage:'This flow has elements with copy-paste naming patterns like "Copy_X_Of_Element". Update API names for readability.',badField:"currentVersionRef.lfsViolations",applicable:[j],category:Ce},{id:120,description:"[LFS] Same Record Field Updates",formula:e=>{var t,i;return(null===(i=null===(t=null==e?void 0:e.currentVersionRef)||void 0===t?void 0:t.lfsViolations)||void 0===i?void 0:i.includes("SameRecordFieldUpdates"))||!1},errorMessage:"This before-save flow uses Update Records on $Record. Use direct assignment instead for better performance.",badField:"currentVersionRef.lfsViolations",applicable:[j],category:Te},{id:122,description:"[LFS] Missing Metadata Description",formula:e=>{var t,i;return(null===(i=null===(t=null==e?void 0:e.currentVersionRef)||void 0===t?void 0:t.lfsViolations)||void 0===i?void 0:i.includes("MissingMetadataDescription"))||!1},errorMessage:"This flow has elements or variables without descriptions. Add documentation for better maintainability.",badField:"currentVersionRef.lfsViolations",applicable:[j],category:Ce},{id:123,description:"[LFS] Missing Filter Record Trigger",formula:e=>{var t,i;return(null===(i=null===(t=null==e?void 0:e.currentVersionRef)||void 0===t?void 0:t.lfsViolations)||void 0===i?void 0:i.includes("MissingFilterRecordTrigger"))||!1},errorMessage:"This record-triggered flow lacks filters on changed fields or entry conditions, causing unnecessary executions.",badField:"currentVersionRef.lfsViolations",applicable:[j],category:Te},{id:124,description:"[LFS] Transform Instead of Loop",formula:e=>{var t,i;return(null===(i=null===(t=null==e?void 0:e.currentVersionRef)||void 0===t?void 0:t.lfsViolations)||void 0===i?void 0:i.includes("TransformInsteadOfLoop"))||!1},errorMessage:"This flow uses Loop + Assignment which could be replaced with Transform element (10x faster).",badField:"currentVersionRef.lfsViolations",applicable:[j],category:Te},{id:125,description:"[LFS] Missing Auto Layout",formula:e=>{var t,i;return(null===(i=null===(t=null==e?void 0:e.currentVersionRef)||void 0===t?void 0:t.lfsViolations)||void 0===i?void 0:i.includes("AutoLayout"))||!1},errorMessage:"This flow doesn't use Auto-Layout mode. Enable it to keep your flow organized automatically.",badField:"currentVersionRef.lfsViolations",applicable:[j],category:be},{id:126,description:"Not referenced anywhere for flow (excluding Screen Flows)",formula:e=>{var t,i;return!1===(null==e?void 0:e.isScreenFlow)&&!1===(null===(t=null==e?void 0:e.dependencies)||void 0===t?void 0:t.hadError)&&Ie(null===(i=e.dependencies)||void 0===i?void 0:i.referenced)},errorMessage:"This flow is not referenced anywhere (as we were told by the Dependency API). Please review the need to keep it in your org.",badField:"dependencies.referenced?.length",applicable:[j],category:ye}];Object.freeze(Me);const De=new Map(Me.map(e=>[e.id,e]));class Ne{static get AllScoreRules(){return Me}static GetScoreRulesForHardCodedURLs(){return Me.filter(e=>e.category===Re).map(e=>e.id)}static GetScoreRule(e){return De.get(e)}static GetScoreRuleDescription(e){var t,i;return null!==(i=null===(t=De.get(e))||void 0===t?void 0:t.description)&&void 0!==i?i:"N/A"}static get CurrentApiVersion(){return(()=>{const e=new Date,t=e.getFullYear(),i=e.getMonth()+1;return 3*(t-2022)+53+(i<=2?0:i<=6?1:i<=10?2:3)})()}}Object.freeze(Ne);const _e="*",Fe="sobject",Ue="namespace",xe="sobjecttype",Ge="permissions",Be="apexclasstype",Ve="grouptype";class $e{static get ALL_VALUES(){return _e}static get SOBJECT_NAME(){return Fe}static get PACKAGE_NAME(){return Ue}static get SOBJECT_TYPE_NAME(){return xe}static get SYSTEM_PERMISSIONS_LIST(){return Ge}static get APEX_CLASS_TYPE(){return Be}static get APEX_CLASS_TYPE_REGULAR(){return"apexregular"}static get APEX_CLASS_TYPE_TEST(){return"apextest"}static get APEX_CLASS_TYPE_UNCOMPILED(){return"apexuncompiled"}static get GROUP_TYPE(){return Ve}static get GROUP_TYPE_PG(){return"publicgroup"}static get GROUP_TYPE_QUEUE(){return"queue"}static getSObjectName(e){var t;return null!==(t=null==e?void 0:e.get(Fe))&&void 0!==t?t:_e}static getPackageName(e){var t;return null!==(t=null==e?void 0:e.get(Ue))&&void 0!==t?t:_e}static getSObjectTypeName(e){var t;return null!==(t=null==e?void 0:e.get(xe))&&void 0!==t?t:_e}static getSystemPermissionsList(e){var t;return null!==(t=null==e?void 0:e.get(Ge))&&void 0!==t?t:[]}static getApexClassType(e){var t;return null!==(t=null==e?void 0:e.get(Be))&&void 0!==t?t:_e}static getGroupType(e){var t;return null!==(t=null==e?void 0:e.get(Ve))&&void 0!==t?t:_e}}class We extends y{static get label(){return"Application"}}class ke extends y{static get label(){return"Application Permission from Profile or Permission Set"}}class He extends y{static get label(){return"Field Level Security from Profile or Permission Set"}}class je extends S{static get label(){return"Object Permissions from Profile or Permission Set"}}class Qe extends y{static get label(){return"SObject Releationship"}}class qe extends y{static get label(){return"SObject Types"}}const Je="StandardEntity",Ye="CustomObject",Ke="ExternalObject",Xe="CustomSetting",ze="CustomMetadataType",Ze="CustomEvent",et="KnowledgeArticle",tt="CustomBigObject";class it extends y{static get label(){return"Organization"}}class st extends S{static get label(){return"Package"}}class rt{constructor(e,t){this._setItemToCache=(e,t)=>{let i;try{i=this._compressor.compress(t),this._storage.setItem(e,i)}catch(t){throw new Error(`Error occured when trying to save the value for key ${e} with: hexValue?.length=${(null==i?void 0:i.length)||"N/A"}, Initiale error message was ${t.message}`)}},this._getEntryFromCache=e=>{let t=null;try{const i=this._storage.getItem(e);i&&(t=this._compressor.decompress(i))}catch(t){console.error(`Error occured when trying to get the value for key ${e}`,t)}if(!t)return null;try{const e=JSON.parse(t);return e.created&&Date.now()-e.created>ut?null:e}catch(e){return console.error(`Error occured when trying to parse the string: ${t}`,e),null}},this._compressor=e,this._storage=t}get(e){var t,i;const s=dt(e),r=lt(e),o=this._getEntryFromCache(s);if(null===o)return this._storage.removeItem(s),this._storage.removeItem(r),null;const n=this._getEntryFromCache(r);if(null===n)return this._storage.removeItem(s),null;if(o.length=null!==(i=null===(t=n.content)||void 0===t?void 0:t.length)&&void 0!==i?i:0,this._storage.setItem(s,JSON.stringify(o)),"map"!==o.type)return n.content;try{return new Map(n.content)}catch(t){return console.error(`Error occured when trying to create a map for key ${e}. We just removed the key from the cache.`,t),this._storage.removeItem(s),this._storage.removeItem(r),null}}set(e,t){const i=dt(e),s=lt(e);if(null==t)this._storage.removeItem(i),this._storage.removeItem(s);else{const e=Date.now(),r=t instanceof Map?{type:"map",length:t.size,created:e}:{type:"array",length:null==t?void 0:t.length,created:e},o=t instanceof Map?{content:Array.from(t.entries()).filter(e=>{var t;return!1===(null===(t=e[0])||void 0===t?void 0:t.endsWith("Ref"))}),created:e}:{content:t,created:e};try{this._setItemToCache(s,JSON.stringify(o)),this._setItemToCache(i,JSON.stringify(r))}catch(e){this._storage.removeItem(i),this._storage.removeItem(s)}}}details(){return this._storage.keys().filter(e=>e.startsWith(at)).map(e=>{const t=this._getEntryFromCache(e),i=ct(e);return t?{name:i,isEmpty:0===(null==t?void 0:t.length),isMap:"map"===t.type,length:null==t?void 0:t.length,created:t.created}:{name:i,isEmpty:!0,isMap:!1,length:0,created:0}})}remove(e){this._storage.removeItem(lt(e)),this._storage.removeItem(dt(e))}clear(){return this._storage.keys().filter(e=>e.startsWith(ot)).forEach(e=>this._storage.removeItem(e))}}const ot="OrgCheck",nt=`${ot}.`,at=`${ot}_`,lt=e=>e.startsWith(nt)?e:nt+e,dt=e=>e.startsWith(at)?e:at+e,ct=e=>e.startsWith(at)?e.substring(null==at?void 0:at.length):e.startsWith(nt)?e.substring(null==nt?void 0:nt.length):e,ut=864e5,pt=(e,t)=>Object.prototype.isPrototypeOf.call(t,e);class gt{constructor(){this._instances=new Map}getInstance(e){const t=pt(e,S),i=pt(e,I),s=pt(e,y);if(!1===t&&!1===s&&!1===i)throw new TypeError("Given dataClass does not extends Data nor DataWithDependencies nor DataWithoutScoring");return!1===this._instances.has(e)&&this._instances.set(e,new ht(e,t?Ne.AllScoreRules.filter(t=>{var i;return null===(i=t.applicable)||void 0===i?void 0:i.includes(e)}):[],i)),this._instances.get(e)}}class ht{constructor(e,t,i){this._dataClass=e,this._scoreRules=t,this._isDependenciesNeeded=i}create(e){var t;if(!e)throw new TypeError("Setup can't be null.");if(!e.properties)throw new TypeError("Setup.properties can't be null.");const i=new this._dataClass;if(Object.keys(i).forEach(t=>{i[t]=e.properties[t]}),Object.seal(i),(null===(t=this._scoreRules)||void 0===t?void 0:t.length)>0&&(i.score=0,i.badFields=[],i.badReasonIds=[]),!0===this._isDependenciesNeeded)e.dependencyData?i.dependencies=g.create(e.dependencyData,(e.dependencyIdFields||["id"]).map(e=>i[e])):console.warn(`This data (of type ${this._dataClass}) is defined as with dependencies, but no dependencies were provided.`);else if(e.dependencyData)throw new TypeError(`This data (of type ${this._dataClass}) is defined as without dependencies, but some dependencies were provided.`);return i}computeScore(e){return this._scoreRules.filter(t=>{try{if(!0===t.formula(e))return!0}catch(t){console.error("COMPUTE SCORE",t,e)}return!1}).forEach(t=>{e.score++,e.badFields.push(t.badField),e.badReasonIds.push(t.id)}),e}createWithScore(e){return this.computeScore(this.create(e))}}class mt{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying Tooling API about ApexClass, ApexCodeCoverage, ApexCodeCoverageAggregate and AsyncApexJob in the org...");const s=yield e.soqlQuery([{string:"SELECT Id, Name, ApiVersion, NamespacePrefix, Body, LengthWithoutComments, SymbolTable, CreatedDate, LastModifiedDate FROM ApexClass WHERE ManageableState IN ('installedEditable', 'unmanaged') ORDER BY Id",tooling:!0},{string:"SELECT ApexClassId FROM AsyncApexJob WHERE JobType = 'ScheduledApex' AND ApexClass.ManageableState IN ('installedEditable', 'unmanaged') ",tooling:!0},{string:"SELECT ApexClassId, MethodName, ApexTestRunResult.CreatedDate, RunTime, Outcome, StackTrace, (SELECT Cpu, AsyncCalls, Sosl, Soql, QueryRows, DmlRows, Dml FROM ApexTestResults LIMIT 1) FROM ApexTestResult WHERE (Outcome != 'Pass' OR RunTime > 20000) AND ApexTestRunResult.Status = 'Completed' AND ApexClass.ManageableState IN ('installedEditable', 'unmanaged') ORDER BY ApexClassId, ApexTestRunResult.CreatedDate desc, MethodName ",tooling:!0}],i),r=t.getInstance(_),o=t.getInstance(N),n=s[0],a=s[1],l=s[2];null==i||i.log(`Retrieving dependencies of ${null==n?void 0:n.length} apex classes...`);const d=yield b.map(n,t=>e.caseSafeId(t.Id)),c=yield e.dependenciesQuery(d,i),u=[],g=[];for(let e=0;e<(null==d?void 0:d.length);e+=500){const t=`'${d.slice(e,e+500).join("','")}'`;u.push({string:`SELECT ApexClassOrTriggerId, ApexTestClassId FROM ApexCodeCoverage WHERE ApexClassOrTriggerId IN (${t}) AND ApexTestClass.ManageableState IN ('installedEditable', 'unmanaged') GROUP BY ApexClassOrTriggerId, ApexTestClassId `,queryMoreField:"CreatedDate",tooling:!0}),g.push({string:`SELECT ApexClassOrTriggerId, NumLinesCovered, NumLinesUncovered, Coverage FROM ApexCodeCoverageAggregate WHERE ApexClassOrTriggerId IN (${t}) `,tooling:!0})}const h=yield Promise.all([e.soqlQuery(u,i),e.soqlQuery(g,i)]),m=[].concat(...h[0]),f=[].concat(...h[1]);null==i||i.log(`Parsing ${null==n?void 0:n.length} apex classes...`);const E=new Map(yield b.map(n,t=>C(this,void 0,void 0,function*(){var i,s,o,n,a;const l=e.caseSafeId(t.Id),d=r.create({properties:{id:l,name:t.Name,apiVersion:t.ApiVersion,package:t.NamespacePrefix||"",isTest:!1,isAbstract:!1,isClass:!0,isEnum:!1,isInterface:!1,isSchedulable:!1,isScheduled:!1,length:null==t?void 0:t.lengthWithoutComments,needsRecompilation:!t.SymbolTable,coverage:0,relatedTestClasses:[],relatedClasses:[],createdDate:t.CreatedDate,lastModifiedDate:t.LastModifiedDate,url:e.setupUrl(l,T.APEX_CLASS)},dependencyData:c});if(t.SymbolTable&&(d.innerClassesCount=(null===(i=t.SymbolTable.innerClasses)||void 0===i?void 0:i.length)||0,d.interfaces=t.SymbolTable.interfaces,d.isSchedulable=null!==(o=null===(s=t.SymbolTable.interfaces)||void 0===s?void 0:s.includes("System.Schedulable"))&&void 0!==o&&o,d.methodsCount=(null===(n=t.SymbolTable.methods)||void 0===n?void 0:n.length)||0,d.extends=t.SymbolTable.parentClass,t.SymbolTable.tableDeclaration&&(d.annotations=null===(a=t.SymbolTable.tableDeclaration.annotations)||void 0===a?void 0:a.map(e=>{var t;return null!==(t=null==e?void 0:e.name)&&void 0!==t?t:e}),yield b.forEach(t.SymbolTable.tableDeclaration.modifiers,e=>{switch(e){case"with sharing":d.specifiedSharing="with";break;case"without sharing":d.specifiedSharing="without";break;case"inherited sharing":d.specifiedSharing="inherited";break;case"public":d.specifiedAccess="public";break;case"private":d.specifiedAccess="private";break;case"global":d.specifiedAccess="global";break;case"virtual":d.specifiedAccess="virtual";break;case"abstract":d.isAbstract=!0;break;case"testMethod":d.isTest=!0;break;default:console.error(`Unsupported modifier in SymbolTable.tableDeclaration: ${e} (ApexClassId=${d.id})`)}}))),t.Body){const e=p.RemoveCommentsFromCode(t.Body);d.isInterface=p.IsInterfaceFromApexCode(e),d.isEnum=p.IsEnumFromApexCode(e),d.isClass=!1===d.isInterface&&!1===d.isEnum,d.hardCodedURLs=p.FindHardCodedURLs(e),d.hardCodedIDs=p.FindHardCodedIDs(e),!0===d.isTest&&(d.isTestSeeAllData=p.IsTestSeeAllDataFromApexCode(e),d.nbSystemAsserts=p.CountOfAssertsFromApexCode(e))}return!0!==d.isEnum&&!0!==d.isInterface||(d.specifiedSharing="Not applicable"),[d.id,d]})));null==i||i.log(`Parsing ${null==m?void 0:m.length} apex code coverages...`);const v=new Map,S=new Map;return yield b.forEach(m,t=>{const i=e.caseSafeId(t.ApexClassOrTriggerId),s=e.caseSafeId(t.ApexTestClassId);E.has(i)&&(!1===v.has(i)&&v.set(i,new Set),!1===S.has(s)&&S.set(s,new Set),v.get(i).add(s),S.get(s).add(i))}),yield Promise.all([b.forEach(v,(e,t)=>{E.has(t)&&(E.get(t).relatedTestClassIds=Array.from(e))}),b.forEach(S,(e,t)=>{E.has(t)&&(E.get(t).relatedClassIds=Array.from(e))})]),null==i||i.log(`Parsing ${null==f?void 0:f.length} apex code coverage aggregates...`),yield b.forEach(f,t=>{const i=e.caseSafeId(t.ApexClassOrTriggerId);E.has(i)&&(E.get(i).coverage=t.NumLinesCovered/(t.NumLinesCovered+t.NumLinesUncovered))}),null==i||i.log(`Parsing ${null==a?void 0:a.length} schedule apex classes...`),yield b.forEach(a,t=>{const i=e.caseSafeId(t.ApexClassId);E.has(i)&&(E.get(i).isScheduled=!0)}),null==i||i.log(`Parsing ${null==l?void 0:l.length} test results...`),yield b.forEach(l,t=>{var i,s,r,n;const a=e.caseSafeId(t.ApexClassId);if(E.has(a)){const e=E.get(a);if(!0===e.isTest&&(e.lastTestRunDate||(e.lastTestRunDate=null===(i=t.ApexTestRunResult)||void 0===i?void 0:i.CreatedDate,e.testMethodsRunTime=0,e.testPassedButLongMethods=[],e.testFailedMethods=[]),e.lastTestRunDate===(null===(s=t.ApexTestRunResult)||void 0===s?void 0:s.CreatedDate))){const i=o.create({properties:{methodName:t.MethodName,isSuccessful:"Pass"===t.Outcome,runtime:t.RunTime,stacktrace:t.StackTrace}});if((null===(r=t.ApexTestResults)||void 0===r?void 0:r.records)&&(null===(n=t.ApexTestResults.records)||void 0===n?void 0:n.length)>0){const e=t.ApexTestResults.records[0];e.Cpu>0&&(i.cpuConsumption=e.Cpu),e.AsyncCalls>0&&(i.asyncCallsConsumption=e.AsyncCalls),e.Sosl>0&&(i.soslConsumption=e.Sosl),e.Soql>0&&(i.soqlConsumption=e.Soql),e.QueryRows>0&&(i.queryRowsConsumption=e.QueryRows),e.DmlRows>0&&(i.dmlRowsConsumption=e.DmlRows),e.Dml>0&&(i.dmlConsumption=e.Dml)}e.testMethodsRunTime+=i.runtime,(i.isSuccessful?e.testPassedButLongMethods:e.testFailedMethods).push(i)}}}),null==i||i.log(`Computing scores for ${E.size} Apex classes...`),yield b.forEach(E,e=>{r.computeScore(e)}),null==i||i.log("Done"),E})}}class ft{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying Tooling API about ApexTrigger in the org...");const s=yield e.soqlQuery([{string:"SELECT Id, Name, ApiVersion, Status, NamespacePrefix, Body, UsageBeforeInsert, UsageAfterInsert, UsageBeforeUpdate, UsageAfterUpdate, UsageBeforeDelete, UsageAfterDelete, UsageAfterUndelete, UsageIsBulk, LengthWithoutComments, EntityDefinition.QualifiedApiName, CreatedDate, LastModifiedDate FROM ApexTrigger WHERE ManageableState IN ('installedEditable', 'unmanaged') ",tooling:!0}],i),r=t.getInstance(F),o=s[0];null==i||i.log(`Retrieving dependencies of ${null==o?void 0:o.length} apex triggers...`);const n=yield e.dependenciesQuery(yield b.map(o,t=>e.caseSafeId(t.Id)),i);null==i||i.log(`Parsing ${null==o?void 0:o.length} apex triggers...`);const a=new Map(yield b.map(o,t=>{var i,s;const o=e.caseSafeId(t.Id),a=r.create({properties:{id:o,name:t.Name,apiVersion:t.ApiVersion,package:t.NamespacePrefix||"",length:null==t?void 0:t.lengthWithoutComments,isActive:"Active"===t.Status,beforeInsert:t.UsageBeforeInsert,afterInsert:t.UsageAfterInsert,beforeUpdate:t.UsageBeforeUpdate,afterUpdate:t.UsageAfterUpdate,beforeDelete:t.UsageBeforeDelete,afterDelete:t.UsageAfterDelete,afterUndelete:t.UsageAfterUndelete,objectId:e.caseSafeId(null===(i=t.EntityDefinition)||void 0===i?void 0:i.QualifiedApiName),hasSOQL:!1,hasDML:!1,createdDate:t.CreatedDate,lastModifiedDate:t.LastModifiedDate,url:e.setupUrl(o,T.APEX_TRIGGER,null===(s=t.EntityDefinition)||void 0===s?void 0:s.QualifiedApiName)},dependencyData:n});if(t.Body){const e=p.RemoveCommentsFromCode(t.Body);a.hasSOQL=p.HasSOQLFromApexCode(e),a.hasDML=p.HasDMLFromApexCode(e),a.hardCodedURLs=p.FindHardCodedURLs(e),a.hardCodedIDs=p.FindHardCodedIDs(e)}return r.computeScore(a),[a.id,a]},e=>!!e.EntityDefinition));return null==i||i.log("Done"),a})}}class Et{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying REST API about Applications (tab set typed) in the org...");const s=yield e.soqlQuery([{string:"SELECT ApplicationId, Name, Label, NamespacePrefix FROM AppMenuItem WHERE Type = 'TabSet' "}],i),r=t.getInstance(We),o=s[0];null==i||i.log(`Parsing ${null==o?void 0:o.length} applications...`);const n=new Map(yield b.map(o,t=>{const i=e.caseSafeId(t.ApplicationId);return[i,r.create({properties:{id:i,name:t.Name,label:t.Label,package:t.NamespacePrefix||""}})]}));return null==i||i.log("Done"),n})}}class vt{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying REST API about SetupEntityAccess for TabSet in the org...");const s=yield e.soqlQuery([{string:"SELECT ApplicationId, IsAccessible, IsVisible FROM AppMenuItem WHERE Type = 'TabSet' "},{string:"SELECT SetupEntityId, ParentId, Parent.IsOwnedByProfile, Parent.ProfileId FROM SetupEntityAccess WHERE SetupEntityType = 'TabSet' "}],i),r=t.getInstance(ke),o=s[0],n=s[1];null==i||i.log(`Parsing ${null==o?void 0:o.length} Application Menu Items...`);const a=new Map(yield b.map(o,t=>[e.caseSafeId(t.ApplicationId),{a:t.IsAccessible,v:t.IsVisible}]));null==i||i.log(`Parsing ${null==n?void 0:n.length} Setup Entity Accesses...`);const l=new Map(yield b.map(n,t=>{const i=e.caseSafeId(t.SetupEntityId),s=e.caseSafeId(t.Parent.IsOwnedByProfile?t.Parent.ProfileId:t.ParentId),o=a.get(i);return[`${i}-${s}`,r.create({properties:{appId:i,parentId:s,isAccessible:o.a,isVisible:o.v}})]},t=>a.has(e.caseSafeId(t.SetupEntityId))));return null==i||i.log("Done"),l})}}class St{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying REST API about LoginHistory in the org...");const s=yield e.soqlQuery([{string:"SELECT Browser, COUNT(Id) CntBrowser FROM LoginHistory WHERE LoginType = 'Application' GROUP BY Browser ",queryMoreField:"LoginTime"}],i),r=t.getInstance(U),o=s[0];null==i||i.log(`Parsing ${null==o?void 0:o.length} browsers...`);const n=new Map;return yield b.forEach(o,e=>{var t;const i=e.Browser.split(" ",2),s=i&&(null==i?void 0:i.length)>0?i[0]:e.Browser,o=i&&(null==i?void 0:i.length)>1?i[1]:"",a=null!==(t=Number.parseInt(o,10))&&void 0!==t?t:NaN;if(n.has(s)){n.get(s).nbApplicationLogin+=e.CntBrowser}else{const t=r.create({properties:{fullName:e.Browser,name:s,version:a,nbApplicationLogin:e.CntBrowser}});n.set(s,t)}}),null==i||i.log("Done"),n})}}class It{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying REST API about CollaborationGroup in the org...");const s=yield e.soqlQuery([{byPasses:["INVALID_TYPE"],string:"SELECT Id, InformationBody, Description, Name, CreatedDate, LastModifiedDate FROM CollaborationGroup "}],i),r=t.getInstance(x),o=s[0];null==i||i.log(`Parsing ${null==o?void 0:o.length} chatter groups...`);const n=new Map(yield b.map(o,t=>{const i=e.caseSafeId(t.Id),s=r.create({properties:{id:i,name:t.Name,createdDate:t.CreatedDate,lastModifiedDate:t.LastModifiedDate,description:t.Description,url:e.setupUrl(i,T.COLLABORATION_GROUP)}});if(t.InformationBody){const e=p.RemoveCommentsFromXML(t.InformationBody);s.hardCodedURLs=p.FindHardCodedURLs(e),s.hardCodedIDs=p.FindHardCodedIDs(e)}return r.computeScore(s),[s.id,s]}));return null==i||i.log("Done"),n})}}class yt{run(e,t,i,s){return C(this,void 0,void 0,function*(){const t=null==s?void 0:s.get($e.SYSTEM_PERMISSIONS_LIST);if(void 0===t||0===(null==t?void 0:t.length))throw new Error(`DatasetCurrentUserPermissions: No '${$e.SYSTEM_PERMISSIONS_LIST}' were provided in the parameters.`);if(!Array.isArray(t))throw new Error(`DatasetCurrentUserPermissions: '${$e.SYSTEM_PERMISSIONS_LIST}' parameter should be an array of permission names.`);null==i||i.log("Querying REST API about UserPermissionAccess in the org...");const r=yield e.soqlQuery(t.map(e=>({string:`SELECT Permissions${e} FROM UserPermissionAccess LIMIT 1`,byPasses:["INVALID_FIELD"]})),i);null==i||i.log("Parsing the results...");const o=new Map;return r.forEach(e=>{if(1===(null==e?void 0:e.length)){const t=e[0];if(t){const e=Object.keys(t).filter(e=>e.startsWith("Permissions"));if(1===(null==e?void 0:e.length)){const i=e[0];if(i){const e=i.substring(11);o.set(e,t[i])}}}}}),o})}}const Rt=["00a","017","02c","0D5","1CE"];class Pt{run(e,t,i,s){return C(this,void 0,void 0,function*(){const r=$e.getSObjectName(s);null==i||i.log("Querying Tooling API about CustomField in the org...");const o=yield e.soqlQuery([{tooling:!0,string:"SELECT Id, EntityDefinition.QualifiedApiName, EntityDefinition.IsCustomSetting, EntityDefinition.KeyPrefix FROM CustomField WHERE ManageableState IN ('installedEditable', 'unmanaged') "+(r===$e.ALL_VALUES?"":`AND EntityDefinition.QualifiedApiName = '${r}'`)}],i),n=t.getInstance(k),a=o[0];null==i||i.log(`Parsing ${null==a?void 0:a.length} custom fields...`);const l=new Map(yield b.map(a,t=>[e.caseSafeId(t.Id),{qualifiedApiName:t.EntityDefinition.QualifiedApiName,isCustomSetting:t.EntityDefinition.IsCustomSetting}],e=>{var t;return!!e.EntityDefinition&&(!Rt.includes(e.EntityDefinition.KeyPrefix)&&!(null===(t=e.EntityDefinition.QualifiedApiName)||void 0===t?void 0:t.endsWith("_hd")))}));null==i||i.log(`Retrieving dependencies of ${null==a?void 0:a.length} custom fields...`);const d=yield e.dependenciesQuery(yield b.map(a,t=>e.caseSafeId(t.Id)),i);null==i||i.log(`Calling Tooling API Composite to get more information about these ${l.size} custom fields...`);const c=yield e.readMetadataAtScale("CustomField",Array.from(l.keys()),["INVALID_CROSS_REFERENCE_KEY"],i),u=new Map(yield b.map(c,t=>{var i;const s=e.caseSafeId(t.Id),r=l.get(s),o=n.create({properties:{id:s,name:t.DeveloperName,label:t.Metadata.label,package:t.NamespacePrefix||"",description:t.Description,isCustom:!0,createdDate:t.CreatedDate,lastModifiedDate:t.LastModifiedDate,objectId:r.qualifiedApiName,tooltip:t.InlineHelpText,type:t.Metadata.type,length:null===(i=t.Metadata)||void 0===i?void 0:i.length,isUnique:!0===t.Metadata.unique,isEncrypted:null!==t.Metadata.encryptionScheme&&"None"!==t.Metadata.encryptionScheme,isExternalId:!0===t.Metadata.externalId,isIndexed:!0===t.Metadata.unique||!0===t.Metadata.externalId,defaultValue:t.Metadata.defaultValue,formula:t.Metadata.formula,url:e.setupUrl(s,T.CUSTOM_FIELD,r.qualifiedApiName,e.getObjectType(r.qualifiedApiName,r.isCustomSetting))},dependencyData:d});if(t.Metadata.valueSet?"string"==typeof t.Metadata.valueSet?o.isRestrictedPicklist=!0:o.isRestrictedPicklist=!0===t.Metadata.valueSet.restricted:o.isRestrictedPicklist=!1,o.formula){const e=p.RemoveCommentsFromCode(o.formula);o.hardCodedURLs=p.FindHardCodedURLs(e),o.hardCodedIDs=p.FindHardCodedIDs(e)}return n.computeScore(o),[o.id,o]}));return null==i||i.log("Done"),u})}}class At{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying Tooling API about ExternalString in the org...");const s=yield e.soqlQuery([{tooling:!0,string:"SELECT Id, Name, NamespacePrefix, Category, IsProtected, Language, MasterLabel, Value, CreatedDate, LastModifiedDate FROM ExternalString WHERE ManageableState IN ('installedEditable', 'unmanaged') "}],i),r=t.getInstance(G),o=s[0];null==i||i.log(`Retrieving dependencies of ${null==o?void 0:o.length} custom labels...`);const n=yield e.dependenciesQuery(yield b.map(o,t=>e.caseSafeId(t.Id)),i);null==i||i.log(`Parsing ${null==o?void 0:o.length} custom labels...`);const a=new Map(yield b.map(o,t=>{const i=e.caseSafeId(t.Id),s=r.createWithScore({properties:{id:i,name:t.Name,package:t.NamespacePrefix||"",category:t.Category,isProtected:!0===t.IsProtected,language:t.Language,label:t.MasterLabel,value:t.Value,createdDate:t.CreatedDate,lastModifiedDate:t.LastModifiedDate,url:e.setupUrl(i,T.CUSTOM_LABEL)},dependencyData:n});return[s.id,s]}));return null==i||i.log("Done"),a})}}class Tt{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying Tooling API about CustomTab in the org...");const s=yield e.soqlQuery([{tooling:!0,string:"SELECT Id, DeveloperName, Type, Url, CreatedDate, Description, LastModifiedDate, NamespacePrefix FROM CustomTab WHERE ManageableState IN ('installedEditable', 'unmanaged')"}],i),r=t.getInstance(B),o=s[0];null==i||i.log(`Retrieving dependencies of ${null==o?void 0:o.length} custom tabs...`);const n=yield e.dependenciesQuery(yield b.map(o,t=>e.caseSafeId(t.Id)),i);null==i||i.log(`Parsing ${null==o?void 0:o.length} custom tabs...`);const a=new Map(yield b.map(o,t=>{const i=e.caseSafeId(t.Id),s=r.createWithScore({properties:{id:i,name:t.DeveloperName||`${i} (No name from API!)`,package:t.NamespacePrefix||"",type:t.Type,description:t.Description,createdDate:t.CreatedDate,lastModifiedDate:t.LastModifiedDate,hardCodedURLs:p.FindHardCodedURLs(t.Url),hardCodedIDs:p.FindHardCodedIDs(t.Url),url:e.setupUrl(i,T.CUSTOM_TAB)},dependencyData:n});return[s.id,s]}));return null==i||i.log("Done"),a})}}class Ct{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying REST API about dashboards in the org...");const s=yield e.soqlQuery([{string:"SELECT Id, FolderName, FolderId, Title, DeveloperName, NamespacePrefix, Description, CreatedDate, LastModifiedDate, Type, LastViewedDate, LastReferencedDate, DashboardResultRefreshedDate FROM Dashboard "}],i),r=t.getInstance(V),o=s[0];null==i||i.log(`Parsing ${null==o?void 0:o.length} dashboards...`);const n=new Map(yield b.map(o,t=>C(this,void 0,void 0,function*(){const i=e.caseSafeId(t.Id),s=r.createWithScore({properties:{id:i,folderName:t.FolderName,folderId:t.FolderId,title:t.Title,developerName:t.DeveloperName,package:t.NamespacePrefix||"",description:t.Description,createdDate:t.CreatedDate,lastModifiedDate:t.LastModifiedDate,type:t.Type,lastViewedDate:t.LastViewedDate,lastReferencedDate:t.LastReferencedDate,resultRefreshedDate:t.DashboardResultRefreshedDate,url:e.setupUrl(i,T.DASHBOARD)}});return[s.id,s]})));return null==i||i.log("Done"),n})}}class bt{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying REST API about Document in the org...");const s=yield e.soqlQuery([{string:"SELECT Id, Name, Url, BodyLength, ContentType, CreatedDate, Description, DeveloperName, Folder.Name, Folder.Id, LastModifiedDate, NamespacePrefix FROM Document "}],i),r=t.getInstance($),o=s[0];null==i||i.log(`Parsing ${null==o?void 0:o.length} documents...`);const n=new Map(yield b.map(o,t=>{var i,s,o;const n=e.caseSafeId(t.Id),a=r.createWithScore({properties:{id:n,name:t.Name,documentUrl:t.Url,isHardCodedURL:(null===(i=p.FindHardCodedURLs(t.Url))||void 0===i?void 0:i.length)>0||!1,size:t.BodyLength,type:t.ContentType,description:t.Description,createdDate:t.CreatedDate,lastModifiedDate:t.LastModifiedDate,folderId:null===(s=t.Folder)||void 0===s?void 0:s.Id,folderName:null===(o=t.Folder)||void 0===o?void 0:o.Name,package:t.NamespacePrefix||"",url:e.setupUrl(n,T.DOCUMENT)}});return[a.id,a]}));return null==i||i.log("Done"),n})}}class Ot{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying REST API about EmailTemplates in the org...");const s=yield e.soqlQuery([{string:"SELECT Id, Name, ApiVersion, IsActive, HtmlValue, Body, Markup, CreatedDate, LastModifiedDate, FolderId, FolderName, Description, LastUsedDate, TimesUsed, UiType, TemplateType, NamespacePrefix FROM EmailTemplate"}],i),r=t.getInstance(W),o=s[0];null==i||i.log(`Parsing ${null==o?void 0:o.length} email templates...`);const n=new Map(yield b.map(o,t=>{const i=e.caseSafeId(t.Id),s=p.RemoveCommentsFromXML(t.HtmlValue||t.Body||t.Markup||""),o=r.createWithScore({properties:{id:i,name:t.Name,apiVersion:t.ApiVersion,isActive:t.IsActive,description:t.Description,package:t.NamespacePrefix||"",hardCodedURLs:p.FindHardCodedURLs(s),hardCodedIDs:p.FindHardCodedIDs(s),createdDate:t.CreatedDate,uiType:t.UiType,type:t.TemplateType,lastModifiedDate:t.LastModifiedDate,lastUsedDate:t.LastUsedDate,timesUsed:t.TimesUsed,folderId:t.FolderId,folderName:t.FolderName,url:e.setupUrl(i,T.EMAIL_TEMPLATE)}});return[o.id,o]}));return null==i||i.log("Done"),n})}}class Lt{run(e,t,i,s){return C(this,void 0,void 0,function*(){const r=$e.getSObjectName(s);null==i||i.log("Querying REST API about SetupEntityAccess for TabSet in the org...");const o=yield e.soqlQuery([{string:`SELECT Field, PermissionsRead, PermissionsEdit, ParentId, Parent.IsOwnedByProfile, Parent.ProfileId FROM FieldPermissions WHERE SObjectType = '${r}' `}],i),n=t.getInstance(He),a=o[0];null==i||i.log(`Parsing ${null==a?void 0:a.length} Field Permissions...`);const l=new Map(yield b.map(a,t=>{const i=e.caseSafeId(!0===t.Parent.IsOwnedByProfile?t.Parent.ProfileId:t.ParentId),s=t.Field.indexOf("."),r=-1===s?t.Field:t.Field.substring(s+1),o=n.create({properties:{fieldApiName:r,parentId:i,isRead:t.PermissionsRead,isEdit:t.PermissionsEdit}});return[`${t.Field}-${i}`,o]},e=>!!e.Parent&&(!!e.ParentId&&(!1!==`${e.ParentId}`.startsWith("0PS")&&!!e.Field))));return null==i||i.log("Done"),l})}}class wt{static normalizeMetadata(e){if(null==e)return null;if("object"!=typeof e)return e;if(Array.isArray(e))return e.filter(e=>null!=e).map(e=>this.normalizeMetadata(e));const t={};for(const i in e){const s=e[i];if(null!=s){const e=this.normalizeMetadata(s);null==e||Array.isArray(e)&&0===(null==e?void 0:e.length)||(t[i]=e)}}return t}static scanFlows(e,t){return C(this,void 0,void 0,function*(){var i;let s=new Map;try{const r="undefined"!=typeof window?null===window||void 0===window?void 0:window.lightningflowscanner:null!==(i=null===globalThis||void 0===globalThis?void 0:globalThis.lightningflowscanner)&&void 0!==i?i:null;if(r){const i=e.filter(e=>e.Metadata).map(e=>{const i=t(e.Id);return{uri:i,flow:new r.Flow(i,this.normalizeMetadata(e.Metadata))}}),o=r.scan(i);s=this.mapResults(o)}}catch(e){console.info(`Error scanning flows with LFS: returning an empty map (error: ${null==e?void 0:e.message})`)}return s})}static mapResults(e){const t=new Map;for(const i of e){const e=i.ruleResults.filter(e=>!0===e.occurs).map(e=>e.ruleName);(null==e?void 0:e.length)>0&&t.set(i.flow.uri,e)}return t}}const Mt={ApprovalWorkflow:"Approval Workflow",AutoLaunchedFlow:"Auto-Launched Flow",Flow:"Screen Flow",InvocableProcess:"Invocable Process",LoginFlow:"Login Flow",Survey:"Survey",Workflow:"Process Builder"};class Dt{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying Tooling API about FlowDefinition in the org...");const s=yield e.soqlQuery([{string:"SELECT Id, DeveloperName, ApiVersion, Description, ActiveVersionId, LatestVersionId, CreatedDate, LastModifiedDate FROM FlowDefinition",tooling:!0},{string:"SELECT DefinitionId, COUNT(Id) NbVersions FROM Flow GROUP BY DefinitionId",queryMoreField:"CreatedDate",tooling:!0}],i),r=t.getInstance(j),o=t.getInstance(Q),n=s[0],a=s[1];null==i||i.log(`Retrieving dependencies of ${null==n?void 0:n.length} flow versions...`);const l=[];yield b.forEach(n,t=>{var i;l.push(e.caseSafeId(null!==(i=t.ActiveVersionId)&&void 0!==i?i:t.LatestVersionId)),l.push(e.caseSafeId(t.Id))});const d=yield e.dependenciesQuery(l,i),c=[];null==i||i.log(`Parsing ${null==n?void 0:n.length} flow definitions...`);const u=new Map(yield b.map(n,t=>{const i=e.caseSafeId(t.Id),s=e.caseSafeId(t.ActiveVersionId),o=e.caseSafeId(t.LatestVersionId),n=r.create({properties:{id:i,name:t.DeveloperName,apiVersion:t.ApiVersion,currentVersionId:null!=s?s:o,isLatestCurrentVersion:s===o,isVersionActive:!!s,versionsCount:0,description:t.Description,createdDate:t.CreatedDate,lastModifiedDate:t.LastModifiedDate,url:e.setupUrl(i,T.FLOW_DEFINITION)},dependencyData:d,dependencyIdFields:["id","currentVersionId"]});return c.push(n.currentVersionId),[n.id,n]}));null==i||i.log(`Parsing ${null==a?void 0:a.length} flow versions...`),yield b.forEach(a,t=>{const i=e.caseSafeId(t.DefinitionId),s=u.get(i);s&&(s.versionsCount+=t.NbVersions)}),null==i||i.log(`Calling Tooling API Composite to get more information about these ${null==c?void 0:c.length} flow versions...`);const p=yield e.readMetadataAtScale("Flow",c,["UNKNOWN_EXCEPTION"],i);null==i||i.log(`Scanning ${null==p?void 0:p.length} flows with Lightning Flow Scanner...`);const g=yield wt.scanFlows(p,e.caseSafeId);return null==i||i.log(`LFS gave us ${g.size} violations.`),null==i||i.log(`Parsing ${null==p?void 0:p.length} flow versions from Tooling API...`),yield b.forEach(p,t=>{var i,s,r,n,a,l,d,c,p;const h=e.caseSafeId(t.Id),m=e.caseSafeId(t.DefinitionId),f=null!==(i=g.get(h))&&void 0!==i?i:[],E=o.create({properties:{id:h,name:t.FullName,version:t.VersionNumber,apiVersion:t.ApiVersion,totalNodeCount:["actionCalls","apexPluginCalls","assignments","collectionProcessors","decisions","loops","orchestratedStages","recordCreates","recordDeletes","recordLookups","recordRollbacks","recordUpdates","screens","steps","waits"].reduce((e,i)=>{var s;return e+(null===(s=t.Metadata[i])||void 0===s?void 0:s.length)||0},0),dmlCreateNodeCount:(null===(s=t.Metadata.recordCreates)||void 0===s?void 0:s.length)||0,dmlDeleteNodeCount:(null===(r=t.Metadata.recordDeletes)||void 0===r?void 0:r.length)||0,dmlUpdateNodeCount:(null===(n=t.Metadata.recordUpdates)||void 0===n?void 0:n.length)||0,screenNodeCount:(null===(a=t.Metadata.screens)||void 0===a?void 0:a.length)||0,sobject:(null===(l=t.Metadata.start)||void 0===l?void 0:l.object)||"",triggerType:(null===(d=t.Metadata.start)||void 0===d?void 0:d.triggerType)||"",recordTriggerType:(null===(c=t.Metadata.start)||void 0===c?void 0:c.recordTriggerType)||"",isActive:"Active"===t.Status,description:t.Description,type:Mt[t.ProcessType]||`Other (${t.ProcessType})`,isProcessBuilder:"Workflow"===t.ProcessType,isScreenFlow:"Flow"===t.ProcessType,runningMode:t.RunInMode,createdDate:t.CreatedDate,lastModifiedDate:t.LastModifiedDate,lfsViolations:f,url:e.setupUrl(h,T.FLOW_VERSION)}});!0===E.isProcessBuilder&&(null===(p=t.Metadata.processMetadataValues)||void 0===p||p.forEach(e=>{"ObjectType"===e.name&&(E.sobject=e.value.stringValue),"TriggerType"===e.name&&(E.triggerType=e.value.stringValue)}));const v=u.get(m);v.currentVersionRef=E,v.type=E.type,v.isProcessBuilder=E.isProcessBuilder,v.isScreenFlow=E.isScreenFlow,v.description||(v.description=E.description)}),yield b.forEach(u,e=>r.computeScore(e)),null==i||i.log("Done"),u})}}class Nt{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying REST API about Group in the org...");const s=yield e.soqlQuery([{string:"SELECT Id, Name, DeveloperName, DoesIncludeBosses, Type, RelatedId, Related.Name, (SELECT UserOrGroupId From GroupMembers)FROM Group "}],i),r=t.getInstance(q),o=s[0];null==i||i.log(`Parsing ${null==o?void 0:o.length} groups...`);const n=new Map(yield b.map(o,t=>C(this,void 0,void 0,function*(){var i,s,o;const n=e.caseSafeId(t.Id);let a,l,d,c,u,p;switch(t.Type){case"Regular":case"Queue":a="Regular"===t.Type?T.PUBLIC_GROUP:T.QUEUE,l=t.Name,d=t.DeveloperName,c=t.DoesIncludeBosses;break;case"Role":case"RoleAndSubordinates":case"RoleAndSubordinatesInternal":a=T.ROLE,l=null!==(s=null===(i=t.Related)||void 0===i?void 0:i.Name)&&void 0!==s?s:"(unknown)",u="Role"!==t.Type,p=e.caseSafeId(t.RelatedId);break;default:l=t.Type,a=T.TECHNICAL_GROUP}const g=[],h=[];t.GroupMembers&&t.GroupMembers.records&&(null===(o=t.GroupMembers.records)||void 0===o?void 0:o.length)>0&&(yield b.forEach(t.GroupMembers.records,t=>{const i=e.caseSafeId(t.UserOrGroupId);(i.startsWith("005")?g:h).push(i)}));const m=r.createWithScore({properties:{id:n,name:l,developerName:d,type:a,isPublicGroup:"Regular"===t.Type,isQueue:"Queue"===t.Type,nbDirectMembers:(null==g?void 0:g.length)+(null==h?void 0:h.length),directUserIds:g,directGroupIds:h,includeBosses:!0===c,includeSubordinates:!0===u,relatedId:p,url:e.setupUrl(null!=p?p:n,a)}});return[m.id,m]})));return null==i||i.log("Done"),n})}}class _t{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying Tooling API about SFDC_HomePageComponent in the org...");const s=yield e.soqlQuery([{tooling:!0,string:"SELECT Id, Name, Body, CreatedDate, LastModifiedDate, NamespacePrefix FROM Homepagecomponent WHERE ManageableState IN ('installedEditable', 'unmanaged')"}],i),r=t.getInstance(J),o=s[0];null==i||i.log(`Retrieving dependencies of ${null==o?void 0:o.length} homepage components...`);const n=yield e.dependenciesQuery(yield b.map(o,t=>e.caseSafeId(t.Id)),i);null==i||i.log(`Parsing ${null==o?void 0:o.length} homepage components...`);const a=new Map(yield b.map(o,t=>{const i=e.caseSafeId(t.Id),s=r.create({properties:{id:i,name:t.Name,package:t.NamespacePrefix||"",isBodyEmpty:!t.Body,createdDate:t.CreatedDate,lastModifiedDate:t.LastModifiedDate,url:e.setupUrl(i,T.HOME_PAGE_COMPONENT)},dependencyData:n});if(t.Body){const e=p.RemoveCommentsFromXML(t.Body);s.hardCodedURLs=p.FindHardCodedURLs(e),s.hardCodedIDs=p.FindHardCodedIDs(e)}return r.computeScore(s),[s.id,s]}));return null==i||i.log("Done"),a})}}class Ft{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying REST API about internal active User in the org...");const s=yield e.soqlQuery([{string:"SELECT Id, Name, ProfileId, LastLoginDate, LastPasswordChangeDate, NumberOfFailedLogins, UserPreferencesLightningExperiencePreferred, UserPreferencesUserDebugModePref FROM User WHERE IsActive = true AND ContactId = NULL AND Profile.Id != NULL "},{string:"SELECT Id, AssigneeId, PermissionSetId, PermissionSet.IsOwnedByProfile, PermissionSet.PermissionsModifyAllData, PermissionSet.PermissionsViewAllData, PermissionSet.PermissionsManageUsers, PermissionSet.PermissionsCustomizeApplication, PermissionSet.PermissionsBypassMFAForUiLogins FROM PermissionSetAssignment WHERE Assignee.IsActive = true AND Assignee.ContactId = NULL AND Assignee.Profile.Id != NULL"},{string:"SELECT UserId, Status, LoginType, COUNT(Id) CntLogins FROM LoginHistory WHERE (LoginType = 'Application' OR LoginType LIKE '%SSO%') GROUP BY UserId, Status, LoginType ",queryMoreField:"LoginTime"},{string:"SELECT UserId, Policy, COUNT(Id) CntVerifications FROM VerificationHistory WHERE Activity = 'Login' AND Status IN ('AutomatedSuccess', 'Succeeded') AND (LoginHistory.LoginType = 'Application') GROUP BY UserId, Policy ",queryMoreField:"VerificationTime"}],i),r=t.getInstance(pe),o=s[0],n=s[1],a=s[2],l=s[3];null==i||i.log(`Parsing ${null==o?void 0:o.length} users...`);const d=new Map(yield b.map(o,t=>C(this,void 0,void 0,function*(){const i=e.caseSafeId(t.Id),s=r.create({properties:{id:i,name:t.Name,lastLogin:t.LastLoginDate,numberFailedLogins:t.NumberOfFailedLogins,onLightningExperience:!0===t.UserPreferencesLightningExperiencePreferred,lastPasswordChange:t.LastPasswordChangeDate,profileId:e.caseSafeId(t.ProfileId),permissionSetIds:[],isAdminLike:!1,hasMfaByPass:!1,hasDebugMode:!0===t.UserPreferencesUserDebugModePref,nbDirectLogins:0,nbDirectLoginsWithMFA:0,nbDirectLoginsWithoutMFA:0,nbSSOLogins:0,url:e.setupUrl(i,T.USER)}});return[s.id,s]})));return null==i||i.log(`Parsing ${null==n?void 0:n.length} permission set assignments...`),n.forEach(t=>{var i,s,r,o,n,a;const l=e.caseSafeId(t.AssigneeId),c=e.caseSafeId(t.PermissionSetId),u=d.get(l);u&&(!1===(null===(i=t.PermissionSet)||void 0===i?void 0:i.IsOwnedByProfile)&&u.permissionSetIds.push(c),!0!==(null===(s=t.PermissionSet)||void 0===s?void 0:s.PermissionsModifyAllData)&&!0!==(null===(r=t.PermissionSet)||void 0===r?void 0:r.PermissionsViewAllData)&&!0!==(null===(o=t.PermissionSet)||void 0===o?void 0:o.PermissionsManageUsers)&&!0!==(null===(n=t.PermissionSet)||void 0===n?void 0:n.PermissionsCustomizeApplication)||(u.isAdminLike=!0),!0===(null===(a=t.PermissionSet)||void 0===a?void 0:a.PermissionsBypassMFAForUiLogins)&&(u.hasMfaByPass=!0))}),null==i||i.log(`Parsing ${null==a?void 0:a.length} user logins aggregates...`),yield b.forEach(a,t=>{if("Success"===t.Status){const i=e.caseSafeId(t.UserId),s=d.get(i);s&&("Application"===t.LoginType?s.nbDirectLogins+=t.CntLogins:s.nbSSOLogins+=t.CntLogins)}}),null==i||i.log(`Parsing ${null==l?void 0:l.length} user verifications aggregates...`),yield b.forEach(l,t=>{const i=e.caseSafeId(t.UserId),s=d.get(i);s&&("TwoFactorAuthentication"===t.Policy?s.nbDirectLoginsWithMFA+=t.CntVerifications:s.nbDirectLoginsWithoutMFA+=t.CntVerifications)}),null==i||i.log(`Computing scores for ${d.size} users...`),yield b.forEach(d,e=>{r.computeScore(e)}),null==i||i.log("Done"),d})}}class Ut{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying SOSL about published KnowledgeArticleVersion containing Salesforce domains...");const s=yield e.soslQuery([{string:"FIND { .salesforce.com OR .force.* } IN ALL FIELDS RETURNING KnowledgeArticleVersion (Id, KnowledgeArticleId, ArticleNumber, CreatedDate, LastModifiedDate, PublishStatus, Title, UrlName )",byPasses:["INVALID_TYPE"]}],i),r=t.getInstance(Y),o=s[0];null==i||i.log(`Parsing ${null==o?void 0:o.length} articles...`);const n=new Map(yield b.map(o,t=>{const i=e.caseSafeId(t.Id),s=e.caseSafeId(t.KnowledgeArticleId),o=r.createWithScore({properties:{id:s,number:t.ArticleNumber,versionId:i,title:t.Title,urlName:t.UrlName,status:t.PublishStatus,createdDate:t.CreatedDate,lastModifiedDate:t.LastModifiedDate,isHardCodedURL:!0,url:e.setupUrl(i,T.KNOWLEDGE_ARTICLE_VERSION)}});return[o.id,o]}));return null==i||i.log("Done"),n})}}class xt{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying Tooling API about AuraDefinitionBundle in the org...");const s=yield e.soqlQuery([{tooling:!0,string:"SELECT Id, MasterLabel, ApiVersion, NamespacePrefix, Description, CreatedDate, LastModifiedDate FROM AuraDefinitionBundle WHERE ManageableState IN ('installedEditable', 'unmanaged') "}],i),r=t.getInstance(K),o=s[0];null==i||i.log(`Retrieving dependencies of ${null==o?void 0:o.length} lightning aura components...`);const n=yield e.dependenciesQuery(yield b.map(o,t=>e.caseSafeId(t.Id)),i);null==i||i.log(`Parsing ${null==o?void 0:o.length} lightning aura components...`);const a=new Map(yield b.map(o,t=>{const i=e.caseSafeId(t.Id),s=r.createWithScore({properties:{id:i,name:t.MasterLabel,apiVersion:t.ApiVersion,package:t.NamespacePrefix||"",createdDate:t.CreatedDate,lastModifiedDate:t.LastModifiedDate,description:t.Description,url:e.setupUrl(i,T.AURA_WEB_COMPONENT)},dependencyData:n});return[s.id,s]}));return null==i||i.log("Done"),a})}}class Gt{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying Tooling API about FlexiPage in the org...");const s=yield e.soqlQuery([{tooling:!0,string:"SELECT Id, MasterLabel, EntityDefinition.QualifiedApiName, Type, NamespacePrefix, Description, CreatedDate, LastModifiedDate FROM FlexiPage WHERE ManageableState IN ('installedEditable', 'unmanaged') "}],i),r=t.getInstance(X),o=s[0],n=yield b.map(o,t=>e.caseSafeId(t.Id));null==i||i.log(`Retrieving dependencies of ${null==o?void 0:o.length} lightning pages...`);const a=yield e.dependenciesQuery(n,i);null==i||i.log(`Parsing ${null==o?void 0:o.length} lightning pages...`);const l=new Map(yield b.map(o,t=>{var i;const s=e.caseSafeId(t.Id),o=r.create({properties:{id:s,name:t.MasterLabel,type:t.Type,package:t.NamespacePrefix||"",createdDate:t.CreatedDate,lastModifiedDate:t.LastModifiedDate,description:t.Description,objectId:(null===(i=t.EntityDefinition)||void 0===i?void 0:i.QualifiedApiName)||"",nbComponents:0,nbFields:0,nbRelatedLists:0,isAttachmentRelatedListIncluded:!1,isRelatedListFromPageLayoutIncluded:!1,url:e.setupUrl(s,T.LIGHTNING_PAGE)},dependencyData:a});return[o.id,o]}));null==i||i.log(`Calling Tooling API Composite to get more information about these ${null==n?void 0:n.length} lightning pages...`);const d=yield e.readMetadataAtScale("FlexiPage",n,["FIELD_INTEGRITY_EXCEPTION","UNKNOWN_EXCEPTION"],i);return null==i||i.log(`Parsing ${null==d?void 0:d.length} lightning pages metadata information...`),yield b.forEach(d,t=>{var i,s;const r=e.caseSafeId(t.Id);if(l.has(r)){const e=l.get(r);null===(s=null===(i=null==t?void 0:t.Metadata)||void 0===i?void 0:i.flexiPageRegions)||void 0===s||s.forEach(t=>{var i;null===(i=null==t?void 0:t.itemInstances)||void 0===i||i.forEach(t=>{var i,s;if(t.componentInstance&&null===t.fieldInstance){e.nbComponents++;const r=t.componentInstance;switch(null==r?void 0:r.componentName){case"force:relatedListContainer":e.isRelatedListFromPageLayoutIncluded=!0,e.nbRelatedLists++;break;case"force:relatedListSingleContainer":!1===e.isAttachmentRelatedListIncluded&&(e.isAttachmentRelatedListIncluded=null!==(s=null===(i=null==r?void 0:r.componentInstanceProperties)||void 0===i?void 0:i.some(e=>"relatedListApiName"===e.name&&"CombinedAttachments"===e.value))&&void 0!==s&&s),e.nbRelatedLists++}}else t.fieldInstance&&null===t.componentInstance&&e.nbFields++})})}}),yield b.forEach(l,e=>{r.computeScore(e)}),null==i||i.log("Done"),l})}}class Bt{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying Tooling API about LightningComponentBundle in the org...");const s=yield e.soqlQuery([{tooling:!0,string:"SELECT Id, MasterLabel, ApiVersion, NamespacePrefix, Description, CreatedDate, LastModifiedDate FROM LightningComponentBundle WHERE ManageableState IN ('installedEditable', 'unmanaged') "}],i),r=t.getInstance(z),o=s[0];null==i||i.log(`Retrieving dependencies of ${null==o?void 0:o.length} lightning web components...`);const n=yield e.dependenciesQuery(yield b.map(o,t=>e.caseSafeId(t.Id)),i);null==i||i.log(`Parsing ${null==o?void 0:o.length} lightning web components...`);const a=new Map(yield b.map(o,t=>{const i=e.caseSafeId(t.Id),s=r.createWithScore({properties:{id:i,name:t.MasterLabel,apiVersion:t.ApiVersion,package:t.NamespacePrefix||"",createdDate:t.CreatedDate,lastModifiedDate:t.LastModifiedDate,description:t.Description,url:e.setupUrl(i,T.LIGHTNING_WEB_COMPONENT)},dependencyData:n});return[s.id,s]}));return null==i||i.log("Done"),a})}}class Vt{run(e,t,i,s){return C(this,void 0,void 0,function*(){var r,o,n,a,l,d,c,u,g,h,m,f;const E=$e.getSObjectName(s);if(void 0===E||"string"!=typeof E)throw new Error("DatasetObject: No object were provided in the parameters.");const v=E.split("__"),S=3===(null==v?void 0:v.length)?v[0]:"",I=t.getInstance(k),y=t.getInstance(H),R=t.getInstance(te),P=t.getInstance(Z),A=t.getInstance(he),C=t.getInstance(Ee),O=t.getInstance(de),L=t.getInstance(Qe),w=t.getInstance(ee),M=yield Promise.all([e.describe(E,i),e.soqlQuery([{tooling:!0,string:`SELECT Id, DurableId, DeveloperName, Description, NamespacePrefix, ExternalSharingModel, InternalSharingModel, (SELECT Id FROM ApexTriggers), (SELECT Id, MasterLabel, Description FROM FieldSets), (SELECT Id, Name, LayoutType FROM Layouts), (SELECT DurableId, Label, Max, Remaining, Type FROM Limits), (SELECT Id, Active, Description, ErrorDisplayField, ErrorMessage, ValidationName, NamespacePrefix, CreatedDate, LastModifiedDate FROM ValidationRules), (SELECT Id, Name, Url, LinkType, OpenType, Description, CreatedDate, LastModifiedDate, NamespacePrefix FROM WebLinks) FROM EntityDefinition WHERE QualifiedApiName = '${E}' `+(S?`AND NamespacePrefix = '${S}' `:"")+"LIMIT 1"},{tooling:!0,string:`SELECT DurableId, QualifiedApiName, Description, IsIndexed FROM FieldDefinition WHERE EntityDefinition.QualifiedApiName = '${E}' `+(S?`AND EntityDefinition.NamespacePrefix = '${S}' `:""),queryMoreField:"DurableId"},{string:`SELECT TableEnumOrId, Id FROM WorkflowRule WHERE TableEnumOrId = '${E}' `+(S?`AND EntityDefinition.NamespacePrefix = '${S}' `:""),tooling:!0}],i),e.recordCount(E,i)]),D=M[0],N=e.getObjectType(D.name,D.customSetting),_=M[1][0][0];if(!_)throw new TypeError(`No entity definition record found for: ${E}`);const F=M[1][1],U=M[1][2],x=M[2],G=[],B=new Map;yield b.forEach(F,t=>{var i;if(t&&t.DurableId&&t.DurableId.split&&t.DurableId.includes){const s=e.caseSafeId(t.DurableId.split(".")[1]);(null===(i=t.DurableId)||void 0===i?void 0:i.includes(".00N"))?G.push(s):B.set(t.QualifiedApiName,{id:s,description:t.Description,isIndexed:t.IsIndexed})}});const V=yield b.map(D.fields,t=>{const i=B.get(t.name);return I.createWithScore({properties:{id:i.id,name:t.label,label:t.label,description:i.description,tooltip:t.inlineHelpText,type:t.type,length:null==t?void 0:t.length,isUnique:t.unique,isEncrypted:t.encrypted,isExternalId:t.externalId,isIndexed:i.isIndexed,defaultValue:t.defaultValue,formula:t.calculatedFormula,url:e.setupUrl(i.id,T.STANDARD_FIELD,_.DurableId,N)}})},e=>B.has(e.name)),$=yield b.map(null===(r=_.ApexTriggers)||void 0===r?void 0:r.records,t=>e.caseSafeId(t.Id)),W=yield b.map(U,t=>e.caseSafeId(t.Id)),j=yield b.map(null===(o=_.FieldSets)||void 0===o?void 0:o.records,t=>y.createWithScore({properties:{id:e.caseSafeId(t.Id),label:t.MasterLabel,description:t.Description,url:e.setupUrl(t.Id,T.FIELD_SET,_.DurableId)}})),Q=yield b.map(null===(n=_.Layouts)||void 0===n?void 0:n.records,t=>R.createWithScore({properties:{id:e.caseSafeId(t.Id),name:t.Name,type:t.LayoutType,url:e.setupUrl(t.Id,T.PAGE_LAYOUT,_.DurableId)}})),q=yield b.map(null===(a=_.Limits)||void 0===a?void 0:a.records,t=>P.createWithScore({properties:{id:e.caseSafeId(t.DurableId),label:t.Label,max:t.Max,remaining:t.Remaining,used:t.Max-t.Remaining,usedPercentage:(t.Max-t.Remaining)/t.Max,type:t.Type}})),J=yield b.map(null===(l=_.ValidationRules)||void 0===l?void 0:l.records,t=>A.createWithScore({properties:{id:e.caseSafeId(t.Id),name:t.ValidationName,isActive:t.Active,description:t.Description,errorDisplayField:t.ErrorDisplayField,errorMessage:t.ErrorMessage,package:t.NamespacePrefix||"",createdDate:t.CreatedDate,lastModifiedDate:t.LastModifiedDate,url:e.setupUrl(t.Id,T.VALIDATION_RULE)}})),Y=yield b.map(null===(d=_.WebLinks)||void 0===d?void 0:d.records,t=>C.createWithScore({properties:{id:e.caseSafeId(t.Id),name:t.Name,hardCodedURLs:p.FindHardCodedURLs(t.Url),hardCodedIDs:p.FindHardCodedIDs(t.Url),type:t.LinkType,behavior:t.OpenType,package:t.NamespacePrefix||"",createdDate:t.CreatedDate,lastModifiedDate:t.LastModifiedDate,description:t.Description,url:e.setupUrl(t.Id,T.WEB_LINK,_.DurableId)}})),K=yield b.map(D.recordTypeInfos,t=>O.createWithScore({properties:{id:e.caseSafeId(t.recordTypeId),name:t.name,developerName:t.developerName,isActive:t.active,isAvailable:t.available,isDefault:t.defaultRecordTypeMapping,isMaster:t.master,url:e.setupUrl(t.recordTypeId,T.RECORD_TYPE,_.DurableId)}})),X=yield b.map(D.childRelationships,e=>L.createWithScore({properties:{name:e.relationshipName,childObject:e.childSObject,fieldName:e.field,isCascadeDelete:e.cascadeDelete,isRestrictedDelete:e.restrictedDelete}}),e=>null!==e.relationshipName),z=w.createWithScore({properties:{id:_.DurableId,label:D.label,labelPlural:D.labelPlural,isCustom:D.custom,isFeedEnabled:D.feedEnabled,isMostRecentEnabled:D.mruEnabled,isSearchable:D.searchable,keyPrefix:D.keyPrefix,name:_.DeveloperName,apiname:D.name,package:_.NamespacePrefix||"",typeId:N,description:_.Description,externalSharingModel:_.ExternalSharingModel,internalSharingModel:_.InternalSharingModel,apexTriggerIds:$,nbApexTriggers:null!==(c=null==$?void 0:$.length)&&void 0!==c?c:0,fieldSets:j,limits:q,layouts:Q,nbPageLayouts:null!==(u=null==Q?void 0:Q.length)&&void 0!==u?u:0,validationRules:J,nbValidationRules:null!==(g=null==J?void 0:J.length)&&void 0!==g?g:0,webLinks:Y,standardFields:V,customFieldIds:G,nbCustomFields:null!==(h=null==G?void 0:G.length)&&void 0!==h?h:0,recordTypes:K,nbRecordTypes:null!==(m=null==K?void 0:K.length)&&void 0!==m?m:0,relationships:X,workflowRuleIds:W,nbWorkflowRules:null!==(f=null==W?void 0:W.length)&&void 0!==f?f:0,recordCount:x,url:e.setupUrl(_.Id,N)}});return null==i||i.log("Done"),z})}}class $t{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying REST API about ObjectPermissions in the org...");const s=yield e.soqlQuery([{string:"SELECT ParentId, Parent.IsOwnedByProfile, Parent.ProfileId, SobjectType, CreatedDate, LastModifiedDate,PermissionsRead, PermissionsCreate, PermissionsEdit, PermissionsDelete, PermissionsViewAllRecords, PermissionsModifyAllRecords FROM ObjectPermissions"}],i),r=t.getInstance(je),o=s[0];null==i||i.log(`Parsing ${null==o?void 0:o.length} object permissions...`);const n=new Map(yield b.map(o,t=>{const i=r.create({properties:{parentId:e.caseSafeId(!0===t.Parent.IsOwnedByProfile?t.Parent.ProfileId:t.ParentId),objectType:t.SobjectType,isRead:t.PermissionsRead,isCreate:t.PermissionsCreate,isEdit:t.PermissionsEdit,isDelete:t.PermissionsDelete,isViewAll:t.PermissionsViewAllRecords,isModifyAll:t.PermissionsModifyAllRecords,createdDate:t.CreatedDate,lastModifiedDate:t.LastModifiedDate}});return[`${i.parentId}_${i.objectType}`,i]},e=>null!==e.Parent));return null==i||i.log("Done"),n})}}class Wt{run(e,t,i){return C(this,void 0,void 0,function*(){const s=t.getInstance(ee);null==i||i.log("Performing a global describe and in parallel a SOQL query to EntityDefinition...");const r=yield Promise.all([e.describeGlobal(i),e.soqlQuery([{string:"SELECT DurableId, NamespacePrefix, DeveloperName, QualifiedApiName, ExternalSharingModel, InternalSharingModel FROM EntityDefinition WHERE KeyPrefix <> null AND DeveloperName <> null AND (NOT(KeyPrefix IN ('00a', '017', '02c', '0D5', '1CE'))) AND (NOT(QualifiedApiName like '%_hd'))",tooling:!0,queryMoreField:"DurableId"},{string:"SELECT EntityDefinitionId, COUNT(Id) NbCustomFields FROM CustomField GROUP BY EntityDefinitionId",tooling:!0,queryMoreField:"CreatedDate"},{string:"SELECT EntityDefinitionId, COUNT(Id) NbPageLayouts FROM Layout GROUP BY EntityDefinitionId",tooling:!0,queryMoreField:"CreatedDate"},{string:"SELECT EntityDefinitionId, COUNT(Id) NbRecordTypes FROM RecordType GROUP BY EntityDefinitionId",tooling:!0,queryMoreField:"CreatedDate"},{string:"SELECT TableEnumOrId, COUNT(Id) NbWorkflowRules FROM WorkflowRule GROUP BY TableEnumOrId",tooling:!0,queryMoreField:"CreatedDate"},{string:"SELECT EntityDefinitionId, COUNT(Id) NbValidationRules FROM ValidationRule GROUP BY EntityDefinitionId",tooling:!0,queryMoreField:"CreatedDate"},{string:"SELECT EntityDefinitionId, COUNT(Id) NbTriggers FROM ApexTrigger GROUP BY EntityDefinitionId",tooling:!0,queryMoreField:"CreatedDate"}],i)]),o=r[0],n=r[1][0],a=r[1][1],l=r[1][2],d=r[1][3],c=r[1][4],u=r[1][5],p=r[1][6],g={},h=yield b.map(n,e=>(g[e.QualifiedApiName]=e,e.QualifiedApiName)),m=new Map,f=(e,t,i)=>{const s=`${e}-${t}`;!1===m.has(s)?m.set(s,i):m.set(s,m.get(s)+i)};yield Promise.all([b.forEach(a,e=>f(e.EntityDefinitionId,"cf",e.NbCustomFields)),b.forEach(l,e=>f(e.EntityDefinitionId,"pl",e.NbPageLayouts)),b.forEach(d,e=>f(e.EntityDefinitionId,"rt",e.NbRecordTypes)),b.forEach(c,e=>f(e.TableEnumOrId,"wf",e.NbWorkflowRules)),b.forEach(u,e=>f(e.EntityDefinitionId,"vr",e.NbValidationRules)),b.forEach(p,e=>f(e.EntityDefinitionId,"ap",e.NbTriggers))]),null==i||i.log(`Parsing ${null==o?void 0:o.length} objects...`);const E=new Map(yield b.map(o,t=>{var i,r,o,n,a,l;const d=e.getObjectType(t.name,t.customSetting),c=g[t.name],u=c.DurableId,p=s.createWithScore({properties:{id:t.name,label:t.label,name:c.DeveloperName,apiname:t.name,package:c.NamespacePrefix||"",typeId:d,externalSharingModel:c.ExternalSharingModel,internalSharingModel:c.InternalSharingModel,nbCustomFields:null!==(i=m.get(`${u}-cf`))&&void 0!==i?i:0,nbPageLayouts:null!==(r=m.get(`${u}-pl`))&&void 0!==r?r:0,nbRecordTypes:null!==(o=m.get(`${u}-rt`))&&void 0!==o?o:0,nbWorkflowRules:null!==(n=m.get(`${t.name}-wf`))&&void 0!==n?n:0,nbValidationRules:null!==(a=m.get(`${u}-vr`))&&void 0!==a?a:0,nbApexTriggers:null!==(l=m.get(`${u}-at`))&&void 0!==l?l:0,url:e.setupUrl(u,d)}});return[p.id,p]},e=>!!(null==h?void 0:h.includes(e.name))));return null==i||i.log("Done"),E})}}const kt=[{id:Je,label:"Standard Object"},{id:Ye,label:"Custom Object"},{id:Ke,label:"External Object"},{id:Xe,label:"Custom Setting"},{id:ze,label:"Custom Metadata Type"},{id:Ze,label:"Platform Event"},{id:et,label:"Knowledge Article"},{id:tt,label:"Big Object"}];class Ht{run(e,t,i){return C(this,void 0,void 0,function*(){const e=t.getInstance(qe);return new Map(kt.map(t=>[t.id,e.create({properties:{id:t.id,label:t.label}})]))})}}const jt="Production",Qt="Developer Edition",qt="Sandbox",Jt="Trial";class Yt{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying REST API about Organization in the org...");const s=(yield e.soqlQuery([{string:"SELECT Id, Name, IsSandbox, OrganizationType, TrialExpirationDate, NamespacePrefix FROM Organization LIMIT 1"}],i))[0];if(!s||0===(null==s?void 0:s.length))throw new Error("DatasetOrganization: No Organization record found in the org.");const r=s[0];null==i||i.log("We need to get the first result and from there the first record..."),null==i||i.log("Parsing the result...");const o=t.getInstance(it);let n;n="Developer Edition"===r.OrganizationType?Qt:!0===r.IsSandbox?qt:!1===r.IsSandbox&&r.TrialExpirationDate?Jt:jt;const a=o.create({properties:{id:e.caseSafeId(r.Id),name:r.Name,type:n,isDeveloperEdition:n===Qt,isSandbox:n===qt,isTrial:n===Jt,isProduction:n===jt,localNamespace:r.NamespacePrefix||""}});return null==i||i.log("Done"),a})}}class Kt{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying Tooling API about InstalledSubscriberPackage and REST API about Organization in the org...");const s=yield e.soqlQuery([{tooling:!0,string:"SELECT Id, SubscriberPackage.NamespacePrefix, SubscriberPackage.Name FROM InstalledSubscriberPackage "},{string:"SELECT NamespacePrefix FROM Organization LIMIT 1 "}],i),r=t.getInstance(st),o=s[0];null==i||i.log(`Parsing ${null==o?void 0:o.length} installed packages...`);const n=new Map(yield b.map(o,t=>{const i=e.caseSafeId(t.Id),s=r.create({properties:{id:i,name:t.SubscriberPackage.Name,namespace:t.SubscriberPackage.NamespacePrefix,type:"Installed"}});return[s.id,s]})),a=s[1];if(!a||0===(null==a?void 0:a.length))throw new Error("DatasetPackages: No Organization record found in the org.");const l=a[0].NamespacePrefix;return l&&(null==i||i.log(`Adding your local package ${l}...`),n.set(l,r.create({properties:{id:l,name:l,namespace:l,type:"Local"}}))),null==i||i.log("Done"),n})}}class Xt{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying Tooling API about Layout and ProfileLayout in the org...");const s=yield e.soqlQuery([{tooling:!0,string:"SELECT Id, Name, NamespacePrefix, LayoutType, EntityDefinition.DurableId, EntityDefinition.QualifiedApiName, CreatedDate, LastModifiedDate FROM Layout "},{tooling:!0,string:"SELECT LayoutId, COUNT(ProfileId) CountAssignment FROM ProfileLayout WHERE Profile.Name != null GROUP BY LayoutId ",queryMoreField:"CreatedDate"}],i),r=t.getInstance(te),o=s[0],n=s[1],a=yield b.map(o,t=>e.caseSafeId(t.Id));null==i||i.log(`Retrieving dependencies of ${null==o?void 0:o.length} page layouts...`);const l=yield e.dependenciesQuery(a,i);null==i||i.log(`Parsing ${null==o?void 0:o.length} page layouts...`);const d=new Map(yield b.map(o,t=>{var i,s;const o=e.caseSafeId(t.Id),n=r.create({properties:{id:o,name:t.Name,package:t.NamespacePrefix||"",objectId:null===(i=t.EntityDefinition)||void 0===i?void 0:i.QualifiedApiName,type:t.LayoutType,profileAssignmentCount:0,createdDate:t.CreatedDate,lastModifiedDate:t.LastModifiedDate,url:e.setupUrl(o,T.PAGE_LAYOUT,null===(s=t.EntityDefinition)||void 0===s?void 0:s.DurableId)},dependencyData:l});return[n.id,n]},e=>!!e.EntityDefinition));null==i||i.log(`Parsing ${null==n?void 0:n.length} page layout assignment counts...`),yield b.forEach(n,t=>{const i=e.caseSafeId(t.LayoutId);if(d.has(i)){d.get(i).profileAssignmentCount+=t.CountAssignment}}),null==i||i.log(`Calling Tooling API Composite to get more information about these ${null==a?void 0:a.length} page layouts...`);const c=yield e.readMetadataAtScale("Layout",a,["FIELD_INTEGRITY_EXCEPTION","UNKNOWN_EXCEPTION"],i);return null==i||i.log(`Parsing ${null==c?void 0:c.length} page layout metadata information...`),yield b.forEach(c,t=>{var i,s,r,o,n,a,l,c;const u=e.caseSafeId(t.Id);if(d.has(u)){const e=d.get(u);e.nbRelatedLists=null!==(r=null===(s=null===(i=null==t?void 0:t.Metadata)||void 0===i?void 0:i.relatedLists)||void 0===s?void 0:s.length)&&void 0!==r?r:0,e.isAttachmentRelatedListIncluded=null!==(a=null===(n=null===(o=null==t?void 0:t.Metadata)||void 0===o?void 0:o.relatedLists)||void 0===n?void 0:n.some(e=>"RelatedNoteList"===e.relatedList))&&void 0!==a&&a,e.nbFields=0,null===(c=null===(l=null==t?void 0:t.Metadata)||void 0===l?void 0:l.layoutSections)||void 0===c||c.forEach(t=>{var i;null===(i=null==t?void 0:t.layoutColumns)||void 0===i||i.forEach(t=>{var i;null===(i=null==t?void 0:t.layoutItems)||void 0===i||i.forEach(t=>{t.field&&e.nbFields++})})})}}),yield b.forEach(d,e=>{r.computeScore(e)}),null==i||i.log("Done"),d})}}class zt{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying REST API about PermissionSetLicenses in the org...");const s=yield e.soqlQuery([{string:"SELECT Id, MasterLabel, CreatedDate, LastModifiedDate, TotalLicenses, Status, ExpirationDate, UsedLicenses, IsAvailableForIntegrations FROM PermissionSetLicense "},{string:"SELECT Id, LicenseId FROM PermissionSet WHERE IsOwnedByProfile = false AND LicenseId <> NULL "},{string:"SELECT AssigneeId, PermissionSet.LicenseId FROM PermissionSetAssignment WHERE Assignee.IsActive = TRUE AND PermissionSet.LicenseId <> NULL AND PermissionSet.IsOwnedByProfile = FALSE ORDER BY PermissionSetId "}],i),r=t.getInstance(re),o=s[0],n=s[1],a=s[2];null==i||i.log(`Parsing ${null==o?void 0:o.length} permission sets licenses...`);const l=new Map(yield b.map(o,t=>{const i=e.caseSafeId(t.Id),s=r.create({properties:{id:i,name:t.MasterLabel,createdDate:t.CreatedDate,lastModifiedDate:t.LastModifiedDate,totalCount:t.TotalLicenses,usedCount:t.UsedLicenses,usedPercentage:0!==t.TotalLicenses?t.UsedLicenses/t.TotalLicenses:void 0,remainingCount:t.TotalLicenses-t.UsedLicenses,permissionSetIds:[],distinctActiveAssigneeCount:0,status:t.Status,expirationDate:t.ExpirationDate,isAvailableForIntegrations:t.IsAvailableForIntegrations,url:e.setupUrl(i,T.PERMISSION_SET_LICENSE)}});return[s.id,s]}));null==i||i.log(`Parsing ${null==a?void 0:a.length} Permission Sets with a link to a License...`);const d=new Map;return yield b.forEach(a,t=>{if(t.PermissionSet&&t.PermissionSet.LicenseId&&t.PermissionSet.LicenseId.startsWith("0PL")){const i=e.caseSafeId(t.PermissionSet.LicenseId),s=e.caseSafeId(t.AssigneeId);!1===d.has(i)&&d.set(i,new Set),d.get(i).add(s),l.get(i).distinctActiveAssigneeCount=d.get(i).size}}),null==i||i.log(`Parsing ${null==n?void 0:n.length} Permission Sets with a link to a License...`),yield b.forEach(n,t=>{const i=e.caseSafeId(t.Id),s=e.caseSafeId(t.LicenseId);l.has(s)&&l.get(s).permissionSetIds.push(i)}),null==i||i.log(`Computing the score for ${l.size} permission set licenses...`),yield b.forEach(l,e=>{r.computeScore(e)}),null==i||i.log("Done"),l})}}class Zt{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying REST API about PermissionSet, PermissionSetAssignment and PermissionSet (with a PermissionSetGroupId populated) in the org...");const s=yield e.soqlQuery([{string:"SELECT Id, Name, Description, IsCustom, License.Name, NamespacePrefix, Type, PermissionsApiEnabled, PermissionsViewSetup, PermissionsModifyAllData, PermissionsViewAllData, PermissionsManageUsers, PermissionsCustomizeApplication, CreatedDate, LastModifiedDate FROM PermissionSet WHERE IsOwnedByProfile = FALSE ORDER BY Id "},{byPasses:["INVALID_TYPE"],string:"SELECT Id, PermissionSetGroupId, PermissionSetGroup.Description FROM PermissionSet WHERE PermissionSetGroupId != null ORDER BY Id"},{string:"SELECT ParentId, COUNT(SobjectType) CountObject FROM ObjectPermissions WHERE Parent.IsOwnedByProfile = FALSE GROUP BY ParentId ",queryMoreField:"CreatedDate"},{string:"SELECT ParentId, COUNT(Field) CountField FROM FieldPermissions WHERE Parent.IsOwnedByProfile = FALSE GROUP BY ParentId ",queryMoreField:"SystemModstamp"},{string:"SELECT PermissionSetId, COUNT(Id) CountAssignment FROM PermissionSetAssignment WHERE PermissionSet.IsOwnedByProfile = FALSE AND Assignee.IsActive = TRUE GROUP BY PermissionSetId ",queryMoreField:"SystemModstamp"},{string:"SELECT PermissionSetGroupId, PermissionSetId FROM PermissionSetGroupComponent WHERE PermissionSet.IsOwnedByProfile = FALSE ORDER BY PermissionSetGroupId "}],i),r=s[0],o=s[1],n=s[2],a=s[3],l=s[4],d=s[5],c=t.getInstance(se);null==i||i.log(`Parsing ${null==r?void 0:r.length} permission sets...`);const u=new Map(yield b.map(r,t=>{const i=e.caseSafeId(t.Id),s="Group"===t.Type,r=c.create({properties:{id:i,name:t.Name,description:t.Description,license:t.License?t.License.Name:"",isCustom:t.IsCustom,package:t.NamespacePrefix||"",memberCounts:0,allIncludingGroupsAreEmpty:!1,permissionSetIds:[],permissionSetGroupIds:[],isGroup:s,type:s?"Permission Set Group":"Permission Set",createdDate:t.CreatedDate,lastModifiedDate:t.LastModifiedDate,nbFieldPermissions:0,nbObjectPermissions:0,importantPermissions:{apiEnabled:!0===t.PermissionsApiEnabled,viewSetup:!0===t.PermissionsViewSetup,modifyAllData:!0===t.PermissionsModifyAllData,viewAllData:!0===t.PermissionsViewAllData,manageUsers:!0===t.PermissionsManageUsers,customizeApplication:!0===t.PermissionsCustomizeApplication},isAdminLike:!0===t.PermissionsModifyAllData||!0===t.PermissionsViewAllData||!0===t.PermissionsManageUsers||!0===t.PermissionsCustomizeApplication,url:!1===s?e.setupUrl(i,T.PERMISSION_SET):""}});return[r.id,r]}));null==i||i.log(`Parsing ${null==o?void 0:o.length} permission set groups, ${null==n?void 0:n.length} object permissions and ${null==a?void 0:a.length} field permissions...`);const p=new Map;yield Promise.all([b.forEach(o,t=>{var i,s;const r=e.caseSafeId(t.Id),o=e.caseSafeId(t.PermissionSetGroupId);if(u.has(r)){const n=u.get(r);n.isGroup=!0,n.groupId=o,n.description=null!==(s=null===(i=t.PermissionSetGroup)||void 0===i?void 0:i.Description)&&void 0!==s?s:"",n.url=e.setupUrl(o,T.PERMISSION_SET_GROUP),p.set(o,r)}}),b.forEach(n,t=>{const i=e.caseSafeId(t.ParentId);if(u.has(i)){u.get(i).nbObjectPermissions+=t.CountObject}}),b.forEach(a,t=>{const i=e.caseSafeId(t.ParentId);if(u.has(i)){u.get(i).nbFieldPermissions+=t.CountField}}),b.forEach(l,t=>{const i=e.caseSafeId(t.PermissionSetId);if(u.has(i)){u.get(i).memberCounts+=t.CountAssignment}})]),null==i||i.log(`Checking the ${null==d?void 0:d.length} Permission Set assignments to Permission Set Groups...`);const g=new Map;return yield b.forEach(d,t=>{var i;const s=e.caseSafeId(t.PermissionSetId),r=e.caseSafeId(t.PermissionSetGroupId),o=p.get(r);if(u.has(s)&&u.has(o)){const e=u.get(s),t=u.get(o);e.permissionSetGroupIds.push(o),t.permissionSetIds.push(s),g.set(s,null!==(i=g.get(s))&&void 0!==i?i:0+t.memberCounts)}}),null==i||i.log(`Computing the score for ${u.size} permission sets...`),yield b.forEach(u,e=>{0===g.get(e.id)&&(e.allIncludingGroupsAreEmpty=!0),c.computeScore(e)}),null==i||i.log("Done"),u})}}class ei{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying Metadata API about ProfilePasswordPolicy...");const s=yield e.readMetadata([{type:"ProfilePasswordPolicy",members:["*"]}],i),r=(null==s?void 0:s.get("ProfilePasswordPolicy"))||[];if(!r)return new Map;const o=t.getInstance(oe);null==i||i.log(`Parsing ${null==r?void 0:r.length} profile password policies...`);const n=new Map(yield b.map(r,e=>{const t=o.createWithScore({properties:{lockoutInterval:parseInt(e.lockoutInterval,10),maxLoginAttempts:parseInt(e.maxLoginAttempts,10),minimumPasswordLength:parseInt(e.minimumPasswordLength,10),minimumPasswordLifetime:"true"===e.minimumPasswordLifetime,obscure:"true"===e.obscure,passwordComplexity:parseInt(e.passwordComplexity,10),passwordExpiration:parseInt(e.passwordExpiration,10),passwordHistory:parseInt(e.passwordHistory,10),passwordQuestion:"0"===e.passwordQuestion,profileName:e.profile}});return[t.profileName,t]},e=>"string"==typeof e.profile&&""!==e.profile));return null==i||i.log("Done"),n})}}const ti=e=>null==e?void 0:e.split(".").reduce((e,t,i,s)=>e+Number(t)*Math.pow(255,(null==s?void 0:s.length)-1-i),0),ii=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"];class si{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying REST API about Profile in the org...");const s=(yield e.soqlQuery([{string:"SELECT Id FROM Profile"}],i))[0];null==i||i.log(`Parsing ${null==s?void 0:s.length} Profiles...`);const r=yield b.map(s,e=>e.Id),o=t.getInstance(ne),n=t.getInstance(ae),a=t.getInstance(le);null==i||i.log(`Calling Tooling API Composite to get more information about these ${null==r?void 0:r.length} profiles...`);const l=yield e.readMetadataAtScale("Profile",r,["UNKNOWN_EXCEPTION"],i);null==i||i.log(`Parsing ${null==l?void 0:l.length} profile restrictions...`);const d=new Map(yield b.map(l,t=>C(this,void 0,void 0,function*(){var i,s;const r=e.caseSafeId(t.Id);let l,d;l=t.Metadata.loginHours?yield b.map(ii,e=>{const i=t.Metadata.loginHours[e+"Start"],s=t.Metadata.loginHours[e+"End"];return a.create({properties:{day:e,fromTime:("0"+Math.floor(i/60)).slice(-2)+":"+("0"+i%60).slice(-2),toTime:("0"+Math.floor(s/60)).slice(-2)+":"+("0"+s%60).slice(-2),difference:s-i}})}):[],d=null!==(s=null===(i=t.Metadata.loginIpRanges)||void 0===i?void 0:i.length)&&void 0!==s&&s?yield b.map(t.Metadata.loginIpRanges,e=>{const t=ti(e.startAddress),i=ti(e.endAddress);return n.create({properties:{startAddress:e.startAddress,endAddress:e.endAddress,description:e.description||"(empty)",difference:i-t+1}})}):[];const c=o.createWithScore({properties:{profileId:r,ipRanges:d,loginHours:l}});return[c.profileId,c]})));return null==i||i.log("Done"),d})}}class ri{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying REST API about PermissionSet with IsOwnedByProfile=true in the org...");const s=yield e.soqlQuery([{string:"SELECT ProfileId, Profile.Name, Profile.Description, IsCustom, License.Name, NamespacePrefix, PermissionsApiEnabled, PermissionsViewSetup, PermissionsModifyAllData, PermissionsViewAllData, PermissionsManageUsers, PermissionsCustomizeApplication, CreatedDate, LastModifiedDate FROM PermissionSet WHERE isOwnedByProfile = TRUE ORDER BY ProfileId "},{string:"SELECT Parent.ProfileId, COUNT(SobjectType) CountObject FROM ObjectPermissions WHERE Parent.IsOwnedByProfile = TRUE GROUP BY Parent.ProfileId ",queryMoreField:"CreatedDate"},{string:"SELECT Parent.ProfileId, COUNT(Field) CountField FROM FieldPermissions WHERE Parent.IsOwnedByProfile = TRUE GROUP BY Parent.ProfileId ",queryMoreField:"SystemModstamp"},{string:"SELECT PermissionSet.ProfileId, COUNT(Id) CountAssignment FROM PermissionSetAssignment WHERE PermissionSet.IsOwnedByProfile = TRUE AND Assignee.IsActive = TRUE GROUP BY PermissionSet.ProfileId ",queryMoreField:"SystemModstamp"}],i),r=s[0],o=s[1],n=s[2],a=s[3],l=t.getInstance(ie);null==i||i.log(`Parsing ${null==r?void 0:r.length} profiles...`);const d=new Map(yield b.map(r,t=>{const i=e.caseSafeId(t.ProfileId),s=l.create({properties:{id:i,name:t.Profile.Name,description:t.Profile.Description,license:t.License?t.License.Name:"",isCustom:t.IsCustom,package:t.NamespacePrefix||"",memberCounts:0,createdDate:t.CreatedDate,lastModifiedDate:t.LastModifiedDate,nbFieldPermissions:0,nbObjectPermissions:0,type:"Profile",importantPermissions:{apiEnabled:!0===t.PermissionsApiEnabled,viewSetup:!0===t.PermissionsViewSetup,modifyAllData:!0===t.PermissionsModifyAllData,viewAllData:!0===t.PermissionsViewAllData,manageUsers:!0===t.PermissionsManageUsers,customizeApplication:!0===t.PermissionsCustomizeApplication},isAdminLike:!0===t.PermissionsModifyAllData||!0===t.PermissionsViewAllData||!0===t.PermissionsManageUsers||!0===t.PermissionsCustomizeApplication,url:e.setupUrl(i,T.PROFILE)}});return[s.id,s]}));return null==i||i.log(`Parsing ${null==o?void 0:o.length} object permissions, ${null==n?void 0:n.length} field permissions and ${null==a?void 0:a.length} assignments...`),yield Promise.all([b.forEach(o,t=>{const i=e.caseSafeId(t.ProfileId);if(d.has(i)){d.get(i).nbObjectPermissions+=t.CountObject}}),b.forEach(n,t=>{const i=e.caseSafeId(t.ProfileId);if(d.has(i)){d.get(i).nbFieldPermissions+=t.CountField}}),b.forEach(a,t=>{const i=e.caseSafeId(t.ProfileId);if(d.has(i)){d.get(i).memberCounts+=t.CountAssignment}})]),null==i||i.log(`Computing the score for ${d.size} profiles...`),yield b.forEach(d,e=>{l.computeScore(e)}),null==i||i.log("Done"),d})}}class oi{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying REST API about Record Types and Profiles in the org...");const s=yield e.soqlQuery([{string:"SELECT DeveloperName, NamespacePrefix, Id, Name, SobjectType, IsActive FROM RecordType "},{string:"SELECT Id FROM Profile "}],i),r=t.getInstance(de),o=s[0],n=s[1];null==i||i.log(`Parsing ${null==o?void 0:o.length} record types...`);const a=new Map,l=new Map(yield b.map(o,t=>C(this,void 0,void 0,function*(){const i=e.caseSafeId(t.Id),s=r.create({properties:{id:e.caseSafeId(i),name:t.Name,developerName:t.DeveloperName,package:t.NamespacePrefix||"",url:e.setupUrl(i,T.RECORD_TYPE,t.SobjectType),isActive:t.IsActive,objectId:t.SobjectType,isAvailable:!1,isDefault:!1}});return a.set(`${t.SobjectType}.${t.NamespacePrefix?t.NamespacePrefix+"__":""}${t.DeveloperName}`,i),[s.id,s]})));null==i||i.log(`Extracting Ids from ${null==n?void 0:n.length} profiles...`);const d=yield b.map(n,t=>e.caseSafeId(t.Id));null==i||i.log("Get record type information from Profile Metatdata API");const c=yield e.readMetadataAtScale("Profile",d,[],i);return null==i||i.log(`Parsing ${null==c?void 0:c.length} profiles looking for record types information...`),yield b.forEach(c,e=>{var t,i;null===(i=null===(t=e.Metadata)||void 0===t?void 0:t.recordTypeVisibilities)||void 0===i||i.forEach(e=>{if(a.has(e.recordType)){const t=a.get(e.recordType);if(l.has(t)){const i=l.get(t);!1===i.isDefault&&!0===e.default&&(i.isDefault=!0),!1===i.isAvailable&&!0===e.visible&&(i.isAvailable=!0)}}})}),yield b.forEach(l,e=>{r.computeScore(e)}),null==i||i.log("Done"),l})}}class ni{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying REST API about reports in the org...");const s=yield e.soqlQuery([{string:"SELECT Id, Description, DeveloperName, FolderName, Format, Name, NamespacePrefix, CreatedDate, LastModifiedDate, LastRunDate, LastViewedDate, LastReferencedDate FROM Report "}],i),r=t.getInstance(ce),o=s[0];null==i||i.log(`Parsing ${null==o?void 0:o.length} reports...`);const n=new Map(yield b.map(o,t=>C(this,void 0,void 0,function*(){const i=e.caseSafeId(t.Id),s=r.createWithScore({properties:{id:i,name:t.Name,developerName:t.DeveloperName,description:t.Description,format:t.Format,folderName:t.FolderName,package:t.NamespacePrefix||"",createdDate:t.CreatedDate,lastModifiedDate:t.LastModifiedDate,lastRunDate:t.LastRunDate,lastViewedDate:t.LastViewedDate,lastReferencedDate:t.LastReferencedDate,url:e.setupUrl(i,T.REPORT)}});return[s.id,s]})));return null==i||i.log("Done"),n})}}class ai{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying Rest API about StaticResource in the org...");const s=yield e.soqlQuery([{string:"SELECT Id, Name, ContentType, CreatedDate, LastModifiedDate, Description, NamespacePrefix FROM StaticResource "}],i),r=t.getInstance(ue),o=s[0];null==i||i.log(`Retrieving dependencies of ${null==o?void 0:o.length} static resources...`);const n=yield e.dependenciesQuery(yield b.map(o,t=>e.caseSafeId(t.Id)),i);null==i||i.log(`Parsing ${null==o?void 0:o.length} static resources...`);const a=new Map(yield b.map(o,t=>C(this,void 0,void 0,function*(){const i=e.caseSafeId(t.Id),s=r.createWithScore({properties:{id:i,name:t.Name,description:t.Description,package:t.NamespacePrefix||"",contentType:t.ContentType,createdDate:t.CreatedDate,lastModifiedDate:t.LastModifiedDate,url:e.setupUrl(i,T.STATIC_RESOURCE)},dependencyData:n});return[s.id,s]})));return null==i||i.log("Done"),a})}}class li{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying REST API about UserRole in the org...");const s=yield e.soqlQuery([{string:"SELECT Id, DeveloperName, Name, ParentRoleId, (SELECT Id FROM Users WHERE IsActive = true AND ContactId = NULL AND Profile.Id != NULL) FROM UserRole WHERE PortalType = 'None' "}],i),r=t.getInstance(ge),o=s[0];null==i||i.log(`Parsing ${null==o?void 0:o.length} user roles...`);const n=new Map,a=[],l=new Map(yield b.map(o,t=>C(this,void 0,void 0,function*(){var i,s,o;const l=e.caseSafeId(t.Id),d=r.create({properties:{id:l,name:t.Name,apiname:t.DeveloperName,parentId:t.ParentRoleId?e.caseSafeId(t.ParentRoleId):void 0,hasParent:!!t.ParentRoleId,activeMembersCount:0,activeMemberIds:[],hasActiveMembers:!1,url:e.setupUrl(l,T.ROLE)}});return!1===d.hasParent?a.push(d):(!1===n.has(d.parentId)&&n.set(d.parentId,[]),n.get(d.parentId).push(d)),yield b.forEach(null===(i=null==t?void 0:t.Users)||void 0===i?void 0:i.records,t=>{d.activeMemberIds.push(e.caseSafeId(t.Id))}),d.activeMembersCount=null===(s=d.activeMemberIds)||void 0===s?void 0:s.length,d.hasActiveMembers=(null===(o=d.activeMemberIds)||void 0===o?void 0:o.length)>0,[d.id,d]})));return yield b.forEach(a,e=>{e.level=1,di(e,n)}),yield b.forEach(l,e=>{r.computeScore(e)}),null==i||i.log("Done"),l})}}const di=(e,t)=>{const i=t.get(e.id);null==i||i.forEach(i=>{i.level=e.level+1,di(i,t)})};class ci{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying Tooling API about Validaiton Rules in the org...");const s=yield e.soqlQuery([{string:"SELECT Id, Active, Description, ErrorDisplayField, ErrorMessage, ValidationName, EntityDefinition.QualifiedApiName, NamespacePrefix, CreatedDate, LastModifiedDate FROM ValidationRule",tooling:!0}],i),r=t.getInstance(he),o=s[0];null==i||i.log(`Parsing ${null==o?void 0:o.length} validation rules...`);const n=new Map(yield b.map(o,t=>C(this,void 0,void 0,function*(){var i;const s=e.caseSafeId(t.Id),o=r.createWithScore({properties:{id:e.caseSafeId(s),name:t.ValidationName,isActive:t.Active,package:t.NamespacePrefix||"",description:t.Description,errorDisplayField:t.ErrorDisplayField,errorMessage:t.ErrorMessage,objectId:null===(i=t.EntityDefinition)||void 0===i?void 0:i.QualifiedApiName,createdDate:t.CreatedDate,lastModifiedDate:t.LastModifiedDate,url:e.setupUrl(s,T.VALIDATION_RULE)}});return[o.id,o]})));return null==i||i.log("Done"),n})}}class ui{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying Tooling API about ApexComponent in the org...");const s=yield e.soqlQuery([{tooling:!0,string:"SELECT Id, Name, ApiVersion, NamespacePrefix, Description, Markup, CreatedDate, LastModifiedDate FROM ApexComponent WHERE ManageableState IN ('installedEditable', 'unmanaged') "}],i),r=t.getInstance(me),o=s[0];null==i||i.log(`Retrieving dependencies of ${null==o?void 0:o.length} visualforce components...`);const n=yield e.dependenciesQuery(yield b.map(o,t=>e.caseSafeId(t.Id)),i);null==i||i.log(`Parsing ${null==o?void 0:o.length} visualforce components...`);const a=new Map(yield b.map(o,t=>{const i=e.caseSafeId(t.Id),s=r.create({properties:{id:i,name:t.Name,apiVersion:t.ApiVersion,package:t.NamespacePrefix||"",createdDate:t.CreatedDate,lastModifiedDate:t.LastModifiedDate,description:t.Description,url:e.setupUrl(i,T.VISUAL_FORCE_COMPONENT)},dependencyData:n});if(t.Markup){const e=p.RemoveCommentsFromCode(t.Markup);s.hardCodedURLs=p.FindHardCodedURLs(e),s.hardCodedIDs=p.FindHardCodedIDs(e)}return r.computeScore(s),[s.id,s]}));return null==i||i.log("Done"),a})}}class pi{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying Tooling API about ApexPage in the org...");const s=yield e.soqlQuery([{tooling:!0,string:"SELECT Id, Name, ApiVersion, NamespacePrefix, Description, IsAvailableInTouch, Markup, CreatedDate, LastModifiedDate FROM ApexPage WHERE ManageableState IN ('installedEditable', 'unmanaged')"}],i),r=t.getInstance(fe),o=s[0];null==i||i.log(`Retrieving dependencies of ${null==o?void 0:o.length} visualforce pages...`);const n=yield e.dependenciesQuery(yield b.map(o,t=>e.caseSafeId(t.Id)),i);null==i||i.log(`Parsing ${null==o?void 0:o.length} visualforce pages...`);const a=new Map(yield b.map(o,t=>{const i=e.caseSafeId(t.Id),s=r.create({properties:{id:i,name:t.Name,apiVersion:t.ApiVersion,isMobileReady:t.IsAvailableInTouch,package:t.NamespacePrefix||"",createdDate:t.CreatedDate,lastModifiedDate:t.LastModifiedDate,description:t.Description,url:e.setupUrl(i,T.VISUAL_FORCE_PAGE)},dependencyData:n});if(t.Markup){const e=p.RemoveCommentsFromCode(t.Markup);s.hardCodedURLs=p.FindHardCodedURLs(e),s.hardCodedIDs=p.FindHardCodedIDs(e)}return r.computeScore(s),[s.id,s]}));return null==i||i.log("Done"),a})}}class gi{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying REST API about WebLinks in the org...");const s=yield e.soqlQuery([{string:"SELECT Id, Name, Url, LinkType, OpenType, Description, CreatedDate, LastModifiedDate, NamespacePrefix, EntityDefinition.DurableId FROM WebLink WHERE ManageableState IN ('installedEditable', 'unmanaged') ",tooling:!0}],i),r=t.getInstance(Ee),o=s[0];null==i||i.log(`Retrieving dependencies of ${null==o?void 0:o.length} web links...`);const n=yield e.dependenciesQuery(yield b.map(o,t=>e.caseSafeId(t.Id)),i);null==i||i.log(`Parsing ${null==o?void 0:o.length} weblinks...`);const a=new Map(yield b.map(o,t=>C(this,void 0,void 0,function*(){var i;const s=e.caseSafeId(t.Id),o=r.createWithScore({properties:{id:s,name:t.Name,hardCodedURLs:p.FindHardCodedURLs(t.Url),hardCodedIDs:p.FindHardCodedIDs(t.Url),type:t.LinkType,behavior:t.OpenType,package:t.NamespacePrefix||"",createdDate:t.CreatedDate,lastModifiedDate:t.LastModifiedDate,description:t.Description,objectId:null===(i=t.EntityDefinition)||void 0===i?void 0:i.DurableId,url:e.setupUrl(t.Id,T.WEB_LINK,t.PageOrSobjectType)},dependencyData:n});return[o.id,o]})));return null==i||i.log("Done"),a})}}class hi{run(e,t,i){return C(this,void 0,void 0,function*(){null==i||i.log("Querying Tooling API about WorkflowRule in the org...");const s=(yield e.soqlQuery([{string:"SELECT Id FROM WorkflowRule",tooling:!0}],i))[0];null==i||i.log(`Parsing ${null==s?void 0:s.length} Workflow Rules...`);const r=yield b.map(s,e=>e.Id),o=t.getInstance(ve);null==i||i.log(`Calling Tooling API Composite to get more information about these ${null==r?void 0:r.length} workflow rules...`);const n=yield e.readMetadataAtScale("WorkflowRule",r,["UNKNOWN_EXCEPTION"],i);null==i||i.log(`Parsing ${null==n?void 0:n.length} workflows...`);const a=new Map(yield b.map(n,t=>C(this,void 0,void 0,function*(){var i,s;const r=e.caseSafeId(t.Id),n=o.create({properties:{id:r,name:t.FullName,description:t.Metadata.description,isActive:t.Metadata.active,createdDate:t.CreatedDate,lastModifiedDate:t.LastModifiedDate,hasAction:!0,futureActions:[],emptyTimeTriggers:[],url:e.setupUrl(r,T.WORKFLOW_RULE)}}),a=t.Metadata.actions;n.actions=yield b.map(a,e=>({name:e.name,type:e.type}));const l=t.Metadata.workflowTimeTriggers;return yield b.forEach(l,e=>{var t;const i=e.offsetFromField||"TriggerDate";0===(null===(t=e.actions)||void 0===t?void 0:t.length)?n.emptyTimeTriggers.push({field:i,delay:`${e.timeLength} ${e.workflowTimeTriggerUnit}`}):e.actions.forEach(t=>{n.futureActions.push({name:t.name,type:t.type,field:i,delay:`${e.timeLength} ${e.workflowTimeTriggerUnit}`})})}),n.hasAction=(null===(i=n.actions)||void 0===i?void 0:i.length)+(null===(s=n.futureActions)||void 0===s?void 0:s.length)>0,o.computeScore(n),[n.id,n]})));return null==i||i.log("Done"),a})}}class mi{constructor(e,t,i){this._sfdcManager=e,this._logger=i,this._dataCache=t,this._datasets=new Map,this._datasetPromisesCache=new Map,this._dataFactory=new gt,this._datasets.set(A.APEXCLASSES,new mt),this._datasets.set(A.APEXTRIGGERS,new ft),this._datasets.set(A.APPLICATIONS,new Et),this._datasets.set(A.APPPERMISSIONS,new vt),this._datasets.set(A.BROWSERS,new St),this._datasets.set(A.CURRENTUSERPERMISSIONS,new yt),this._datasets.set(A.CUSTOMFIELDS,new Pt),this._datasets.set(A.CUSTOMLABELS,new At),this._datasets.set(A.CUSTOMTABS,new Tt),this._datasets.set(A.COLLABORATIONGROUPS,new It),this._datasets.set(A.DASHBOARDS,new Ct),this._datasets.set(A.DOCUMENTS,new bt),this._datasets.set(A.EMAILTEMPLATES,new Ot),this._datasets.set(A.FIELDPERMISSIONS,new Lt),this._datasets.set(A.FLOWS,new Dt),this._datasets.set(A.PUBLICGROUPSANDQUEUES,new Nt),this._datasets.set(A.HOMEPAGECOMPONENTS,new _t),this._datasets.set(A.KNOWLEDGEARTICLES,new Ut),this._datasets.set(A.LIGHTNINGAURACOMPONENTS,new xt),this._datasets.set(A.LIGHTNINGPAGES,new Gt),this._datasets.set(A.LIGHTNINGWEBCOMPONENTS,new Bt),this._datasets.set(A.OBJECT,new Vt),this._datasets.set(A.OBJECTPERMISSIONS,new $t),this._datasets.set(A.OBJECTS,new Wt),this._datasets.set(A.OBJECTTYPES,new Ht),this._datasets.set(A.ORGANIZATION,new Yt),this._datasets.set(A.PACKAGES,new Kt),this._datasets.set(A.PAGELAYOUTS,new Xt),this._datasets.set(A.PERMISSIONSETS,new Zt),this._datasets.set(A.PERMISSIONSETLICENSES,new zt),this._datasets.set(A.PROFILEPWDPOLICIES,new ei),this._datasets.set(A.PROFILERESTRICTIONS,new si),this._datasets.set(A.PROFILES,new ri),this._datasets.set(A.RECORDTYPES,new oi),this._datasets.set(A.REPORTS,new ni),this._datasets.set(A.STATICRESOURCES,new ai),this._datasets.set(A.USERROLES,new li),this._datasets.set(A.INTERNALACTIVEUSERS,new Ft),this._datasets.set(A.VALIDATIONRULES,new ci),this._datasets.set(A.VISUALFORCECOMPONENTS,new ui),this._datasets.set(A.VISUALFORCEPAGES,new pi),this._datasets.set(A.WEBLINKS,new gi),this._datasets.set(A.WORKFLOWS,new hi)}run(e){return C(this,void 0,void 0,function*(){if(e instanceof Array==!1)throw new TypeError("The given datasets is not an instance of Array.");const t=yield Promise.all(e.map(e=>{const t="string"==typeof e?e:e.alias,i="string"==typeof e?e:e.cacheKey,s="string"==typeof e?void 0:e.parameters,r=`Run dataset "${t}"`;return!1===this._datasetPromisesCache.has(i)&&this._datasetPromisesCache.set(i,new Promise((e,o)=>{this._logger.log(r,`Checking the data cache for key=${i}...`);const n=this._dataCache.get(i);n?(this._logger.ended(r,"There was data in data cache, we use it!"),e([t,n])):(this._logger.log(r,"There was no data in data cache. Let's retrieve data."),this._datasets.get(t).run(this._sfdcManager,this._dataFactory,this._logger.toSimpleLogger(r),s).then(s=>{this._dataCache.set(i,s),this._logger.ended(r,`Data retrieved and saved in cache with key=${i}`),e([t,s])}).catch(e=>{this._logger.failed(r,e),o({dataset:t,cause:e})}))})),this._datasetPromisesCache.get(i)}));return new Map(t)})}clean(e){if(e instanceof Array==!1)throw new TypeError("The given datasets is not an instance of Array.");e.forEach(e=>{const t="string"==typeof e?e:e.cacheKey;this._dataCache.remove(t),this._datasetPromisesCache.delete(t)})}}class fi{constructor(e){this._enabledFailed=!0,this._logger=e}isConsoleFallback(){var e;return null===(e=this._logger)||void 0===e?void 0:e.isConsoleFallback()}log(e,t){var i,s;(null===(i=this._logger)||void 0===i?void 0:i.isConsoleFallback())&&Ei(e,"LOG",t),null===(s=this._logger)||void 0===s||s.log(e,t)}ended(e,t){var i,s;(null===(i=this._logger)||void 0===i?void 0:i.isConsoleFallback())&&Ei(e,"ENDED",t),null===(s=this._logger)||void 0===s||s.ended(e,t)}failed(e,t){var i,s;!0===this._enabledFailed&&((null===(i=this._logger)||void 0===i?void 0:i.isConsoleFallback())&&Ei(e,"FAILED",t),null===(s=this._logger)||void 0===s||s.failed(e,t))}enableFailed(e=!0){this._enabledFailed=!0===e}toSimpleLogger(e){return{log:t=>{var i,s,r;(null===(s=null===(i=this._logger)||void 0===i?void 0:i.isConsoleFallback())||void 0===s||s)&&Ei(e,"LOG",t),null===(r=this._logger)||void 0===r||r.log(e,t)},debug:t=>{var i,s;(null===(s=null===(i=this._logger)||void 0===i?void 0:i.isConsoleFallback())||void 0===s||s)&&Ei(e,"DEBUG",t)}}}}const Ei=(e,t,i="...")=>{console.log(`${(new Date).toISOString()} - ${e} - ${t} - ${i}`)};class vi{constructor(){this.hadError=!1,this.countAll=0,this.countBad=0,this.countBadByRule=[],this.data=[]}get countGood(){return this.countAll-this.countBad}}const Si=e=>!1===e.isTest&&!1===e.needsRecompilation,Ii=e=>!0===e.isTest&&!1===e.needsRecompilation,yi=e=>!0===e.needsRecompilation,Ri="tests",Pi="uncompiled",Ai="regular";class Ti{constructor(e){switch(e){case Ri:this._filterFunction=Ii;break;case Pi:this._filterFunction=yi;break;default:this._filterFunction=Si}}extract(e){return[A.APEXCLASSES]}transform(e,t,i){return C(this,void 0,void 0,function*(){const t=e.get(A.APEXCLASSES),s=$e.getPackageName(i);if(!t)throw new Error("RecipeApexClasses: Data from dataset alias 'APEXCLASSES' was undefined.");const r=[];return yield b.forEach(t,e=>C(this,void 0,void 0,function*(){const i=yield Promise.all([b.map(e.relatedTestClassIds,e=>t.get(e)),b.map(e.relatedClassIds,e=>t.get(e))]);e.relatedTestClassRefs=i[0],e.relatedClassRefs=i[1],s!==$e.ALL_VALUES&&e.package!==s||!this._filterFunction(e)||r.push(e)})),r})}}class Ci extends Ti{constructor(){super(Ai)}}class bi extends Ti{constructor(){super(Ri)}}class Oi extends Ti{constructor(){super(Pi)}}class Li{extract(e){return[A.APEXTRIGGERS,A.OBJECTS]}transform(e,t,i){return C(this,void 0,void 0,function*(){const t=e.get(A.APEXTRIGGERS),s=e.get(A.OBJECTS),r=$e.getPackageName(i);if(!t)throw new Error("RecipeApexTriggers: Data from dataset alias 'APEXTRIGGERS' was undefined.");if(!s)throw new Error("RecipeApexTriggers: Data from dataset alias 'OBJECTS' was undefined.");const o=[];return yield b.forEach(t,e=>{e.objectRef=s.get(e.objectId),r!==$e.ALL_VALUES&&e.package!==r||o.push(e)}),o})}}class wi{extract(e){return[A.APPLICATIONS,A.APPPERMISSIONS,A.PROFILES,A.PERMISSIONSETS]}transform(e,t,i){return C(this,void 0,void 0,function*(){const t=e.get(A.APPLICATIONS),s=e.get(A.APPPERMISSIONS),r=e.get(A.PROFILES),o=e.get(A.PERMISSIONSETS),n=$e.getPackageName(i);if(!t)throw new Error("RecipeAppPermissions: Data from dataset alias 'APPLICATIONS' was undefined.");if(!s)throw new Error("RecipeAppPermissions: Data from dataset alias 'APPPERMISSIONS' was undefined.");if(!r)throw new Error("RecipeAppPermissions :Data from dataset alias 'PROFILES' was undefined.");if(!o)throw new Error("RecipeAppPermissions: Data from dataset alias 'PERMISSIONSETS' was undefined.");const a=f.create();return yield b.forEach(s,e=>{e.appRef=t.get(e.appId),!0===e.parentId.startsWith("0PS")?e.parentRef=o.get(e.parentId):e.parentRef=r.get(e.parentId),n!==$e.ALL_VALUES&&e.parentRef.package!==n&&e.appRef.package!==n||(!1===a.hasRowHeader(e.parentId)&&a.setRowHeader(e.parentId,e.parentRef),!1===a.hasColumnHeader(e.appId)&&a.setColumnHeader(e.appId,e.appRef),a.addValueToProperty(e.parentId,e.appId,(e.isAccessible?"A":"")+(e.isVisible?"V":"")))}),a.toDataMatrix()})}}class Mi{extract(e){return[A.BROWSERS]}transform(e,t){return C(this,void 0,void 0,function*(){const t=e.get(A.BROWSERS);if(!t)throw new Error("RecipeBrowsers: Data from dataset alias 'BROWSERS' was undefined.");return[...t.values()]})}}class Di{extract(e){return[A.COLLABORATIONGROUPS]}transform(e,t){return C(this,void 0,void 0,function*(){const t=e.get(A.COLLABORATIONGROUPS);if(!t)throw new Error("RecipeCollaborationGroups: Data from dataset alias 'COLLABORATIONGROUPS' was undefined.");return[...t.values()]})}}class Ni{extract(e,t){return[new P(A.CURRENTUSERPERMISSIONS,A.CURRENTUSERPERMISSIONS,t)]}transform(e,t){return C(this,void 0,void 0,function*(){const t=e.get(A.CURRENTUSERPERMISSIONS);if(!t)throw new Error("RecipeCurrentUserPermissions: Data from dataset alias 'CURRENTUSERPERMISSIONS' was undefined.");return t})}}class _i{extract(e){return[A.CUSTOMFIELDS,A.OBJECTTYPES,A.OBJECTS]}transform(e,t,i){return C(this,void 0,void 0,function*(){const s=e.get(A.OBJECTTYPES),r=e.get(A.OBJECTS),o=e.get(A.CUSTOMFIELDS),n=$e.getPackageName(i),a=$e.getSObjectTypeName(i),l=$e.getSObjectName(i);if(!s)throw new Error("RecipeCustomFields: Data from dataset alias 'OBJECTTYPES' was undefined.");if(!r)throw new Error("RecipeCustomFields: Data from dataset alias 'OBJECTS' was undefined.");if(!o)throw new Error("RecipeCustomFields: Data from dataset alias 'CUSTOMFIELDS' was undefined.");const d=[];return yield b.forEach(o,e=>{var t,i,o;const c=r.get(e.objectId);c&&!c.typeRef&&(c.typeRef=s.get(c.typeId)),e.objectRef=c,n!==$e.ALL_VALUES&&e.package!==n||a!==$e.ALL_VALUES&&(null===(i=null===(t=e.objectRef)||void 0===t?void 0:t.typeRef)||void 0===i?void 0:i.id)!==a||l!==$e.ALL_VALUES&&(null===(o=e.objectRef)||void 0===o?void 0:o.apiname)!==l||d.push(e)}),null==t||t.log("Done transforming custom fields!"),d})}}class Fi{extract(e){return[A.CUSTOMLABELS]}transform(e,t,i){return C(this,void 0,void 0,function*(){const t=e.get(A.CUSTOMLABELS),s=$e.getPackageName(i);if(!t)throw new Error("RecipeCustomLabels: Data from dataset alias 'CUSTOMLABELS' was undefined.");const r=[];return yield b.forEach(t,e=>{s!==$e.ALL_VALUES&&e.package!==s||r.push(e)}),r})}}class Ui{extract(e){return[A.CUSTOMTABS]}transform(e,t){return C(this,void 0,void 0,function*(){const t=e.get(A.CUSTOMTABS);if(!t)throw new Error("RecipeCustomTabs: Data from dataset alias 'CUSTOMTABS' was undefined.");return[...t.values()]})}}class xi{extract(e){return[A.INTERNALACTIVEUSERS,A.DASHBOARDS]}transform(e,t){return C(this,void 0,void 0,function*(){const t=e.get(A.DASHBOARDS),i=e.get(A.INTERNALACTIVEUSERS);if(!t)throw new Error("RecipeDashboards: Data from dataset alias 'DASHBOARDS' was undefined.");if(!i)throw new Error("RecipeDashboards: Data from dataset alias 'INTERNALACTIVEUSERS' was undefined.");return[...t.values()]})}}class Gi{extract(e){return[A.DOCUMENTS]}transform(e,t,i){return C(this,void 0,void 0,function*(){const t=e.get(A.DOCUMENTS),s=$e.getPackageName(i);if(!t)throw new Error("RecipeDocuments: Data from dataset alias 'DOCUMENTS' was undefined.");const r=[];return yield b.forEach(t,e=>{s!==$e.ALL_VALUES&&e.package!==s||r.push(e)}),r})}}class Bi{extract(e){return[A.EMAILTEMPLATES]}transform(e,t,i){return C(this,void 0,void 0,function*(){const t=e.get(A.EMAILTEMPLATES),s=$e.getPackageName(i);if(!t)throw new Error("RecipeDocuments: Data from dataset alias 'EMAILTEMPLATES' was undefined.");const r=[];return yield b.forEach(t,e=>{s!==$e.ALL_VALUES&&e.package!==s||r.push(e)}),r})}}class Vi{extract(e,t){return[new P(A.FIELDPERMISSIONS,`${A.FIELDPERMISSIONS}_${$e.getSObjectName(t)}`,t),A.PROFILES,A.PERMISSIONSETS]}transform(e,t,i){return C(this,void 0,void 0,function*(){const t=e.get(A.FIELDPERMISSIONS),s=e.get(A.PROFILES),r=e.get(A.PERMISSIONSETS),o=$e.getPackageName(i);if(!t)throw new Error("RecipeFieldPermissions: Data from dataset alias 'FIELDPERMISSIONS' was undefined.");if(!s)throw new Error("RecipeFieldPermissions: Data from dataset alias 'PROFILES' was undefined.");if(!r)throw new Error("RecipeFieldPermissions: Data from dataset alias 'PERMISSIONSETS' was undefined.");const n=f.create();return yield b.forEach(t,e=>{!0===e.parentId.startsWith("0PS")?e.parentRef=r.get(e.parentId):e.parentRef=s.get(e.parentId),o!==$e.ALL_VALUES&&e.parentRef.package!==o||(!1===n.hasRowHeader(e.parentId)&&n.setRowHeader(e.parentId,e.parentRef),n.addValueToProperty(e.parentId,e.fieldApiName,(e.isRead?"R":"")+(e.isEdit?"U":"")))}),n.toDataMatrix()})}}class $i{extract(e){return[A.FLOWS]}transform(e,t){return C(this,void 0,void 0,function*(){const t=e.get(A.FLOWS);if(!t)throw new Error("RecipeFlows: Data from dataset alias 'FLOWS' was undefined.");const i=[];return yield b.forEach(t,e=>{!1===e.isProcessBuilder&&i.push(e)}),i})}}class Wi{extract(e){return[O.APEX_CLASSES,O.APEX_TESTS,O.APEX_TRIGGERS,O.APEX_UNCOMPILED,O.BROWSERS,O.COLLABORATION_GROUPS,O.CUSTOM_FIELDS,O.CUSTOM_LABELS,O.CUSTOM_TABS,O.DASHBOARDS,O.DOCUMENTS,O.EMAIL_TEMPLATES,O.FLOWS,O.HOME_PAGE_COMPONENTS,O.INTERNAL_ACTIVE_USERS,O.KNOWLEDGE_ARTICLES,O.LIGHTNING_AURA_COMPONENTS,O.LIGHTNING_PAGES,O.LIGHTNING_WEB_COMPONENTS,O.OBJECTS,O.PAGE_LAYOUTS,O.PERMISSION_SETS,O.PERMISSION_SET_LICENSES,O.PROCESS_BUILDERS,O.PROFILE_PWD_POLICIES,O.PROFILE_RESTRICTIONS,O.PROFILES,O.PUBLIC_GROUPS,O.QUEUES,O.RECORD_TYPES,O.REPORTS,O.STATIC_RESOURCES,O.USER_ROLES,O.VALIDATION_RULES,O.VISUALFORCE_COMPONENTS,O.VISUALFORCE_PAGES,O.WEBLINKS,O.WORKFLOWS]}filterByScoreRuleIds(e){return null}}class ki{extract(e){return[O.APEX_CLASSES,O.APEX_TRIGGERS,O.COLLABORATION_GROUPS,O.CUSTOM_FIELDS,O.CUSTOM_TABS,O.DOCUMENTS,O.EMAIL_TEMPLATES,O.HOME_PAGE_COMPONENTS,O.VALIDATION_RULES,O.VISUALFORCE_COMPONENTS,O.VISUALFORCE_PAGES,O.WEBLINKS]}filterByScoreRuleIds(e){return Ne.GetScoreRulesForHardCodedURLs()}}class Hi{extract(e){return[A.HOMEPAGECOMPONENTS]}transform(e,t){return C(this,void 0,void 0,function*(){const t=e.get(A.HOMEPAGECOMPONENTS);if(!t)throw new Error("RecipeHomePageComponents: Data from dataset alias 'HOMEPAGECOMPONENTS' was undefined.");return[...t.values()]})}}class ji{extract(e){return[A.INTERNALACTIVEUSERS,A.PROFILES,A.PERMISSIONSETS]}transform(e,t){return C(this,void 0,void 0,function*(){const t=e.get(A.INTERNALACTIVEUSERS),i=e.get(A.PROFILES),s=e.get(A.PERMISSIONSETS);if(!t)throw new Error("RecipeActiveUsers: Data from dataset alias 'INTERNALACTIVEUSERS' was undefined.");if(!i)throw new Error("RecipeActiveUsers: Data from dataset alias 'PROFILES' was undefined.");if(!s)throw new Error("RecipeActiveUsers: Data from dataset alias 'PERMISSIONSETS' was undefined.");return yield b.forEach(t,e=>C(this,void 0,void 0,function*(){var t,r,o,n,a,l,d;e.profileRef=i.get(e.profileId),e.permissionSetRefs=yield b.map(e.permissionSetIds,e=>s.get(e),e=>s.has(e)),e.importantPermissionsGrantedBy={apiEnabled:[],viewSetup:[],modifyAllData:[],viewAllData:[],manageUsers:[],customizeApplication:[]},(null===(t=e.profileRef)||void 0===t?void 0:t.importantPermissions)&&Object.keys(e.profileRef.importantPermissions).filter(t=>!0===e.profileRef.importantPermissions[t]).forEach(t=>e.importantPermissionsGrantedBy[t].push(e.profileRef)),yield b.forEach(e.permissionSetRefs,t=>{Object.keys(t.importantPermissions).filter(e=>!0===t.importantPermissions[e]).forEach(i=>e.importantPermissionsGrantedBy[i].push(t))}),e.importantPermissions={apiEnabled:(null===(r=e.importantPermissionsGrantedBy.apiEnabled)||void 0===r?void 0:r.length)>0,viewSetup:(null===(o=e.importantPermissionsGrantedBy.viewSetup)||void 0===o?void 0:o.length)>0,modifyAllData:(null===(n=e.importantPermissionsGrantedBy.modifyAllData)||void 0===n?void 0:n.length)>0,viewAllData:(null===(a=e.importantPermissionsGrantedBy.viewAllData)||void 0===a?void 0:a.length)>0,manageUsers:(null===(l=e.importantPermissionsGrantedBy.manageUsers)||void 0===l?void 0:l.length)>0,customizeApplication:(null===(d=e.importantPermissionsGrantedBy.customizeApplication)||void 0===d?void 0:d.length)>0}})),[...t.values()]})}}class Qi{extract(e){return[A.KNOWLEDGEARTICLES]}transform(e,t){return C(this,void 0,void 0,function*(){const t=e.get(A.KNOWLEDGEARTICLES);if(!t)throw new Error("RecipeDocuments: Data from dataset alias 'KNOWLEDGEARTICLES' was undefined.");return[...t.values()]})}}class qi{extract(e){return[A.LIGHTNINGAURACOMPONENTS]}transform(e,t,i){return C(this,void 0,void 0,function*(){const t=e.get(A.LIGHTNINGAURACOMPONENTS),s=$e.getPackageName(i);if(!t)throw new Error("RecipeLightningAuraComponents: Data from dataset alias 'LIGHTNINGAURACOMPONENTS' was undefined.");const r=[];return yield b.forEach(t,e=>{s!==$e.ALL_VALUES&&e.package!==s||r.push(e)}),r})}}class Ji{extract(e){return[A.LIGHTNINGPAGES,A.OBJECTS]}transform(e,t,i){return C(this,void 0,void 0,function*(){const t=e.get(A.LIGHTNINGPAGES),s=e.get(A.OBJECTS),r=$e.getPackageName(i);if(!t)throw new Error("RecipeLightningPages: Data from dataset alias 'LIGHTNINGPAGES' was undefined.");if(!s)throw new Error("RecipeLightningPages: Data from dataset alias 'OBJECTS' was undefined.");const o=[];return yield b.forEach(t,e=>{e.objectId&&(e.objectRef=s.get(e.objectId)),r!==$e.ALL_VALUES&&e.package!==r||o.push(e)}),o})}}class Yi{extract(e){return[A.LIGHTNINGWEBCOMPONENTS]}transform(e,t,i){return C(this,void 0,void 0,function*(){const t=e.get(A.LIGHTNINGWEBCOMPONENTS),s=$e.getPackageName(i);if(!t)throw new Error("RecipeLightningWebComponents: Data from dataset alias 'LIGHTNINGWEBCOMPONENTS' was undefined.");const r=[];return yield b.forEach(t,e=>{s!==$e.ALL_VALUES&&e.package!==s||r.push(e)}),r})}}class Ki{extract(e,t){return[new P(A.OBJECT,`${A.OBJECT}_${$e.getSObjectName(t)}`,t),A.OBJECTTYPES,A.APEXTRIGGERS,A.WORKFLOWS,A.LIGHTNINGPAGES,new P(A.CUSTOMFIELDS,`${A.CUSTOMFIELDS}_${$e.getSObjectName(t)}`,t)]}transform(e,t){return C(this,void 0,void 0,function*(){const t=e.get(A.OBJECTTYPES),i=e.get(A.OBJECT),s=e.get(A.APEXTRIGGERS),r=e.get(A.WORKFLOWS),o=e.get(A.LIGHTNINGPAGES),n=e.get(A.CUSTOMFIELDS);if(!t)throw new Error("RecipeObject: Data from dataset alias 'OBJECTTYPES' was undefined.");if(!i)throw new Error("RecipeObject: Data from dataset alias 'OBJECT' was undefined.");if(!s)throw new Error("RecipeObject: Data from dataset alias 'APEXTRIGGERS' was undefined.");if(!r)throw new Error("RecipeObject: Data from dataset alias 'WORKFLOWS' was undefined.");if(!o)throw new Error("RecipeObject: Data from dataset alias 'LIGHTNINGPAGES' was undefined.");if(!n)throw new Error("RecipeObject: Data from dataset alias 'CUSTOMFIELDS' was undefined.");i.typeRef=t.get(i.typeId),i.flexiPages=[];const a=yield Promise.all([b.map(i.apexTriggerIds,e=>{const t=s.get(e);return t.objectRef=i,t},e=>s.has(e)),b.map(i.workflowRuleIds,e=>r.get(e),e=>r.has(e)),b.forEach(o,e=>{e.objectId===i.id&&i.flexiPages.push(e)}),b.map(i.customFieldIds,e=>{const t=n.get(e);return t.objectRef=i,t},e=>n.has(e))]);return i.apexTriggerRefs=a[0],i.workflowRuleRefs=a[1],i.customFieldRefs=a[3],i})}}class Xi{extract(e){return[A.OBJECTPERMISSIONS,A.PROFILES,A.PERMISSIONSETS]}transform(e,t,i){return C(this,void 0,void 0,function*(){const t=e.get(A.OBJECTPERMISSIONS),s=e.get(A.PROFILES),r=e.get(A.PERMISSIONSETS),o=$e.getPackageName(i);if(!t)throw new Error("RecipeObjectPermissions: Data from dataset alias 'OBJECTPERMISSIONS' was undefined.");if(!s)throw new Error("RecipeObjectPermissions: Data from dataset alias 'PROFILES' was undefined.");if(!r)throw new Error("RecipeObjectPermissions: Data from dataset alias 'PERMISSIONSETS' was undefined.");const n=f.create();return yield b.forEach(t,e=>{!0===e.parentId.startsWith("0PS")?e.parentRef=r.get(e.parentId):e.parentRef=s.get(e.parentId),o!==$e.ALL_VALUES&&e.parentRef.package!==o||(!1===n.hasRowHeader(e.parentId)&&n.setRowHeader(e.parentId,e.parentRef),n.addValueToProperty(e.parentId,e.objectType,(e.isCreate?"C":"")+(e.isRead?"R":"")+(e.isEdit?"U":"")+(e.isDelete?"D":"")+(e.isViewAll?"v":"")+(e.isModifyAll?"m":"")))}),n.toDataMatrix()})}}class zi{extract(e){return[A.OBJECTTYPES,A.OBJECTS]}transform(e,t,i){return C(this,void 0,void 0,function*(){const t=e.get(A.OBJECTTYPES),s=e.get(A.OBJECTS),r=$e.getPackageName(i),o=$e.getSObjectTypeName(i);if(!t)throw new Error("RecipeObjects: Data from dataset alias 'OBJECTTYPES' was undefined.");if(!s)throw new Error("RecipeObjects: Data from dataset alias 'OBJECTS' was undefined.");const n=[];return yield b.forEach(s,e=>{var i;e.typeRef=t.get(e.typeId),r!==$e.ALL_VALUES&&e.package!==r||o!==$e.ALL_VALUES&&(null===(i=e.typeRef)||void 0===i?void 0:i.id)!==o||n.push(e)}),n.sort((e,t)=>e.label<t.label?-1:1)})}}class Zi{extract(e){return[A.OBJECTTYPES]}transform(e,t){return C(this,void 0,void 0,function*(){const t=e.get(A.OBJECTTYPES);if(!t)throw new Error("RecipeObjectTypes: Data from dataset alias 'OBJECTTYPES' was undefined.");return[...t.values()]})}}class es{extract(e){return[A.ORGANIZATION]}transform(e,t){return C(this,void 0,void 0,function*(){const t=e.get(A.ORGANIZATION);if(!t)throw new Error("RecipeOrganization: Data from dataset alias 'ORGANIZATION' was undefined.");return t})}}class ts{extract(e){return[A.PACKAGES]}transform(e,t){return C(this,void 0,void 0,function*(){const t=e.get(A.PACKAGES);if(!t)throw new Error("RecipePackages: Data from dataset alias 'PACKAGES' was undefined.");return[...t.values()]})}}class is{extract(e){return[A.PAGELAYOUTS,A.OBJECTTYPES,A.OBJECTS]}transform(e,t,i){return C(this,void 0,void 0,function*(){const t=e.get(A.PAGELAYOUTS),s=e.get(A.OBJECTTYPES),r=e.get(A.OBJECTS),o=$e.getPackageName(i),n=$e.getSObjectTypeName(i),a=$e.getSObjectName(i);if(!s)throw new Error("RecipePageLayouts: Data from dataset alias 'OBJECTTYPES' was undefined.");if(!r)throw new Error("RecipePageLayouts: Data from dataset alias 'OBJECTS' was undefined.");if(!t)throw new Error("RecipePageLayouts: Data from dataset alias 'PAGELAYOUTS' was undefined.");const l=[];return yield b.forEach(t,e=>{var t,i,d;const c=r.get(e.objectId);c&&!c.typeRef&&(c.typeRef=s.get(c.typeId)),e.objectRef=c,o!==$e.ALL_VALUES&&e.package!==o||n!==$e.ALL_VALUES&&(null===(i=null===(t=e.objectRef)||void 0===t?void 0:t.typeRef)||void 0===i?void 0:i.id)!==n||a!==$e.ALL_VALUES&&(null===(d=e.objectRef)||void 0===d?void 0:d.apiname)!==a||l.push(e)}),l})}}class ss{extract(e){return[A.PERMISSIONSETLICENSES,A.PERMISSIONSETS]}transform(e,t){return C(this,void 0,void 0,function*(){const t=e.get(A.PERMISSIONSETLICENSES),i=e.get(A.PERMISSIONSETS);if(!t)throw new Error("RecipePermissionSetLicenses: Data from dataset alias 'PERMISSIONSETLICENSES' was undefined.");if(!i)throw new Error("RecipePermissionSetLicenses: Data from dataset alias 'PERMISSIONSETS' was undefined.");return yield b.forEach(t,e=>C(this,void 0,void 0,function*(){e.permissionSetRefs=yield b.map(e.permissionSetIds,e=>i.get(e),e=>i.has(e))})),[...t.values()]})}}class rs{extract(e){return[A.PERMISSIONSETS]}transform(e,t,i){return C(this,void 0,void 0,function*(){const t=e.get(A.PERMISSIONSETS),s=$e.getPackageName(i);if(!t)throw new Error("RecipePermissionSets: Data from dataset alias 'PERMISSIONSETS' was undefined.");const r=[];return yield b.forEach(t,e=>C(this,void 0,void 0,function*(){const i=yield Promise.all([b.map(e.permissionSetIds,e=>t.get(e)),b.map(e.permissionSetGroupIds,e=>t.get(e))]);e.permissionSetRefs=i[0],e.permissionSetGroupRefs=i[1],s!==$e.ALL_VALUES&&e.package!==s||r.push(e)})),r})}}class os{extract(e){return[A.FLOWS]}transform(e,t){return C(this,void 0,void 0,function*(){const t=e.get(A.FLOWS);if(!t)throw new Error("RecipeProcessBuilders: Data from dataset alias 'FLOWS' was undefined.");const i=[];return yield b.forEach(t,e=>{!0===e.isProcessBuilder&&i.push(e)}),i})}}class ns{extract(e){return[A.PROFILEPWDPOLICIES]}transform(e,t){return C(this,void 0,void 0,function*(){const t=e.get(A.PROFILEPWDPOLICIES);if(!t)throw new Error("RecipeProfilePasswordPolicies: Data from dataset alias 'PROFILEPWDPOLICIES' was undefined.");return[...t.values()]})}}class as{extract(e){return[A.PROFILES,A.PROFILERESTRICTIONS]}transform(e,t,i){return C(this,void 0,void 0,function*(){const t=e.get(A.PROFILES),s=e.get(A.PROFILERESTRICTIONS),r=$e.getPackageName(i);if(!t)throw new Error("RecipeProfileRestrictions: Data from dataset alias 'PROFILES' was undefined.");if(!s)throw new Error("RecipeProfileRestrictions: Data from dataset alias 'PROFILERESTRICTIONS' was undefined.");const o=[];return yield b.forEach(s,e=>{var i;e.profileRef=t.get(e.profileId),r!==$e.ALL_VALUES&&(null===(i=e.profileRef)||void 0===i?void 0:i.package)!==r||o.push(e)}),o})}}class ls{extract(e){return[A.PROFILES]}transform(e,t,i){return C(this,void 0,void 0,function*(){const t=e.get(A.PROFILES),s=$e.getPackageName(i);if(!t)throw new Error("RecipeProfiles: Data from dataset alias 'PROFILES' was undefined.");const r=[];return yield b.forEach(t,e=>{s!==$e.ALL_VALUES&&e.package!==s||r.push(e)}),r})}}const ds=e=>!0===e.isQueue,cs=e=>!0===e.isPublicGroup,us="queue",ps="publicgroup";class gs{constructor(e){if(e===us)this._filterFunction=ds;else this._filterFunction=cs}extract(e){return[A.INTERNALACTIVEUSERS,A.PUBLICGROUPSANDQUEUES]}transform(e,t){return C(this,void 0,void 0,function*(){const t=e.get(A.PUBLICGROUPSANDQUEUES),i=e.get(A.INTERNALACTIVEUSERS);if(!t)throw new Error("RecipePublicGroups: Data from dataset alias 'PUBLICGROUPSANDQUEUES' was undefined.");if(!i)throw new Error("RecipePublicGroups: Data from dataset alias 'INTERNALACTIVEUSERS' was undefined.");const s=[];return yield b.forEach(t,e=>C(this,void 0,void 0,function*(){e.directUserRefs=yield b.map(e.directUserIds,e=>i.get(e),e=>i.has(e)),e.directGroupRefs=yield b.map(e.directGroupIds,e=>t.get(e),e=>t.has(e)),!0===this._filterFunction(e)&&s.push(e)})),s})}}class hs extends gs{constructor(){super(us)}}class ms extends gs{constructor(){super(ps)}}class fs{extract(e){return[A.RECORDTYPES,A.OBJECTTYPES,A.OBJECTS]}transform(e,t,i){return C(this,void 0,void 0,function*(){const s=e.get(A.RECORDTYPES),r=e.get(A.OBJECTTYPES),o=e.get(A.OBJECTS),n=$e.getPackageName(i),a=$e.getSObjectTypeName(i),l=$e.getSObjectName(i);if(!s)throw new Error("RecipeRecordTypes: Data from dataset alias 'RECORDTYPES' was undefined.");if(!r)throw new Error("RecipeRecordTypes: Data from dataset alias 'OBJECTTYPES' was undefined.");if(!o)throw new Error("RecipeRecordTypes: Data from dataset alias 'OBJECTS' was undefined.");const d=[];return yield b.forEach(s,e=>{var i,s,c;const u=o.get(e.objectId);t.log(`ObjectId: ${e.objectId}`),u&&!u.typeRef&&(u.typeRef=r.get(u.typeId)),e.objectRef=u,n!==$e.ALL_VALUES&&e.package!==n||a!==$e.ALL_VALUES&&(null===(s=null===(i=e.objectRef)||void 0===i?void 0:i.typeRef)||void 0===s?void 0:s.id)!==a||l!==$e.ALL_VALUES&&(null===(c=e.objectRef)||void 0===c?void 0:c.apiname)!==l||(d.push(e),t.log(`Pushing a record type in the array: ${e}`))}),t.log(`Array has ${null==d?void 0:d.length} items.`),d})}}class Es{extract(e){return[A.INTERNALACTIVEUSERS,A.REPORTS]}transform(e,t){return C(this,void 0,void 0,function*(){const t=e.get(A.REPORTS),i=e.get(A.INTERNALACTIVEUSERS);if(!t)throw new Error("RecipeReports: Data from dataset alias 'REPORTS' was undefined.");if(!i)throw new Error("RecipeReports: Data from dataset alias 'INTERNALACTIVEUSERS' was undefined.");return[...t.values()]})}}class vs{extract(e){return[A.STATICRESOURCES]}transform(e,t,i){return C(this,void 0,void 0,function*(){const t=e.get(A.STATICRESOURCES),s=$e.getPackageName(i);if(!t)throw new Error("RecipeStaticResources: Data from dataset alias 'STATICRESOURCES' was undefined.");const r=[];return yield b.forEach(t,e=>C(this,void 0,void 0,function*(){s!==$e.ALL_VALUES&&e.package!==s||r.push(e)})),r})}}class Ss{extract(e){return[A.USERROLES,A.INTERNALACTIVEUSERS]}transform(e,t){return C(this,void 0,void 0,function*(){const t=e.get(A.USERROLES),i=e.get(A.INTERNALACTIVEUSERS);if(!t)throw new Error("RecipeUserRoles: Data from dataset alias 'USERROLES' was undefined.");if(!i)throw new Error("RecipeUserRoles: Data from dataset alias 'USERS' was undefined.");return yield b.forEach(t,e=>C(this,void 0,void 0,function*(){!0===e.hasActiveMembers&&(e.activeMemberRefs=yield b.map(e.activeMemberIds,e=>i.get(e))),!0===e.hasParent&&(e.parentRef=t.get(e.parentId))})),[...t.values()]})}}class Is{extract(e){return[A.VALIDATIONRULES,A.OBJECTTYPES,A.OBJECTS]}transform(e,t,i){return C(this,void 0,void 0,function*(){const t=e.get(A.OBJECTTYPES),s=e.get(A.OBJECTS),r=e.get(A.VALIDATIONRULES),o=$e.getPackageName(i),n=$e.getSObjectTypeName(i),a=$e.getSObjectName(i);if(!t)throw new Error("RecipeValidationRules: Data from dataset alias 'OBJECTTYPES' was undefined.");if(!s)throw new Error("RecipeValidationRules: Data from dataset alias 'OBJECTS' was undefined.");if(!r)throw new Error("RecipeValidationRules: Data from dataset alias 'VALIDATIONRULES' was undefined.");const l=[];return yield b.forEach(r,e=>{var i,r,d;const c=s.get(e.objectId);c&&!c.typeRef&&(c.typeRef=t.get(c.typeId)),e.objectRef=c,o!==$e.ALL_VALUES&&e.package!==o||n!==$e.ALL_VALUES&&(null===(r=null===(i=e.objectRef)||void 0===i?void 0:i.typeRef)||void 0===r?void 0:r.id)!==n||a!==$e.ALL_VALUES&&(null===(d=e.objectRef)||void 0===d?void 0:d.apiname)!==a||l.push(e)}),l})}}class ys{extract(e){return[A.VISUALFORCECOMPONENTS]}transform(e,t,i){return C(this,void 0,void 0,function*(){const t=e.get(A.VISUALFORCECOMPONENTS),s=$e.getPackageName(i);if(!t)throw new Error("RecipeVisualForceComponents: Data from dataset alias 'VISUALFORCECOMPONENTS' was undefined.");const r=[];return yield b.forEach(t,e=>{s!==$e.ALL_VALUES&&e.package!==s||r.push(e)}),r})}}class Rs{extract(e){return[A.VISUALFORCEPAGES]}transform(e,t,i){return C(this,void 0,void 0,function*(){const t=e.get(A.VISUALFORCEPAGES),s=$e.getPackageName(i);if(!t)throw new Error("RecipeVisualForcePages: Data from dataset alias 'VISUALFORCEPAGES' was undefined.");const r=[];return yield b.forEach(t,e=>{s!==$e.ALL_VALUES&&e.package!==s||r.push(e)}),r})}}class Ps{extract(e){return[A.OBJECTTYPES,A.OBJECTS,A.WEBLINKS]}transform(e,t,i){return C(this,void 0,void 0,function*(){const t=e.get(A.OBJECTTYPES),s=e.get(A.OBJECTS),r=e.get(A.WEBLINKS),o=$e.getPackageName(i),n=$e.getSObjectTypeName(i),a=$e.getSObjectName(i);if(!t)throw new Error("RecipeWebLinks: Data from dataset alias 'OBJECTTYPES' was undefined.");if(!s)throw new Error("RecipeWebLinks: Data from dataset alias 'OBJECTS' was undefined.");if(!r)throw new Error("RecipeWebLinks: Data from dataset alias 'WEBLINKS' was undefined.");const l=[];return yield b.forEach(r,e=>{var i,r,d;const c=s.get(e.objectId);c&&!c.typeRef&&(c.typeRef=t.get(c.typeId)),e.objectRef=c,o!==$e.ALL_VALUES&&e.package!==o||n!==$e.ALL_VALUES&&(null===(r=null===(i=e.objectRef)||void 0===i?void 0:i.typeRef)||void 0===r?void 0:r.id)!==n||a!==$e.ALL_VALUES&&(null===(d=e.objectRef)||void 0===d?void 0:d.apiname)!==a||l.push(e)}),l})}}class As{extract(e){return[A.WORKFLOWS]}transform(e,t){return C(this,void 0,void 0,function*(){const t=e.get(A.WORKFLOWS);if(!t)throw new Error("RecipeWorkflows: Data from dataset alias 'WORKFLOWS' was undefined.");return[...t.values()]})}}class Ts{constructor(e,t){this._datasetManager=e,this._logger=t,this._recipes=new Map,this._recipeCollections=new Map,this._recipes.set(O.INTERNAL_ACTIVE_USERS,new ji),this._recipes.set(O.APEX_CLASSES,new Ci),this._recipes.set(O.APEX_TESTS,new bi),this._recipes.set(O.APEX_TRIGGERS,new Li),this._recipes.set(O.APEX_UNCOMPILED,new Oi),this._recipes.set(O.APP_PERMISSIONS,new wi),this._recipes.set(O.BROWSERS,new Mi),this._recipes.set(O.COLLABORATION_GROUPS,new Di),this._recipes.set(O.CURRENT_USER_PERMISSIONS,new Ni),this._recipes.set(O.CUSTOM_FIELDS,new _i),this._recipes.set(O.CUSTOM_LABELS,new Fi),this._recipes.set(O.CUSTOM_TABS,new Ui),this._recipes.set(O.DASHBOARDS,new xi),this._recipes.set(O.DOCUMENTS,new Gi),this._recipes.set(O.EMAIL_TEMPLATES,new Bi),this._recipes.set(O.FIELD_PERMISSIONS,new Vi),this._recipes.set(O.FLOWS,new $i),this._recipes.set(O.HOME_PAGE_COMPONENTS,new Hi),this._recipes.set(O.KNOWLEDGE_ARTICLES,new Qi),this._recipes.set(O.LIGHTNING_AURA_COMPONENTS,new qi),this._recipes.set(O.LIGHTNING_PAGES,new Ji),this._recipes.set(O.LIGHTNING_WEB_COMPONENTS,new Yi),this._recipes.set(O.OBJECT,new Ki),this._recipes.set(O.OBJECT_PERMISSIONS,new Xi),this._recipes.set(O.OBJECTS,new zi),this._recipes.set(O.OBJECT_TYPES,new Zi),this._recipes.set(O.ORGANIZATION,new es),this._recipes.set(O.PACKAGES,new ts),this._recipes.set(O.PAGE_LAYOUTS,new is),this._recipes.set(O.PERMISSION_SETS,new rs),this._recipes.set(O.PERMISSION_SET_LICENSES,new ss),this._recipes.set(O.PROCESS_BUILDERS,new os),this._recipes.set(O.PROFILE_PWD_POLICIES,new ns),this._recipes.set(O.PROFILE_RESTRICTIONS,new as),this._recipes.set(O.PROFILES,new ls),this._recipes.set(O.PUBLIC_GROUPS,new ms),this._recipes.set(O.QUEUES,new hs),this._recipes.set(O.RECORD_TYPES,new fs),this._recipes.set(O.REPORTS,new Es),this._recipes.set(O.STATIC_RESOURCES,new vs),this._recipes.set(O.USER_ROLES,new Ss),this._recipes.set(O.VALIDATION_RULES,new Is),this._recipes.set(O.VISUALFORCE_COMPONENTS,new ys),this._recipes.set(O.VISUALFORCE_PAGES,new Rs),this._recipes.set(O.WEBLINKS,new Ps),this._recipes.set(O.WORKFLOWS,new As),this._recipeCollections.set(O.GLOBAL_VIEW,new Wi),this._recipeCollections.set(O.HARDCODED_URLS_VIEW,new ki)}run(e,t){return C(this,void 0,void 0,function*(){if(this._recipes.has(e))return this._runRecipe(e,t);if(this._recipeCollections.has(e))return this._runRecipeCollection(e,t);throw new TypeError(`The given alias (${e}) does not correspond to a registered recipe.`)})}clean(e,t){if(this._recipes.has(e))this._cleanRecipe(e,t);else{if(!this._recipeCollections.has(e))throw new TypeError(`The given alias (${e}) does not correspond to a registered recipe.`);this._cleanRecipeCollection(e,t)}}_runRecipe(e,t){return C(this,void 0,void 0,function*(){const i=`Run recipe "${e}"`,s=this._recipes.get(e);let r,o,n;this._logger.log(i,"How many datasets this recipe has?");try{r=s.extract(this._logger.toSimpleLogger(i),t)}catch(e){return void this._logger.failed(i,`An error occurred while extracting the datasets (message: ${e.message}).`)}this._logger.log(i,`This recipe has ${null==r?void 0:r.length} ${(null==r?void 0:r.length)>1?"datasets":"dataset"}: ${r.map(e=>e instanceof P?e.alias:e).join(", ")}...`);try{o=yield this._datasetManager.run(r)}catch(e){return void this._logger.failed(i,`An error occurred while running the dataset ${e.dataset}.`)}this._logger.log(i,"Datasets information successfuly retrieved!"),this._logger.log(i,"This recipe will now transform all this information...");try{n=yield s.transform(o,this._logger.toSimpleLogger(i),t)}catch(e){return void this._logger.failed(i,`An error occurred while transforming the data (message: ${e.message}).`)}return this._logger.ended(i,"Transformation successfuly done!"),n})}_runRecipeCollection(e,t){return C(this,void 0,void 0,function*(){const i=`Run recipe collection "${e}"`,s=this._recipeCollections.get(e);let r;this._logger.log(i,"How many recipes this recipe collection has?");try{r=s.extract(this._logger.toSimpleLogger(i),t)}catch(e){return void this._logger.failed(i,`An error occurred while extracting the recipes (message: ${e.message}).`)}this._logger.log(i,`This recipe collection has ${null==r?void 0:r.length} ${(null==r?void 0:r.length)>1?"recipes":"recipe"}: ${r.join(", ")}...`);const o=new Map,n=new Map;try{this._logger.enableFailed(!1),yield b.forEach(r,e=>C(this,void 0,void 0,function*(){try{const i=yield this._runRecipe(e,t);if(!Array.isArray(i))throw new TypeError(`The recipe "${e}" did not return an array of data as expected.`);o.set(e,i)}catch(t){n.set(e,t)}}))}catch(e){return void this._logger.failed(i,`An error occurred while running the recipes (message: ${e.message}).`)}finally{this._logger.enableFailed(!0)}this._logger.log(i,"All datasets information successfuly retrieved from recipes!"),this._logger.log(i,"This recipe collection will now transform all this information...");const a=s.filterByScoreRuleIds(this._logger.toSimpleLogger(i),t),l=(null==a?void 0:a.length)>0||!1,d=new Map;try{yield b.forEach(o,(e,t)=>{var i,s,r;const o=null===(i=null==e?void 0:e.filter(e=>{var t,i;return!!(e.score&&e.score>0)&&(!0!==l||null!==(i=null===(t=e.badReasonIds)||void 0===t?void 0:t.some(e=>a.includes(e)))&&void 0!==i&&i)}))||void 0===i?void 0:i.sort((e,t)=>e.score>t.score?-1:1),n=new Map;null==o||o.forEach(e=>{e.badReasonIds.filter(e=>!0!==l||a.includes(e)).forEach(e=>{n.set(e,n.has(e)?n.get(e)+1:1)})});const c=new vi;c.hadError=!1,c.countAll=null!==(s=null==e?void 0:e.length)&&void 0!==s?s:0,c.countBad=null!==(r=null==o?void 0:o.length)&&void 0!==r?r:0,c.countBadByRule=Array.from(n.keys()).map(e=>({ruleId:e,ruleName:Ne.GetScoreRuleDescription(e),count:n.get(e)})),c.data=o,d.set(t,c)}),n.forEach((e,t)=>{const i=new vi;i.hadError=!0,i.lastErrorMessage=(null==e?void 0:e.message)||"Unknown error",d.set(t,i)})}catch(e){return void this._logger.failed(i,`An error occurred while transforming the data (message: ${e.message}).`)}return this._logger.ended(i,"Transformation successfuly done!"),d})}_cleanRecipe(e,t){const i=`Clean recipe "${e}"`,s=this._recipes.get(e);let r;this._logger.log(i,"How many datasets this recipe has?");try{r=s.extract(this._logger.toSimpleLogger(i),t)}catch(e){return void this._logger.failed(i,`An error occurred while extracting the datasets (message: ${e.message}).`)}this._logger.log(i,`This recipe has ${null==r?void 0:r.length} ${(null==r?void 0:r.length)>1?"datasets":"dataset"}: ${r.map(e=>e instanceof P?e.alias:e).join(", ")}...`),this._logger.log(i,"Clean all datasets...");try{this._datasetManager.clean(r)}catch(e){return void this._logger.failed(i,`An error occurred while cleaning the datasets (message: ${e.message}).`)}this._logger.ended(i,"Datasets succesfully cleaned!")}_cleanRecipeCollection(e,t){const i=`Clean recipe collection "${e}"`,s=this._recipeCollections.get(e);let r;this._logger.log(i,"How many recipes this recipe collection has?");try{r=s.extract(this._logger.toSimpleLogger(i),t)}catch(e){return void this._logger.failed(i,`An error occurred while extracting the recipes (message: ${e.message}).`)}this._logger.log(i,`This recipe collection has ${null==r?void 0:r.length} ${(null==r?void 0:r.length)>1?"recipes":"recipe"}: ${r.join(", ")}...`),this._logger.log(i,"Clean all datasets of these recipes...");try{r.forEach(e=>{this._cleanRecipe(e,t)})}catch(e){return void this._logger.failed(i,`An error occurred while cleaning the datasets (message: ${e.message}).`)}this._logger.ended(i,"Datasets of these recipes succesfully cleaned!")}}const Cs=2e3;class bs{constructor(e,t){this._apiVersion=Ne.CurrentApiVersion;const i={version:this._apiVersion+".0",maxRequest:15};(null==t?void 0:t.accessToken)?i.accessToken=t.accessToken:i.oauth2={clientId:null==t?void 0:t.clientId,clientSecret:null==t?void 0:t.clientSecret,redirectUri:null==t?void 0:t.redirectUri};const s=new e.Connection(i);this._watchDog=new M(()=>{var e,t,i,r;return{used:null===(t=null===(e=s.limitInfo)||void 0===e?void 0:e.apiUsage)||void 0===t?void 0:t.used,max:null===(r=null===(i=s.limitInfo)||void 0===i?void 0:i.apiUsage)||void 0===r?void 0:r.limit}}),this._connection=s}get apiVersion(){return this._apiVersion}caseSafeId(e){return e&&18===(null==e?void 0:e.length)?e.substr(0,15):e}setupUrl(e,t,i,s){if(!e)return"";switch(t){case T.STANDARD_FIELD:case T.CUSTOM_FIELD:case T.ANY_FIELD:switch(s){case T.STANDARD_OBJECT:case T.CUSTOM_OBJECT:case T.KNOWLEDGE_ARTICLE:return"/lightning/setup/ObjectManager/"+(i?`${i}/FieldsAndRelationships/${e}/view`:`page?address=%2F${e}`);case T.CUSTOM_BIG_OBJECT:return`/lightning/setup/BigObjects/page?address=%2F${e}%3Fsetupid%3DBigObjects`;case T.CUSTOM_EVENT:return`/lightning/setup/EventObjects/page?address=%2F${e}%3Fsetupid%3DEventObjects`;case T.CUSTOM_SETTING:return`/lightning/setup/CustomSettings/page?address=%2F${e}%3Fsetupid%3DCustomSettings`;case T.CUSTOM_METADATA_TYPE:return`/lightning/setup/CustomMetadata/page?address=%2F${e}%3Fsetupid%3DCustomMetadata`;case T.EXTERNAL_OBJECT:return`/lightning/setup/ExternalObjects/page?address=%2F${e}%3Fsetupid%3DExternalObjects`;default:return`/lightning/setup/ObjectManager/page?address=%2F${e}`}case T.STANDARD_OBJECT:case T.CUSTOM_OBJECT:case T.KNOWLEDGE_ARTICLE:return`/lightning/setup/ObjectManager/${e}/Details/view`;case T.CUSTOM_BIG_OBJECT:return`/lightning/setup/BigObjects/page?address=%2F${e}%3Fsetupid%3DBigObjects`;case T.CUSTOM_EVENT:return`/lightning/setup/EventObjects/page?address=%2F${e}%3Fsetupid%3DEventObjects`;case T.CUSTOM_SETTING:return`/lightning/setup/CustomSettings/page?address=%2F${e}%3Fsetupid%3DCustomSettings`;case T.CUSTOM_METADATA_TYPE:return`/lightning/setup/CustomMetadata/page?address=%2F${e}%3Fsetupid%3DCustomMetadata`;case T.EXTERNAL_OBJECT:return`/lightning/setup/ExternalObjects/page?address=%2F${e}%3Fsetupid%3DExternalObjects`;case T.PAGE_LAYOUT:return"/lightning/setup/ObjectManager/"+(i?`${i}/PageLayouts/${e}/view`:`page?address=%2F${e}`);case T.VALIDATION_RULE:return`/lightning/setup/ObjectManager/page?address=%2F${e}`;case T.WEB_LINK:return"/lightning/setup/ObjectManager/"+(i?`${i}/ButtonsLinksActions/${e}/view`:`page?address=%2F${e}`);case T.RECORD_TYPE:return"/lightning/setup/ObjectManager/"+(i?`${i}/RecordTypes/${e}/view`:`page?address=%2F${e}`);case T.APEX_TRIGGER:return"/lightning/setup/ObjectManager/"+(i?`${i}/ApexTriggers/${e}/view`:`page?address=%2F${e}`);case T.FIELD_SET:return"/lightning/setup/ObjectManager/"+(i?`${i}/FieldSets/${e}/view`:`page?address=%2F${e}`);case T.USER:return`/lightning/setup/ManageUsers/page?address=%2F${e}%3Fnoredirect%3D1%26isUserEntityOverride%3D1`;case T.PROFILE:return`/lightning/setup/EnhancedProfiles/page?address=%2F${e}`;case T.PERMISSION_SET:return`/lightning/setup/PermSets/page?address=%2F${e}`;case T.PERMISSION_SET_LICENSE:return`/lightning/setup/PermissionSetLicense/page?address=%2F${e}`;case T.PERMISSION_SET_GROUP:return`/lightning/setup/PermSetGroups/page?address=%2F${e}`;case T.ROLE:return`/lightning/setup/Roles/page?address=%2F${e}`;case T.PUBLIC_GROUP:return`/lightning/setup/PublicGroups/page?address=%2Fsetup%2Fown%2Fgroupdetail.jsp%3Fid%3D${e}`;case T.QUEUE:return`/lightning/setup/Queues/page?address=%2Fp%2Fown%2FQueue%2Fd%3Fid%3D${e}`;case T.TECHNICAL_GROUP:return"";case T.EMAIL_TEMPLATE:return`/lightning/r/EmailTemplate/${e}/view`;case T.CUSTOM_LABEL:return`/lightning/setup/ExternalStrings/page?address=%2F${e}`;case T.STATIC_RESOURCE:return`/lightning/setup/StaticResources/page?address=%2F${e}`;case T.CUSTOM_SITE:return`/servlet/networks/switch?networkId=${e}&startURL=%2FcommunitySetup%2FcwApp.app%23%2Fc%2Fhome&`;case T.CUSTOM_TAB:return`/lightning/setup/CustomTabs/page?address=%2F${e}`;case T.FLOW_VERSION:return`/builder_platform_interaction/flowBuilder.app?flowId=${e}`;case T.FLOW_DEFINITION:return`/${e}`;case T.WORKFLOW_RULE:return`/lightning/setup/WorkflowRules/page?address=%2F${e}&nodeId=WorkflowRules`;case T.VISUAL_FORCE_PAGE:return`/lightning/setup/ApexPages/page?address=%2F${e}`;case T.VISUAL_FORCE_COMPONENT:return`/lightning/setup/ApexComponent/page?address=%2F${e}`;case T.AURA_WEB_COMPONENT:case T.LIGHTNING_WEB_COMPONENT:return`/lightning/setup/LightningComponentBundles/page?address=%2F${e}`;case T.LIGHTNING_PAGE:return"/lightning/setup/ObjectManager/"+(i?`${i}/LightningPages/${e}/view`:`page?address=%2F${e}`);case T.APEX_CLASS:return`/lightning/setup/ApexClasses/page?address=%2F${e}`;case T.KNOWLEDGE_ARTICLE_VERSION:return`/${e}`;default:return console.warn(`Type <${t}> not supported yet. Returning "/id" as url. FYI, id was <${e}>, parentId was <${i}> and parentType was <${s}>`),`/${e}`}}getObjectType(e,t){return!0===t?Xe:e.endsWith("__c")?Ye:e.endsWith("__x")?Ke:e.endsWith("__mdt")?ze:e.endsWith("__e")?Ze:e.endsWith("__ka")?et:e.endsWith("__b")?tt:Je}get dailyApiRequestLimitInformation(){return this._watchDog.dailyApiRequestLimitInformation}_standardSOQLQuery(e,t,i,s){return C(this,void 0,void 0,function*(){var r,o;const n=!0===e?this._connection.tooling:this._connection,a=[],l=e=>C(this,void 0,void 0,function*(){var i,r,o;let d;null===(i=this._watchDog)||void 0===i||i.beforeRequest(),d=void 0===e?yield n.query(t,{autoFetch:!1,headers:{"Sforce-Query-Options":"batchSize=2000"}}):yield n.queryMore(e),s((null===(r=null==d?void 0:d.records)||void 0===r?void 0:r.length)||0),null===(o=this._watchDog)||void 0===o||o.afterRequest(),a.push(...d.records),!1===d.done&&(yield l(d.nextRecordsUrl))});try{return yield l(void 0),a}catch(s){if(i&&i.includes&&i.includes(s.errorCode))return[];throw new L("There was an error while running a SOQL query with the standard queryMore",s.errorCode,{SoqlQuery:null!=t?t:"(empty)",Tooling:e,ByPasses:null!==(r=null==i?void 0:i.join(", "))&&void 0!==r?r:"(empty)",Cause:null!==(o=null==s?void 0:s.message)&&void 0!==o?o:"(empty)",Where:"SalesforceManagerImpl.soqlQuery/_standardSOQLQuery"})}})}_customSOQLQuery(e,t,i,s){return C(this,void 0,void 0,function*(){var r;const o=!0===e?this._connection.tooling:this._connection,n=[],a=t.indexOf(" FROM "),l=t.indexOf(" GROUP BY "),d=-1!==t.indexOf(" WHERE "),c=-1!==t.indexOf(" ORDER BY "),u=-1!==l;if(u&&i){if(-1!==t.toLowerCase().indexOf(i.toLowerCase(),l))throw new L(`The field <${i}> used for the custom queryMore cannot be used in the GROUP BY clause of the query <${t}>`,"CustomQueryMoreFieldInGroupBy",{SoqlQuery:null!=t?t:"(empty)",Tooling:e,Field:null!=i?i:"(empty)",Cause:"Field used in GROUP BY",Where:"SalesforceManagerImpl.soqlQuery/_customSOQLQuery"});if(c)throw new L(`The query <${t}> is using an ORDER BY statement, which is not supported when using a custom queryMore`,"CustomQueryMoreWithOrderBy",{SoqlQuery:null!=t?t:"(empty)",Tooling:e,Cause:"ORDER BY statement found",Where:"SalesforceManagerImpl.soqlQuery/_customSOQLQuery"})}const p=e=>C(this,void 0,void 0,function*(){var r,c,g,h;let m;e||!1!==u||(e="000000000000000000"),m=!1===u?`${t} ${d?"AND":"WHERE"} ${i} > '${e}' ORDER BY ${i} LIMIT 2000`:`${t.substring(0,a)}, MAX(${i}) qmField ${t.substring(a,l)} `+(e?`${d?"AND":"WHERE"} ${i} > ${e} `:"")+`${t.substring(l)} `+`ORDER BY MAX(${i}) LIMIT 2000`,null===(r=this._watchDog)||void 0===r||r.beforeRequest();const f=yield o.query(m,{autoFetch:!1,headers:{"Sforce-Query-Options":"batchSize=2000"}});if(s((null===(c=null==f?void 0:f.records)||void 0===c?void 0:c.length)||0),null===(g=this._watchDog)||void 0===g||g.afterRequest(),n.push(...f.records),(null===(h=f.records)||void 0===h?void 0:h.length)>=Cs){const e=n[(null==n?void 0:n.length)-1];!1===u?yield p(e[i]):yield p(e.qmField)}});try{return yield p(void 0),n}catch(s){throw new L("There was an error while running a SOQL query with the custom queryMore",s.errorCode,{SoqlQuery:null!=t?t:"(empty)",Tooling:e,Field:null!=i?i:"(empty)",Cause:null!==(r=null==s?void 0:s.message)&&void 0!==r?r:"(empty)",Where:"SalesforceManagerImpl.soqlQuery/_customSOQLQuery"})}})}soqlQuery(e,t){return C(this,void 0,void 0,function*(){null==t||t.log(`Preparing ${null==e?void 0:e.length} SOQL ${(null==e?void 0:e.length)>1?"queries":"query"}...`);let i=0,s=0;const r=[],o=[],n=[],a=[],l=()=>{null==t||t.log(`Processing ${null==e?void 0:e.length} SOQL ${(null==e?void 0:e.length)>1?"queries":"query"}...  Records retrieved: ${i},  Number of QueryMore calls done: ${s},  Pending: (${null==r?void 0:r.length}) on [${r.join(", ")}],  Done: (${null==o?void 0:o.length}) on [${o.join(", ")}],  Error: (${null==n?void 0:n.length}) on [${n.join(", ")}]`)},d=e=>{s++,i+=e,l()},c=yield Promise.allSettled(e.map(e=>C(this,void 0,void 0,function*(){var t;const i=e.string.lastIndexOf("FROM ")+5,s=e.string.indexOf(" ",i),c=e.string.substring(i,-1===s?null===(t=e.string)||void 0===t?void 0:t.length:s);let u;r.push(c);try{u=e.queryMoreField?yield this._customSOQLQuery(e.tooling,e.string,e.queryMoreField,d):yield this._standardSOQLQuery(e.tooling,e.string,e.byPasses,d),o.push(c)}catch(e){throw n.push(c),a.push(e),e}finally{const e=r.indexOf(c);e>-1&&r.splice(e,1),l()}return u})));if(null==t||t.log(`Done running ${null==e?void 0:e.length} SOQL ${(null==e?void 0:e.length)>1?"queries":"query"}.`),(null==a?void 0:a.length)>0)return Promise.reject(a[0]);const u=c.filter(e=>"fulfilled"===e.status).map(e=>e.value);return Promise.resolve(u)})}soslQuery(e,t){return C(this,void 0,void 0,function*(){null==t||t.log(`Preparing ${null==e?void 0:e.length} SOSL ${(null==e?void 0:e.length)>1?"queries":"query"}...`);const i=yield Promise.allSettled(e.map(e=>C(this,void 0,void 0,function*(){var t,i,s,r;let o;try{o=yield this._connection.search(e.string)}catch(o){if(e.byPasses&&e.byPasses.includes&&e.byPasses.includes(o.errorCode))return[];throw new L("There was an error while running a SOSL query",o.errorCode,{SoslQuery:null!==(t=e.string)&&void 0!==t?t:"(empty)",ByPasses:null!==(s=null===(i=e.byPasses)||void 0===i?void 0:i.join(", "))&&void 0!==s?s:"(empty)",Cause:null!==(r=null==o?void 0:o.message)&&void 0!==r?r:"(empty)",Where:"SalesforceManagerImpl.soslQuery"})}return(null==o?void 0:o.searchRecords)||[]})));null==t||t.log(`Done running ${null==e?void 0:e.length} SOSL ${(null==e?void 0:e.length)>1?"queries":"query"}.`);const s=i.filter(e=>"fulfilled"===e.status).map(e=>e.value);return Promise.resolve(s)})}dependenciesQuery(e,t){return C(this,void 0,void 0,function*(){var i,s,r,o;if(null===(i=this._watchDog)||void 0===i||i.beforeRequest(),null==t||t.log(`Starting to call Tooling API for dependency API call of ${null!==(s=null==e?void 0:e.length)&&void 0!==s?s:0} item(s)...`),0===(null!==(r=null==e?void 0:e.length)&&void 0!==r?r:0))return{records:[],errors:[]};const n=[];let a;for(let t=0;t<(null==e?void 0:e.length);t+=100){a&&5!==(null===(o=a.compositeRequest)||void 0===o?void 0:o.length)||(a={allOrNone:!1,compositeRequest:[]},n.push(a));const i=`'${e.slice(t,t+100).join("','")}'`;a.compositeRequest.push({method:"GET",url:`/services/data/v${this._apiVersion}.0/tooling/query?q=SELECT MetadataComponentId, MetadataComponentName, MetadataComponentType, RefMetadataComponentId, RefMetadataComponentName, RefMetadataComponentType FROM MetadataComponentDependency WHERE RefMetadataComponentId IN (${i}) OR MetadataComponentId IN (${i}) `,referenceId:`chunk${t}`})}let l=null==n?void 0:n.length,d=0,c=0,u=0;const p=[];for(let e=0;e<(null==n?void 0:n.length);e+=500){const i=n.slice(e,e+500);u++;const s=yield Promise.all(i.map(e=>C(this,void 0,void 0,function*(){var i;try{const t=yield this._connection.tooling.request({url:"/tooling/composite",method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}});return null===(i=this._watchDog)||void 0===i||i.afterRequest(),d++,t}catch(e){t.log(`Error here: ${e}`),c++}finally{l--,null==t||t.log(`Processing ${null==n?void 0:n.length} Tooling composite ${(null==n?void 0:n.length)>1?"queries":"query"}...  Number of batch done: ${u},  Pending: (${l}),  Done: (${d}),  Error: (${c})`)}})));p.push(...s)}null==t||t.log("Got all the results");const g=[],h=[],m=new Set;return p.filter(e=>void 0!==e).forEach(i=>{i.compositeResponse.forEach(i=>{var s,r,o;if(200===i.httpStatusCode)null==t||t.log(`This response had a code: 200 so we add the ${null===(r=null===(s=null==i?void 0:i.body)||void 0===s?void 0:s.records)||void 0===r?void 0:r.length} records`),g.push(...i.body.records.map(e=>{const t=this.caseSafeId(e.MetadataComponentId),i=this.caseSafeId(e.RefMetadataComponentId),s=`${t}-${i}`;return m.has(s)?null:(m.add(s),{id:t,name:e.MetadataComponentName,type:e.MetadataComponentType,url:this.setupUrl(t,e.MetadataComponentType),refId:i,refName:e.RefMetadataComponentName,refType:e.RefMetadataComponentType,refUrl:this.setupUrl(i,e.RefMetadataComponentType)})}).filter(e=>null!==e));else{const t=i.body[0].errorCode;if("UNKNOWN_EXCEPTION"!==t)throw new L("There was an error while calling Composite Tooling API to get dependencies. ",t,{AllIds:JSON.stringify(null!=e?e:[])||"[]",HttpStatusCode:i.httpStatusCode,HttpResponse:JSON.stringify(null!==(o=null==i?void 0:i.body)&&void 0!==o?o:{})||"N/A",Where:"SalesforceManagerImpl.dependenciesQuery"});h.push(...e)}})}),{records:g,errors:h}})}readMetadata(e,t){return C(this,void 0,void 0,function*(){var i;null===(i=this._watchDog)||void 0===i||i.beforeRequest(),null==t||t.log(`Starting to call Metadata API for ${null==e?void 0:e.length} types...`),yield Promise.all(e.filter(e=>{var t;return null===(t=e.members)||void 0===t?void 0:t.includes("*")}).map(e=>C(this,void 0,void 0,function*(){var i,s;try{const t=yield this._connection.metadata.list([{type:e.type}],this._apiVersion);null===(i=this._watchDog)||void 0===i||i.afterRequest(),e.members=e.members.filter(e=>"*"!==e),Os(t).forEach(t=>{e.members.push(t.fullName)})}catch(i){throw null==t||t.log(`The method metadata.list returned an error: ${JSON.stringify(i)}`),new L("There was an error while calling Metadata API to get a list of metadata.","METADATA_LIST",{Type:null!==(s=e.type)&&void 0!==s?s:"(empty)",ApiVersion:this._apiVersion,Cause:JSON.stringify(null!=i?i:{})||"N/A",Where:"SalesforceManagerImpl.readMetadata"})}})));const s=[],r=new Map;return e.forEach(e=>{var i,o;for(null==t||t.log(`Init the response array for this type: ${e.type}`),r.set(e.type,[]),null==t||t.log(`Starting looping for type ${e.type} and metadata.members?.length=${null===(i=e.members)||void 0===i?void 0:i.length}`);(null===(o=e.members)||void 0===o?void 0:o.length)>0;){const i=e.members.splice(0,10);s.push(new Promise((s,o)=>{null==t||t.log(`Try to call metadata read for type ${e.type} and currentMembers=${i}`),this._connection.metadata.read(e.type,i).then(t=>{var i;null===(i=this._watchDog)||void 0===i||i.afterRequest(),r.get(e.type).push(...Os(t)),s()}).catch(s=>{var r,n;null==t||t.log(`The method metadata.read returned an error: ${JSON.stringify(s)}`),o(new L("There was an error while calling Metadata API to read a list of metadata.","METADATA_READ",{Type:null!==(r=e.type)&&void 0!==r?r:"(empty)",PendingMembers:JSON.stringify(null!==(n=null==e?void 0:e.members)&&void 0!==n?n:[])||"[]",MembersInProcess:JSON.stringify(null!=i?i:[])||"[]",Cause:JSON.stringify(null!=s?s:{})||"N/A",Where:"SalesforceManagerImpl.readMetadata"}))})}))}}),null==t||t.log(`Calling all promises: ${null==s?void 0:s.length}`),yield Promise.all(s),null==t||t.log(`All promises ended and response is like: ${JSON.stringify(Array.from(r.entries()))}`),r})}readMetadataAtScale(e,t,i,s){return C(this,void 0,void 0,function*(){var r,o,n,a;if(null===(r=this._watchDog)||void 0===r||r.beforeRequest(),null==s||s.log(`Reading metadata at scale for type=${e} and ${null!==(o=null==t?void 0:t.length)&&void 0!==o?o:0} id(s).`),0===(null!==(n=null==t?void 0:t.length)&&void 0!==n?n:0))return[];const l=[];let d;t.forEach((t,i)=>{var s;d&&5!==(null===(s=d.compositeRequest)||void 0===s?void 0:s.length)||(d={allOrNone:!1,compositeRequest:[]},l.push(d)),d.compositeRequest.push({method:"GET",url:`/services/data/v${this._apiVersion}.0/tooling/sobjects/${e}/${t}`,referenceId:`chunk${i}`})});let c=null==l?void 0:l.length,u=0,p=0,g=0;const h=[];for(let e=0;e<(null==l?void 0:l.length);e+=1e3){const t=l.slice(e,e+1e3);g++;const i=yield Promise.all(t.map(e=>C(this,void 0,void 0,function*(){var t;try{const i=yield this._connection.tooling.request({url:"/tooling/composite",method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}});return null===(t=this._watchDog)||void 0===t||t.afterRequest(),u++,i}catch(e){s.log(`Error here: ${e}`),p++}finally{c--,null==s||s.log(`Processing ${null==l?void 0:l.length} Tooling composite ${(null==l?void 0:l.length)>1?"queries":"query"}...  Number of batch done: ${g},  Pending: (${c}),  Done: (${u}),  Error: (${p})`)}})));h.push(...i)}const m=[];return h.filter(e=>void 0!==e).forEach(s=>{s.compositeResponse.forEach(s=>{var r,o;if(200===s.httpStatusCode)m.push(s.body);else{const n=s.body[0].errorCode;if(i&&i.includes&&!1===i.includes(n))throw new L("There was an error while calling Composite Tooling API to get metadata at scale.",n,{Type:null!=e?e:"(empty)",AllIds:JSON.stringify(null!=t?t:[])||"[]",ByPasses:null!==(r=null==i?void 0:i.join(", "))&&void 0!==r?r:"(empty)",HttpStatusCode:s.httpStatusCode,HttpResponse:JSON.stringify(null!==(o=null==s?void 0:s.body)&&void 0!==o?o:{})||"N/A",Where:"SalesforceManagerImpl.readMetadataAtScale"})}})}),null==s||s.log(`Done reading metadata at scale for type=${e}, returning ${null!==(a=null==m?void 0:m.length)&&void 0!==a?a:0} record(s).`),m})}describeGlobal(e){return C(this,void 0,void 0,function*(){var t,i,s,r;null===(t=this._watchDog)||void 0===t||t.beforeRequest(),null==e||e.log("Describing globally all sobjects in the org.");const o=yield this._connection.describeGlobal();return o.sobjects.push(Ls),null===(i=this._watchDog)||void 0===i||i.afterRequest(),null==e||e.log(`Done describing globally the org, returning ${null!==(r=null===(s=o.sobjects)||void 0===s?void 0:s.length)&&void 0!==r?r:0} record(s).`),o.sobjects})}describe(e,t){return C(this,void 0,void 0,function*(){var i,s;if("Activity"===e)return null==t||t.log('Describing the "activity" sobject :D'),Ls;null===(i=this._watchDog)||void 0===i||i.beforeRequest(),null==t||t.log(`Describing the sobject: ${e}.`);const r=yield this._connection.describe(e);return null===(s=this._watchDog)||void 0===s||s.afterRequest(),null==t||t.log(`Done describing the sobject: ${e}.`),r})}recordCount(e,t){return C(this,void 0,void 0,function*(){var i,s,r;null===(i=this._watchDog)||void 0===i||i.beforeRequest(),null==t||t.log(`Counting the nb records for the sobject: ${e}.`);const o=yield this._connection.request({url:`/limits/recordCount?sObjects=${e}`,method:"GET"});return null===(s=this._watchDog)||void 0===s||s.afterRequest(),null==t||t.log(`Done counting for the sobject: ${e}.`),Array.isArray(null==o?void 0:o.sObjects)&&1===(null===(r=null==o?void 0:o.sObjects)||void 0===r?void 0:r.length)?null==o?void 0:o.sObjects[0].count:0})}runAllTests(e){return C(this,void 0,void 0,function*(){var t,i;null===(t=this._watchDog)||void 0===t||t.beforeRequest(),null==e||e.log("Asking to run asynchronously all tests in this org.");const s=yield this._connection.request({url:"/tooling/runTestsAsynchronous",method:"POST",body:'{ "testLevel": "RunAllTestsInOrg", "skipCodeCoverage": false }',headers:{"Content-Type":"application/json"}});return null===(i=this._watchDog)||void 0===i||i.afterRequest(),null==e||e.log("Done asking to run asynchronously all tests in this org."),s})}compileClasses(e,t){return C(this,void 0,void 0,function*(){var i,s,r;null===(i=this._watchDog)||void 0===i||i.beforeRequest(),null==t||t.log("Compiling all classes in this org.");const o=yield this.readMetadataAtScale(T.APEX_CLASS,e,[],t);null===(s=this._watchDog)||void 0===s||s.beforeRequest();const n=Date.now(),a=[];let l,d=0;o.filter(e=>e.Body).forEach(e=>{var t;l&&5!==(null===(t=l.compositeRequest)||void 0===t?void 0:t.length)||(d++,l={allOrNone:!1,compositeRequest:[{method:"POST",url:`/services/data/v${this._apiVersion}.0/tooling/sobjects/MetadataContainer`,referenceId:"container",body:{Name:`container-${n}-${d}`}},{method:"POST",url:`/services/data/v${this._apiVersion}.0/tooling/sobjects/ContainerAsyncRequest`,referenceId:"request",body:{MetadataContainerId:"@{container.id}",IsCheckOnly:!0}}]},a.push(l)),l.compositeRequest.push({method:"POST",url:`/services/data/v${this._apiVersion}.0/tooling/sobjects/ApexClassMember`,referenceId:e.Id,body:{MetadataContainerId:"@{container.id}",ContentEntityId:e.Id,Body:e.Body}})});const c=a.map(e=>C(this,void 0,void 0,function*(){var t;return null===(t=this._watchDog)||void 0===t||t.afterRequest(),this._connection.tooling.request({url:"/tooling/composite",method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})})),u=yield Promise.all(c);null===(r=this._watchDog)||void 0===r||r.afterRequest();const p=new Map;return null==u||u.forEach(e=>{var i;return null===(i=e.compositeResponse)||void 0===i?void 0:i.filter(e=>{var t;return null===(t=null==e?void 0:e.referenceId)||void 0===t?void 0:t.startsWith("01p")}).forEach(e=>{var i,s;const r=null===(i=null==e?void 0:e.referenceId)||void 0===i?void 0:i.substring(0,15);if(!0===(null===(s=null==e?void 0:e.body)||void 0===s?void 0:s.success))null==t||t.log(`Recompilation requested for classId ${r}`),p.set(r,{isSuccess:!0});else{let i;i=(null==e?void 0:e.body)&&Array.isArray(null==e?void 0:e.body)?e.body:(null==e?void 0:e.errors)&&Array.isArray(null==e?void 0:e.errors)?e.errors:["Unknown error during recompilation"],null==t||t.log(`Errors for classId ${r}: ${null==i?void 0:i.map(e=>JSON.stringify(e)).join(", ")}`),p.set(r,{isSuccess:!1,reasons:i})}})}),null==t||t.log("Done compiling all classes in this org."),p})}}const Os=e=>e?Array.isArray(e)?e:[e]:[],Ls={name:"Activity",label:"Activity",labelPlural:"Activities",customSetting:!1,custom:!1,keyPrefix:"00T"};class ws{constructor(e){this._storage=e}setItem(e,t){this._storage.setItem(e,t)}getItem(e){return this._storage.getItem(e)}removeItem(e){this._storage.removeItem(e)}keys(){var e;const t=[];for(let i=0;i<(null===(e=this._storage)||void 0===e?void 0:e.length);i++)t.push(this._storage.key(i));return t}}class Ms{constructor(){var e;if(this._api="undefined"!=typeof window?null===window||void 0===window?void 0:window.fflate:null!==(e=null===globalThis||void 0===globalThis?void 0:globalThis.fflate)&&void 0!==e?e:null,!this._api)throw new Error("fflate library not found")}compress(e){var t,i;const s=null===(t=this._api)||void 0===t?void 0:t.strToU8(e),r=null===(i=this._api)||void 0===i?void 0:i.zlibSync(s,{level:9});return _s(r)}decompress(e){var t,i;const s=Fs(e),r=null===(t=this._api)||void 0===t?void 0:t.unzlibSync(s);return null===(i=this._api)||void 0===i?void 0:i.strFromU8(r)}}const Ds=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],Ns=new Array(256);for(let e=0;e<256;e++)Ns[e]=`${Ds[e>>>4&15]}${Ds[15&e]}`;const _s=e=>{let t="";for(let i=0,s=null==e?void 0:e.length;i<s;i++)t+=Ns[e[i]];return t},Fs=e=>{const t=[];for(let i=0;i<(null==e?void 0:e.length);i+=2)t.push(parseInt(e.substring(i,i+2),16));return new Uint8Array(t)};class Us{get version(){return"Nitrogen [N,7]"}get salesforceApiVersion(){return this._sfdcManager.apiVersion}constructor(e){var t,i,s,r,o,n,a,l,d,c,u,p,g,h,m,f,E,v,S,I;if(!(null==e?void 0:e.logSettings))throw new Error("Setup is missing a logSettings property");if(this._logger=new fi(null==e?void 0:e.logSettings),!(null==e?void 0:e.salesforce))throw new Error("Setup is missing a salesforce property");if(!(null===(t=null==e?void 0:e.salesforce)||void 0===t?void 0:t.connection))throw new Error("Setup is missing a salesforce.connection property");if(!0===(null===(s=null===(i=null==e?void 0:e.salesforce)||void 0===i?void 0:i.connection)||void 0===s?void 0:s.useJsForce)){if(!(null===(r=null==e?void 0:e.salesforce)||void 0===r?void 0:r.authentication))throw new Error("Setup is missing a salesforce.authentication property");this._sfdcManager=new bs(null!==(n=null!==(o=null===window||void 0===window?void 0:window.jsforce)&&void 0!==o?o:null===globalThis||void 0===globalThis?void 0:globalThis.jsforce)&&void 0!==n?n:null,null===(a=null==e?void 0:e.salesforce)||void 0===a?void 0:a.authentication)}else{if(!(null===(d=null===(l=null==e?void 0:e.salesforce)||void 0===l?void 0:l.connection)||void 0===d?void 0:d.mockImpl))throw new Error("Setup is missing a salesforce.connection.mockImpl property");this._sfdcManager=new bs(null===(u=null===(c=null==e?void 0:e.salesforce)||void 0===c?void 0:c.connection)||void 0===u?void 0:u.mockImpl,{})}if(!(null==e?void 0:e.storage))throw new Error("Setup is missing a storage property");if(!(null===(p=null==e?void 0:e.storage)||void 0===p?void 0:p.localImpl))throw new Error("Setup is missing a storage.localImpl property");const y=new ws(null===(g=null==e?void 0:e.storage)||void 0===g?void 0:g.localImpl);if(!(null===(h=null==e?void 0:e.storage)||void 0===h?void 0:h.compression))throw new Error("Setup is missing a storage.compression property");if(!0===(null===(f=null===(m=null==e?void 0:e.storage)||void 0===m?void 0:m.compression)||void 0===f?void 0:f.useFflate))this._cacheManager=new rt(new Ms,y);else{if(!(null===(v=null===(E=null==e?void 0:e.storage)||void 0===E?void 0:E.compression)||void 0===v?void 0:v.mockImpl))throw new Error("Setup is missing a storage.compression.mockImpl property");this._cacheManager=new rt(null===(I=null===(S=null==e?void 0:e.storage)||void 0===S?void 0:S.compression)||void 0===I?void 0:I.mockImpl,y)}this._datasetManager=new mi(this._sfdcManager,this._cacheManager,this._logger),this._recipeManager=new Ts(this._datasetManager,this._logger),this._usageTermsAcceptedManually=!1}removeAllFromCache(){this._cacheManager.clear()}getCacheInformation(){return this._cacheManager.details()}getCacheData(e){return this._cacheManager.get(e)}getAllScoreRulesAsDataMatrix(){const e=f.create();return Ne.AllScoreRules.forEach(t=>{e.setRowHeader(`${t.id}`,t),t.applicable.forEach(i=>{e.addValueToProperty(`${t.id}`,i.label,"true")})}),e.toDataMatrix()}get dailyApiRequestLimitInformation(){return this._sfdcManager.dailyApiRequestLimitInformation}runAllTestsAsync(){return C(this,void 0,void 0,function*(){return this._sfdcManager.runAllTests(this._logger.toSimpleLogger("Run All Tests"))})}compileClasses(e){return C(this,void 0,void 0,function*(){return this._sfdcManager.compileClasses(e,this._logger.toSimpleLogger("Compile Classes"))})}getOrganizationInformation(){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.ORGANIZATION)})}checkUsageTerms(){return C(this,void 0,void 0,function*(){return!0!==(yield this.getOrganizationInformation()).isProduction||!1!==this._usageTermsAcceptedManually})}wereUsageTermsAcceptedManually(){return this._usageTermsAcceptedManually}acceptUsageTermsManually(){this._usageTermsAcceptedManually=!0}checkCurrentUserPermissions(){return C(this,void 0,void 0,function*(){const e=yield this._recipeManager.run(O.CURRENT_USER_PERMISSIONS,new Map([[$e.SYSTEM_PERMISSIONS_LIST,["ModifyAllData","AuthorApex","ApiEnabled","InstallPackaging"]]]));if(!1===e.get("ModifyAllData")||!1===e.get("AuthorApex")||!1===e.get("ApiEnabled")||!1===e.get("InstallPackaging"))throw new TypeError("Current User Permission Access is not enough to run the application. Please make sure to assign ALL the following permissions to the current user: Modify All Data, Author Apex, API Enabled and Download AppExchange Packages.");return!0})}getPackages(){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.PACKAGES)})}removeAllPackagesFromCache(){this._recipeManager.clean(O.PACKAGES)}getPageLayouts(e,t,i){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.PAGE_LAYOUTS,new Map([[$e.SOBJECT_NAME,i],[$e.PACKAGE_NAME,e],[$e.SOBJECT_TYPE_NAME,t]]))})}removeAllPageLayoutsFromCache(){this._recipeManager.clean(O.PAGE_LAYOUTS)}getObjectTypes(){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.OBJECT_TYPES)})}getObjects(e,t){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.OBJECTS,new Map([[$e.PACKAGE_NAME,e],[$e.SOBJECT_TYPE_NAME,t]]))})}removeAllObjectsFromCache(){this._recipeManager.clean(O.OBJECTS)}getObject(e){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.OBJECT,new Map([[$e.SOBJECT_NAME,e]]))})}removeObjectFromCache(e){this._recipeManager.clean(O.OBJECT,new Map([[$e.SOBJECT_NAME,e]]))}getObjectPermissionsPerParent(e){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.OBJECT_PERMISSIONS,new Map([[$e.PACKAGE_NAME,e]]))})}removeAllObjectPermissionsFromCache(){this._recipeManager.clean(O.OBJECT_PERMISSIONS)}getApplicationPermissionsPerParent(e){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.APP_PERMISSIONS,new Map([[$e.PACKAGE_NAME,e]]))})}removeAllAppPermissionsFromCache(){this._recipeManager.clean(O.APP_PERMISSIONS)}getKnowledgeArticles(){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.KNOWLEDGE_ARTICLES)})}removeAllKnowledgeArticlesFromCache(){this._recipeManager.clean(O.KNOWLEDGE_ARTICLES)}getChatterGroups(){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.COLLABORATION_GROUPS)})}removeAllChatterGroupsFromCache(){this._recipeManager.clean(O.COLLABORATION_GROUPS)}getCustomFields(e,t,i){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.CUSTOM_FIELDS,new Map([[$e.PACKAGE_NAME,e],[$e.SOBJECT_TYPE_NAME,t],[$e.SOBJECT_NAME,i]]))})}removeAllCustomFieldsFromCache(){this._recipeManager.clean(O.CUSTOM_FIELDS)}getPermissionSets(e){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.PERMISSION_SETS,new Map([[$e.PACKAGE_NAME,e]]))})}removeAllPermSetsFromCache(){this._recipeManager.clean(O.PERMISSION_SETS)}getPermissionSetLicenses(){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.PERMISSION_SET_LICENSES)})}removeAllPermSetLicensesFromCache(){this._recipeManager.clean(O.PERMISSION_SET_LICENSES)}getProfiles(e){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.PROFILES,new Map([[$e.PACKAGE_NAME,e]]))})}removeAllProfilesFromCache(){this._recipeManager.clean(O.PROFILES)}getProfileRestrictions(e){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.PROFILE_RESTRICTIONS,new Map([[$e.PACKAGE_NAME,e]]))})}removeAllProfileRestrictionsFromCache(){this._recipeManager.clean(O.PROFILE_RESTRICTIONS)}getProfilePasswordPolicies(){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.PROFILE_PWD_POLICIES)})}removeAllProfilePasswordPoliciesFromCache(){this._recipeManager.clean(O.PROFILE_PWD_POLICIES)}getActiveUsers(){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.INTERNAL_ACTIVE_USERS)})}removeAllActiveUsersFromCache(){this._recipeManager.clean(O.INTERNAL_ACTIVE_USERS)}getBrowsers(){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.BROWSERS)})}removeAllBrowsersFromCache(){this._recipeManager.clean(O.BROWSERS)}getCustomLabels(e){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.CUSTOM_LABELS,new Map([[$e.PACKAGE_NAME,e]]))})}removeAllCustomLabelsFromCache(){this._recipeManager.clean(O.CUSTOM_LABELS)}getCustomTabs(e){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.CUSTOM_TABS,new Map([[$e.PACKAGE_NAME,e]]))})}removeAllCustomTabsFromCache(){this._recipeManager.clean(O.CUSTOM_TABS)}getDocuments(e){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.DOCUMENTS,new Map([[$e.PACKAGE_NAME,e]]))})}removeAllDocumentsFromCache(){this._recipeManager.clean(O.DOCUMENTS)}getLightningWebComponents(e){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.LIGHTNING_WEB_COMPONENTS,new Map([[$e.PACKAGE_NAME,e]]))})}removeAllLightningWebComponentsFromCache(){this._recipeManager.clean(O.LIGHTNING_WEB_COMPONENTS)}getLightningAuraComponents(e){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.LIGHTNING_AURA_COMPONENTS,new Map([[$e.PACKAGE_NAME,e]]))})}removeAllLightningAuraComponentsFromCache(){this._recipeManager.clean(O.LIGHTNING_AURA_COMPONENTS)}getLightningPages(e){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.LIGHTNING_PAGES,new Map([[$e.PACKAGE_NAME,e]]))})}removeAllLightningPagesFromCache(){this._recipeManager.clean(O.LIGHTNING_PAGES)}getVisualForceComponents(e){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.VISUALFORCE_COMPONENTS,new Map([[$e.PACKAGE_NAME,e]]))})}removeAllVisualForceComponentsFromCache(){this._recipeManager.clean(O.VISUALFORCE_COMPONENTS)}getVisualForcePages(e){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.VISUALFORCE_PAGES,new Map([[$e.PACKAGE_NAME,e]]))})}removeAllVisualForcePagesFromCache(){this._recipeManager.clean(O.VISUALFORCE_PAGES)}getPublicGroups(){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.PUBLIC_GROUPS)})}removeAllPublicGroupsFromCache(){this._recipeManager.clean(O.PUBLIC_GROUPS)}getQueues(){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.QUEUES)})}removeAllQueuesFromCache(){this._recipeManager.clean(O.QUEUES)}getApexClasses(e){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.APEX_CLASSES,new Map([[$e.PACKAGE_NAME,e]]))})}removeAllApexClassesFromCache(){this._recipeManager.clean(O.APEX_CLASSES)}getApexTests(e){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.APEX_TESTS,new Map([[$e.PACKAGE_NAME,e]]))})}removeAllApexTestsFromCache(){this._recipeManager.clean(O.APEX_TESTS)}getApexUncompiled(e){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.APEX_UNCOMPILED,new Map([[$e.PACKAGE_NAME,e]]))})}removeAllApexUncompiledFromCache(){this._recipeManager.clean(O.APEX_UNCOMPILED)}getApexTriggers(e){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.APEX_TRIGGERS,new Map([[$e.PACKAGE_NAME,e]]))})}removeAllApexTriggersFromCache(){this._recipeManager.clean(O.APEX_TRIGGERS)}getRoles(){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.USER_ROLES)})}removeAllRolesFromCache(){this._recipeManager.clean(O.USER_ROLES)}getRolesTree(){return C(this,void 0,void 0,function*(){const e=yield this.getRoles(),t=new Map,i="__i am root__";return null==e||e.forEach(e=>{!1===t.has(e.id)&&t.set(e.id,{id:e.id});const s=t.get(e.id);s.record||(s.record=e);const r=!0===e.hasParent?e.parentId:i;!1===t.has(r)&&t.set(r,{id:r});const o=t.get(r);o.children||(o.children=[]),o.children.push(s)}),t.get(i)})}getStaticResources(e){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.STATIC_RESOURCES,new Map([[$e.PACKAGE_NAME,e]]))})}removeAllStaticResourcesFromCache(){this._recipeManager.clean(O.STATIC_RESOURCES)}getWeblinks(e,t,i){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.WEBLINKS,new Map([[$e.SOBJECT_NAME,i],[$e.PACKAGE_NAME,e],[$e.SOBJECT_TYPE_NAME,t]]))})}removeAllWeblinksFromCache(){this._recipeManager.clean(O.WEBLINKS)}getWorkflows(){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.WORKFLOWS)})}removeAllWorkflowsFromCache(){this._recipeManager.clean(O.WORKFLOWS)}getRecordTypes(e,t,i){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.RECORD_TYPES,new Map([[$e.SOBJECT_NAME,i],[$e.PACKAGE_NAME,e],[$e.SOBJECT_TYPE_NAME,t]]))})}removeAllRecordTypesFromCache(){this._recipeManager.clean(O.RECORD_TYPES)}getFieldPermissionsPerParent(e,t){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.FIELD_PERMISSIONS,new Map([[$e.SOBJECT_NAME,e],[$e.PACKAGE_NAME,t]]))})}removeAllFieldPermissionsFromCache(){this._recipeManager.clean(O.FIELD_PERMISSIONS)}getFlows(){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.FLOWS)})}removeAllFlowsFromCache(){this._recipeManager.clean(O.FLOWS)}getEmailTemplates(e){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.EMAIL_TEMPLATES,new Map([[$e.PACKAGE_NAME,e]]))})}removeAllEmailTemplatesFromCache(){this._recipeManager.clean(O.EMAIL_TEMPLATES)}getHomePageComponents(){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.HOME_PAGE_COMPONENTS)})}removeAllHomePageComponentsFromCache(){this._recipeManager.clean(O.HOME_PAGE_COMPONENTS)}getProcessBuilders(){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.PROCESS_BUILDERS)})}removeAllProcessBuildersFromCache(){this._recipeManager.clean(O.PROCESS_BUILDERS)}getValidationRules(e,t,i){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.VALIDATION_RULES,new Map([[$e.SOBJECT_NAME,i],[$e.PACKAGE_NAME,e],[$e.SOBJECT_TYPE_NAME,t]]))})}removeAllValidationRulesFromCache(){this._recipeManager.clean(O.VALIDATION_RULES)}getDashboards(){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.DASHBOARDS)})}removeAllDashboardsFromCache(){this._recipeManager.clean(O.DASHBOARDS)}getReports(){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.REPORTS)})}removeAllReportsFromCache(){this._recipeManager.clean(O.REPORTS)}getGlobalView(){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.GLOBAL_VIEW)})}removeGlobalViewFromCache(){this._recipeManager.clean(O.GLOBAL_VIEW)}getHardcodedURLsView(){return C(this,void 0,void 0,function*(){return yield this._recipeManager.run(O.HARDCODED_URLS_VIEW)})}removeHardcodedURLsFromCache(){this._recipeManager.clean(O.HARDCODED_URLS_VIEW)}}export{Us as API,p as CodeScanner,S as Data,m as DataDependencies,g as DataDependenciesFactory,h as DataDependency,v as DataMatrix,f as DataMatrixFactory,A as DatasetAliases,P as DatasetRunInformation,e as ItemInCache,$e as OrgCheckGlobalParameter,b as Processor,O as RecipeAliases,_ as SFDC_ApexClass,N as SFDC_ApexTestMethodResult,F as SFDC_ApexTrigger,ke as SFDC_AppPermission,We as SFDC_Application,U as SFDC_Browser,x as SFDC_CollaborationGroup,G as SFDC_CustomLabel,B as SFDC_CustomTab,V as SFDC_Dashboard,$ as SFDC_Document,W as SFDC_EmailTemplate,k as SFDC_Field,He as SFDC_FieldPermission,H as SFDC_FieldSet,j as SFDC_Flow,q as SFDC_Group,J as SFDC_HomePageComponent,Y as SFDC_KnowledgeArticle,K as SFDC_LightningAuraComponent,X as SFDC_LightningPage,z as SFDC_LightningWebComponent,Z as SFDC_Limit,ee as SFDC_Object,je as SFDC_ObjectPermission,Qe as SFDC_ObjectRelationShip,qe as SFDC_ObjectType,it as SFDC_Organization,st as SFDC_Package,te as SFDC_PageLayout,se as SFDC_PermissionSet,re as SFDC_PermissionSetLicense,ie as SFDC_Profile,oe as SFDC_ProfilePasswordPolicy,ne as SFDC_ProfileRestrictions,de as SFDC_RecordType,ce as SFDC_Report,ue as SFDC_StaticResource,pe as SFDC_User,ge as SFDC_UserRole,he as SFDC_ValidationRule,me as SFDC_VisualForceComponent,fe as SFDC_VisualForcePage,Ee as SFDC_WebLink,ve as SFDC_Workflow,T as SalesforceMetadataTypes,M as SalesforceWatchDog,R as ScoreRule,Ne as SecretSauce};
