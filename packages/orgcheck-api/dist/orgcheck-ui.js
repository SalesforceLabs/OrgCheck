const e="... (truncated)";class l{static exportAsXls(l){var a;const o="undefined"!=typeof window?null===window||void 0===window?void 0:window.XLSX:null!==(a=null===globalThis||void 0===globalThis?void 0:globalThis.XLSX)&&void 0!==a?a:null;if(!o)throw new Error("XLSX not available, skipping XLS export");const t=o.utils.book_new();(Array.isArray(l)?l:[l]).forEach(l=>{const a=[l.columns].concat(l.rows.map((a,o)=>a.map((a,t)=>{if("string"!=typeof a)throw new Error(`Invalid cell type at row ${o+1}, column ${l.columns[t]} (${t+1}) of table "${l.header}": expected string but got ${typeof a}`);return a.length>32767?a.substring(0,32752)+e:a}))),s=o.utils.aoa_to_sheet(a);s["!cols"]=l.columns.map((e,l)=>{const o=a.reduce((e,a)=>{var o;return a&&"string"==typeof a[l]?Math.max(e,null===(o=a[l])||void 0===o?void 0:o.length):e},10);return o?{wch:o}:{}});const i=`${l.header} (${l.rows.length})`.substring(0,31);o.utils.book_append_sheet(t,s,i)});const s=o.write(t,{bookType:"xlsx",type:"binary"}),i=new ArrayBuffer(s.length),n=new Uint8Array(i);for(let e=0;e<s.length;e++)n[e]=255&s.charCodeAt(e);return i}}const a={HORIZONTAL:"horizontal",VERTICAL:"vertical"},o={IDX:"index",SCR:"score",TXT:"text",TXTS:"texts",NUM:"numeric",PRC:"percentage",URL:"id",URLS:"ids",CHK:"boolean",DTM:"datetime",DEP:"dependencies",OBJS:"objects"};class t{}class s extends t{}class i extends t{}class n{static create(e,l){var a,t,s,i,n,u;const v={data:{}},c=null!==(a=e.modifier)&&void 0!==a?a:void 0,p=null!==(t=e.data)&&void 0!==t?t:{};switch(e.type){case o.TXTS:v.data.values=null===(s=d(l,p.values))||void 0===s?void 0:s.map(e=>r({data:e},c));break;case o.OBJS:{const e=null!==(i=p.template)&&void 0!==i?i:()=>"";v.data.values=null===(n=d(l,p.values))||void 0===n?void 0:n.map(l=>r({data:e(l)},c));break}case o.URLS:v.data.values=null===(u=d(l,p.values))||void 0===u?void 0:u.map(e=>{const l={data:{}};return Object.keys(p).filter(e=>"values"!==e).forEach(a=>{l.data[a]=d(e,p[a])}),r(l,c)});break;default:Object.keys(p).forEach(e=>{v.data[e]=d(l,p[e])}),r(v,c)}return v[`typeof${e.type}`]=!0,v}}const d=(e,l)=>{let a=e;return l.split(".").forEach(e=>{a&&(a=a[e])}),a},r=(e,l)=>{if(l){const a="value"in e.data?e.data.value:e.data;void 0!==l.maximumLength&&a&&"string"==typeof a&&a.length>l.maximumLength&&(e.decoration=a.substring(0,l.maximumLength)),void 0!==l.valueIfEmpty&&(null==a||"string"==typeof a&&0===a.trim().length||Array.isArray(a)&&0===a.length)&&(e.decoration=l.valueIfEmpty),!0===l.preformatted&&(e.isPreformatted=!0),void 0!==l.minimum&&void 0!==l.valueBeforeMin&&void 0!==a&&"number"==typeof a&&a<l.minimum&&(e.decoration=l.valueBeforeMin),void 0!==l.maximum&&void 0!==l.valueAfterMax&&void 0!==a&&"number"==typeof a&&a>l.maximum&&(e.decoration=l.valueAfterMax)}return e};class u{}class v{}class c{}class p extends c{}class m{}class f{}class h{}class b{}class y{}class x{}class g{}class w{}const $={DESC:"desc",ASC:"asc"};class S{}class E{}class L{}class A{static create(e,l,a,o){return l.map((l,t)=>{var s;const i={index:t+1,score:l.score,name:null!==(s=l.name)&&void 0!==s?s:l.label,badFields:l.badFields,badReasonIds:l.badReasonIds,cells:e.columns.map((e,a)=>{const s=n.create(e,l);return o(s,!(!e.data||!l.badFields)&&(l.badFields.includes(e.data.value)||l.badFields.includes(e.data.values)),t,a),s}),isVisible:!0};return a&&a(i,l.score>0,t),i})}static sort(e,l,a,t){const s=e.columns[a];if(!s)return;const i=t===$.ASC?1:-1,n=s.type==o.OBJS||s.type==o.TXTS||s.type==o.URLS,d=s.type==o.URL?"label":"value";let r,u,v=0;l.sort((e,l)=>{var o,t,s,v;return!0===n?(r=(null===(t=null===(o=e.cells[a].data)||void 0===o?void 0:o.values)||void 0===t?void 0:t.length)||0,u=(null===(v=null===(s=l.cells[a].data)||void 0===s?void 0:s.values)||void 0===v?void 0:v.length)||0):(r=e.cells[a].data[d],u=l.cells[a].data[d]),r&&r.toUpperCase&&(r=r.toUpperCase()),u&&u.toUpperCase&&(u=u.toUpperCase()),r||0===r?u||0===u?r<u?-i:i:-i:i}).forEach(e=>{!0===e.isVisible&&(e.index=++v)})}static filter(e,l){if((null==l?void 0:l.length)>2){const a=l.toUpperCase();let o=0;e.forEach(e=>{!0===R(e.cells,a)?(e.isVisible=!0,e.index=++o):e.isVisible=!1})}else e.forEach((e,l)=>{e.isVisible=!0,e.index=l+1})}static export(e,l,a,t){const s={header:a,columns:[],rows:[]};return e.columns.forEach(e=>{switch(e.type){case o.SCR:s.columns.push(e.label,"Reasons");break;case o.URL:case o.URLS:s.columns.push(`${e.label} (label)`,`${e.label} (URL)`);break;case o.DEP:s.columns.push("List of used","List of referenced");break;default:s.columns.push(e.label)}}),l.forEach(e=>{var l;const a=[];null===(l=e.cells)||void 0===l||l.forEach(l=>{var o,s,i,n,d,r,u,v,c,p,m,f,h,b,y,x,g;!0===(null==l?void 0:l.typeofindex)?a.push(`${null==e?void 0:e.index}`):!0===(null==l?void 0:l.typeofscore)?a.push(`${null==e?void 0:e.score}`,U(null===(o=null==e?void 0:e.badReasonIds)||void 0===o?void 0:o.map(e=>t(e)))):!0===(null==l?void 0:l.typeofid)?a.push(`${null===(s=null==l?void 0:l.data)||void 0===s?void 0:s.label}`,`${null===(i=l.data)||void 0===i?void 0:i.value}`):!0===(null==l?void 0:l.typeofids)?a.push(U(null===(d=null===(n=l.data)||void 0===n?void 0:n.values)||void 0===d?void 0:d.map(e=>{var l;return`${null===(l=e.data)||void 0===l?void 0:l.label}`})),U(null===(u=null===(r=l.data)||void 0===r?void 0:r.values)||void 0===u?void 0:u.map(e=>{var l;return`${null===(l=e.data)||void 0===l?void 0:l.value}`}))):!0===(null==l?void 0:l.typeofdependencies)?a.push(U(null===(p=null===(c=null===(v=l.data)||void 0===v?void 0:v.value)||void 0===c?void 0:c.using)||void 0===p?void 0:p.map(e=>`${null==e?void 0:e.name} (${null==e?void 0:e.type} - ${null==e?void 0:e.id})`)),U(null===(h=null===(f=null===(m=l.data)||void 0===m?void 0:m.value)||void 0===f?void 0:f.referenced)||void 0===h?void 0:h.map(e=>`${null==e?void 0:e.name} (${null==e?void 0:e.type} - ${null==e?void 0:e.id})`))):!0===(null==l?void 0:l.typeofobjects)||!0===(null==l?void 0:l.typeoftexts)?a.push(U(null===(y=null===(b=null==l?void 0:l.data)||void 0===b?void 0:b.values)||void 0===y?void 0:y.map(e=>`${e.data}`))):a.push(`${null!==(g=null===(x=null==l?void 0:l.data)||void 0===x?void 0:x.value)&&void 0!==g?g:""}`)}),s.rows.push(a)}),s}static createAndExport(e,l,a,o){const t=()=>{},s=A.create(e,l,t,t);return A.export(e,s,a,o)}}const R=(e,l)=>e.findIndex(e=>Object.values(e.data).findIndex(e=>{return Array.isArray(e)?R(e,l):(a=l,String(e).toUpperCase().indexOf(a)>=0);var a})>=0)>=0,U=e=>e?JSON.stringify(e):"";export{n as CellFactory,o as ColumnType,y as EmptyModifier,E as ExportedTable,l as Exporter,g as NumericMaximumModifier,w as NumericMinMaxModifier,x as NumericMinimumModifier,a as Orientation,b as PreformattedModifier,L as Row,A as RowsFactory,$ as SortOrder,S as Table,t as TableColumn,s as TableColumnWithModifiers,i as TableColumnWithOrientation,h as TextTruncatedModifier,u as WhereToGetData,c as WhereToGetLinkData,p as WhereToGetLinksData,m as WhereToGetObjectsData,v as WhereToGetScoreData,f as WhereToGetTextsData};
