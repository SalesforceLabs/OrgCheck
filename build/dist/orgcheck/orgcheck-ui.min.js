"use strict";class e{value;label}const a={IDX:"index",SCR:"score",TXT:"text",TXTS:"texts",NUM:"numeric",PRC:"percentage",URL:"id",URLS:"ids",CHK:"boolean",DTM:"datetime",DEP:"dependencies",OBJS:"objects"};class t{label;type}class s{static create(e,t){const s={data:{}},l=e.modifier??void 0,i=e.data??{};switch(e.type){case a.TXTS:s.data.values=r(t,i.values)?.map((e=>o({data:e},l)));break;case a.OBJS:{const e=i.template??(()=>"");s.data.values=r(t,i.values)?.map((a=>o({data:e(a)},l)));break}case a.URLS:s.data.values=r(t,i.values)?.map((e=>{const a={data:{}};return Object.keys(i).filter((e=>"values"!==e)).forEach((t=>{a.data[t]=r(e,i[t])})),o(a,l)}));break;default:Object.keys(i).forEach((e=>{s.data[e]=r(t,i[e])})),o(s,l)}return s[`typeof${e.type}`]=!0,s}}const r=(e,a)=>{let t=e;return a.split(".").forEach((e=>{t&&(t=t[e])})),t},o=(e,a)=>{if(a){const t="value"in e.data?e.data.value:e.data;void 0!==a.maximumLength&&t&&"string"==typeof t&&t.length>a.maximumLength&&(e.decoration=t.substring(0,a.maximumLength)),void 0!==a.valueIfEmpty&&(null==t||"string"==typeof t&&0===t.trim().length||Array.isArray(t)&&0===t.length)&&(e.decoration=a.valueIfEmpty),!0===a.preformatted&&(e.isPreformatted=!0),void 0!==a.minimum&&void 0!==a.valueBeforeMin&&void 0!==t&&"number"==typeof t&&t<a.minimum&&(e.decoration=a.valueBeforeMin),void 0!==a.maximum&&void 0!==a.valueAfterMax&&void 0!==t&&"number"==typeof t&&t>a.maximum&&(e.decoration=a.valueAfterMax)}return e},l={DESC:"desc",ASC:"asc"};class i{static create(e,a,t,r){return a.map(((a,o)=>{const l={index:o+1,score:a.score,name:a.name??a.label,badFields:a.badFields,badReasonIds:a.badReasonIds,cells:e.columns.map(((e,t)=>{const l=s.create(e,a);return r(l,!(!e.data||!a.badFields)&&(a.badFields.includes(e.data.value)||a.badFields.includes(e.data.values)),o,t),l})),isVisible:!0};return t&&t(l,a.score>0,o),l}))}static sort(e,t,s,r){const o=r===l.ASC?1:-1,i=e.columns[s].type,n=i==a.OBJS||i==a.TXTS||i==a.URLS,d=i==a.URL?"label":"value";let c,u,m=0;return t.sort(((e,a)=>(!0===n?(c=e.cells[s].data?.values?.length||0,u=a.cells[s].data?.values?.length||0):(c=e.cells[s].data[d],u=a.cells[s].data[d]),c&&c.toUpperCase&&(c=c.toUpperCase()),u&&u.toUpperCase&&(u=u.toUpperCase()),c||0===c?u||0===u?c<u?-o:o:-o:o))).forEach((e=>{!0===e.isVisible&&(e.index=++m)}))}static filter(e,a){if(a?.length>2){const t=a.toUpperCase();let s=0;e.forEach((e=>{!0===n(e.cells,t)?(e.isVisible=!0,e.index=++s):e.isVisible=!1}))}else e.forEach(((e,a)=>{e.isVisible=!0,e.index=a+1}))}static export(e,t,s,r){const o={header:s,columns:[],rows:[]},l={header:`⚠️ ${s}`,columns:["(#) Item","(Id) Reason"],rows:[]};return e.columns.forEach((e=>{switch(e.type){case a.SCR:o.columns.push(e.label,"Reasons");break;case a.URL:case a.URLS:o.columns.push(`${e.label} (label)`,`${e.label} (URL)`);break;default:o.columns.push(e.label)}})),t.forEach((e=>{e.badReasonIds?.forEach((a=>{l.rows.push([`(${e.index}) ${e.name}`,`(${a}) ${r(a)}`])}));const a=[];e.cells?.forEach((t=>{!0===t.typeofindex?a.push(e.index):!0===t.typeofscore?a.push(e.score,d(e.badReasonIds?.map((e=>e)))):!0===t.typeofid?a.push(t.data.label,t.data.value):!0===t.typeofids?a.push(d(t.data.values?.map((e=>e.data.label))),d(t.data.values?.map((e=>e.data.value)))):!0===t.typeofobjects||!0===t.typeofobjects?a.push(d(t.data.values?.map((e=>e.data)))):a.push(t.data.value??"")})),o.rows.push(a)})),0===l.rows.length?[o]:[o,l]}static createAndExport(e,a,t,s){const r=()=>{},o=i.create(e,a,r,r);return i.export(e,o,t,s)}}const n=(e,a)=>e.findIndex((e=>Object.values(e.data).findIndex((e=>{return Array.isArray(e)?n(e,a):(t=a,String(e).toUpperCase().indexOf(t)>=0);var t}))>=0))>=0,d=e=>JSON.stringify(e);exports.CellFactory=s,exports.ColumnType=a,exports.EmptyModifier=class{valueIfEmpty},exports.ExportedTable=class{header;columns;rows},exports.NumericMaximumModifier=class{maximum;valueAfterMax},exports.NumericMinMaxModifier=class{minimum;valueBeforeMin;maximum;valueAfterMax},exports.NumericMinimumModifier=class{minimum;valueBeforeMin;valueIfEmpty},exports.Orientation={HORIZONTAL:"horizontal",VERTICAL:"vertical"},exports.PreformattedModifier=class{preformatted;maximumLength},exports.Row=class{index;name;score;badFields;badReasonIds;cells;isVisible},exports.RowsFactory=i,exports.SortOrder=l,exports.Table=class{columns;orderIndex;orderSort},exports.TableColumn=t,exports.TableColumnWithData=class{label;type;data},exports.TableColumnWithModifiers=class extends t{modifier},exports.TableColumnWithOrientation=class extends t{orientation},exports.TextTruncatedModifier=class{maximumLength;valueIfEmpty},exports.WhereToGetData=class{value},exports.WhereToGetLinkData=e,exports.WhereToGetLinksData=class extends e{values},exports.WhereToGetObjectsData=class{values;template},exports.WhereToGetScoreData=class{value;id;name},exports.WhereToGetTextsData=class{values};
